<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Scheduled Tasks</title>
    <link rel="stylesheet" href="https://cdn.simplecss.org/simple.min.css">
    <link rel="stylesheet" href="/static/css/custom.css">
</head>
<body>
<header>
    <h1>Scheduled Tasks</h1>
    <nav>
        <a href="/">View Notes</a>
        <span>|</span>
        <a href="/history">View Message History</a>
    </nav>
</header>

<main>
    {% if tasks %}
    <div class="tasks-list">
        {% for task in tasks %}
        <article class="task-card status-{{ task.status }}"> <!-- Use article for semantics -->
            <div class="task-detail"><span class="task-label">Task ID:</span> <span class="task-value task-id">{{ task.task_id }}</span></div>
            <div class="task-detail"><span class="task-label">Type:</span> <span class="task-value">{{ task.task_type }}</span></div>
            <div class="task-detail"><span class="task-label">Status:</span> <span class="task-value task-status">{{ task.status }}</span></div>
            <div class="task-detail"><span class="task-label">Scheduled:</span> <span class="task-value">{{ task.scheduled_at.strftime('%Y-%m-%d %H:%M:%S %Z') if task.scheduled_at else 'Immediate' }}</span></div>
            <div class="task-detail"><span class="task-label">Created:</span> <span class="task-value">{{ task.created_at.strftime('%Y-%m-%d %H:%M:%S %Z') }}</span></div>
            <div class="task-detail"><span class="task-label">Retries:</span> <span class="task-value">{{ task.retry_count }} / {{ task.max_retries }}</span></div>
            <div class="task-detail task-payload">
                <span class="task-label">Payload:</span>
                <pre>{{ task.payload | tojson(indent=2) if task.payload else 'None' }}</pre>
            </div>
             <div class="task-detail task-error">
                <span class="task-label">Last Error:</span>
                <pre>{{ task.error if task.error else 'None' }}</pre>
            </div>
             <div class="task-detail task-internal-id"><span class="task-label">Internal ID:</span> <span class="task-value">{{ task.id }}</span></div>
        </article>
        {% endfor %}
    </div>
    {% else %}
        <p>No tasks found.</p>
    {% endif %}
</main>

<!-- Optional Footer
<footer>
    <p>Family Assistant Tasks</p>
</footer>
-->
</body>
</html>
