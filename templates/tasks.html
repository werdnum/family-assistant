<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Scheduled Tasks</title>
    <link rel="stylesheet" href="https://cdn.simplecss.org/simple.min.css">
    <link rel="stylesheet" href="/static/css/custom.css">
</head>
<body>
<header>
    <h1>Scheduled Tasks</h1>
    <nav>
        <a href="/">View Notes</a>
        <span>|</span>
        <a href="/history">View Message History</a>
    </nav>
</header>

<main>
    {% if tasks %}
    <table class="tasks-table"> <!-- Added class for specific styling -->
        <thead>
            <tr>
                <th class="col-id">ID</th>
                <th class="col-taskid">Task ID</th>
                <th class="col-type">Type</th>
                <th class="col-status">Status</th>
                <th class="col-scheduled">Scheduled At</th>
                <th class="col-created">Created At</th>
                <th class="col-retries">Retries (Count/Max)</th>
                <th class="col-payload">Payload</th>
                <th class="col-error">Last Error</th>
            </tr>
        </thead>
        <tbody>
            {% for task in tasks %}
            <tr class="status-{{ task.status }}">
                <td class="col-id">{{ task.id }}</td>
                <td class="col-taskid">{{ task.task_id }}</td>
                <td class="col-type">{{ task.task_type }}</td>
                <td class="col-status">{{ task.status }}</td>
                <td class="col-scheduled">{{ task.scheduled_at.strftime('%Y-%m-%d %H:%M:%S %Z') if task.scheduled_at else 'Immediate' }}</td>
                <td class="col-created">{{ task.created_at.strftime('%Y-%m-%d %H:%M:%S %Z') }}</td>
                <td class="col-retries">{{ task.retry_count }} / {{ task.max_retries }}</td>
                <td class="col-payload"><pre>{{ task.payload | tojson(indent=2) if task.payload else 'None' }}</pre></td>
                <td class="col-error"><pre>{{ task.error if task.error else 'None' }}</pre></td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
    {% else %}
        <p>No tasks found.</p>
    {% endif %}
</main>

<!-- Optional Footer
<footer>
    <p>Family Assistant Tasks</p>
</footer>
-->
</body>
</html>
