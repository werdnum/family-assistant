<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}Family Assistant{% endblock %}</title>
    {% if DEV_MODE() %}
    <!-- Vite development mode -->
    <script type="module" src="/@vite/client"></script>
    <script type="module" src="/src/main.js"></script>
    {% else %}
    <!-- Production build assets -->
    <link rel="stylesheet" href="{{ get_static_asset('main.css') }}">
    <script type="module" src="{{ get_static_asset('main.js') }}"></script>
    {% endif %}
    {% block head_extra %}{% endblock %}
</head>
<body>
    <header>
        <h1>{% block page_title %}{% block title_header %}{% endblock %}{% endblock %}</h1>
        <nav>
            <!-- Assistant Data -->
            <div class="nav-group">
                <span class="nav-label">Data</span>
                <a href="{{ request.app.url_path_for('notes_ui') }}">Notes</a>
                <a href="{{ request.app.url_path_for('view_context_page') }}">Context</a>
            </div>
            <span class="nav-separator">|</span>
            
            <!-- Documents -->
            <div class="nav-group">
                <span class="nav-label">Documents</span>
                <a href="{{ request.app.url_path_for('ui_list_documents') }}">List</a>
                <a href="{{ request.app.url_path_for('get_document_upload_form') }}">Upload</a>
                <a href="{{ request.app.url_path_for('ui_vector_search') }}">Search</a>
            </div>
            <span class="nav-separator">|</span>
            
            <!-- Chat & History -->
            <a href="/chat">Chat</a>
            <a href="{{ request.app.url_path_for('ui_message_history') }}">History</a>
            <span class="nav-separator">|</span>
            
            <!-- Automation -->
            <div class="nav-group">
                <span class="nav-label">Automation</span>
                <a href="{{ request.app.url_path_for('events_list') }}">Events</a>
                <a href="/event-listeners">Event Listeners</a>
            </div>
            <span class="nav-separator">|</span>
            
            <!-- Internal/Admin -->
            <div class="nav-group">
                <span class="nav-label">Internal</span>
                <a href="{{ request.app.url_path_for('tools_ui') }}">Tools</a>
                <a href="{{ request.app.url_path_for('tasks_ui') }}">Task Queue</a>
                <a href="{{ request.app.url_path_for('error_list') }}">Error Logs</a>
            </div>
            <span class="nav-separator">|</span>
            
            <!-- Help -->
            <a href="{{ request.app.url_path_for('ui_list_docs') }}">Help</a>
            
            {% if user %}
            <span class="nav-separator">|</span>
            <a href="{{ request.app.url_path_for('ui_manage_api_tokens') }}">API Tokens</a>
            {% if AUTH_ENABLED %}
            <span class="nav-separator">|</span>
            <a href="{{ request.app.url_path_for('logout') }}">Logout ({{ user.get("name", user.get("sub")) }})</a>
            {% endif %}
            {% elif AUTH_ENABLED %}
            <span class="nav-separator">|</span>
            <a href="{{ request.app.url_path_for('login') }}">Login</a>
            {% endif %}
        </nav>
        {% block header_content %}{% endblock %}
    </header>

    <main>
        {% block main_content %}{% block content %}{% endblock %}{% endblock %}
    </main>

    <footer>
        <p>&copy; {{ now_utc.year }} Family Assistant</p>
        {% block footer_content %}{% endblock %}
    </footer>

    {% block scripts_extra %}{% endblock %}
</body>
</html>
