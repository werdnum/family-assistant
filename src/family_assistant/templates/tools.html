<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Available Tools</title>
    <link rel="stylesheet" href="https://cdn.simplecss.org/simple.min.css">
    <link rel="stylesheet" href="/static/css/custom.css">
    <style>
    	main {
    		background-color: var(--bg);
    		color: var(--text);
    	}
        /* Styles for json-schema-for-humans flat template */
        .schema-table { width: 100%; border-collapse: collapse; margin-top: 0.5rem; }
        .schema-table th, .schema-table td { border: 1px solid var(--border); padding: 0.5rem; text-align: left; }
        .schema-table th { background-color: var(--accent-bg); }
        .schema-table code { background-color: var(--bg); padding: 0.1em 0.3em; border-radius: 3px; }

        .tool-card { margin-bottom: 1.5rem; padding: 1rem; border: 1px solid var(--border); border-radius: 5px; background-color: var(--accent-bg); /* Use --accent-bg for secondary background */ }
        .tool-card h3 { margin-top: 0; }
        /* Style for the test form */
        .json-editor-arguments-container { /* Add styles for the editor container if needed */ }
        .tool-result-container { margin-top: 0.5rem; border: 1px dashed var(--border); padding: 0.5rem; min-height: 50px; background-color: var(--bg); }
        .tool-result-container .error { color: var(--error); font-weight: bold;}
    </style>
</head>
<body>
<header>
    <h1>Available Tools</h1>
    <nav>
        <a href="/">View Notes</a>
        <span>|</span>
        <a href="/history">View Message History</a>
        <span>|</span>
        <a href="/tasks">View Tasks</a>
        <span>|</span>
        <a href="/vector-search">Vector Search</a>
        <span>|</span>
        <a href="/docs/">Docs</a>
    </nav>
</header>

<main>
    {% if tools %}
        <p>The LLM has access to the following {{ tools|length }} tools:</p>
        {% for tool in tools %}
            <article class="tool-card">
                <h3>{{ tool.function.name }}</h3>
                <p>{{ tool.function.description }}</p>
                <strong>Parameters:</strong>
                <details>
                    <summary style="cursor: pointer; font-weight: bold;">Show/Hide Schema</summary>
                    {# Render the generated HTML schema (passed from web_server) using the 'safe' filter #}
                    <div style="margin-top: 0.5rem;">{{ tool.parameters_html | safe }}</div>
                </details>
                <details style="margin-top: 1rem;">
                    <summary style="cursor: pointer; font-weight: bold;">Test Tool</summary>
                    <div style="margin-top: 0.5rem;">
                        {# Pass tool name via data attribute #}
                        <form class="tool-test-form" data-tool-name="{{ tool.function.name }}">
                            <label for="args-editor-{{ loop.index }}">Arguments:</label>
                            {# Container for the JSON editor #}
                            <div id="args-editor-{{ loop.index }}" class="json-editor-arguments-container" style="height: 200px; margin-bottom: 0.5rem;"></div>
                            {# Store schema in a script tag for JS to access #}
                            <script id="schema-{{ loop.index }}" type="application/json">{{ tool.function.parameters | tojson | safe }}</script>
                            <button type="submit">Test Tool</button>
                        </form>
                        {# Container for the result JSON editor #}
                        <div class="tool-result-container" id="result-{{ loop.index }}"></div>
                    </div>
                </details>
            </article>
        {% endfor %}
    {% else %}
        <p>No tool definitions are currently available.</p>
    {% endif %}
</main>

</body>
<!-- Link the tool tester JavaScript -->
<script type="module" src="/static/js/tool_tester.js"></script>
</html>
