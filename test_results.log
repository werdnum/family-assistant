============================= test session starts ==============================
platform linux -- Python 3.12.3, pytest-8.4.1, pluggy-1.6.0
rootdir: /workspace
configfile: pytest.ini
plugins: json-report-1.5.0, base-url-2.1.0, recording-0.13.4, asyncio-1.1.0, metadata-3.1.1, xdist-3.8.0, flakefinder-1.1.0, mock-3.14.1, playwright-asyncio-0.7.0, cov-6.2.1, anyio-4.9.0, timeout-2.4.0
asyncio: mode=Mode.AUTO, asyncio_default_fixture_loop_scope=session, asyncio_default_test_loop_scope=session
timeout: 300.0s
timeout method: thread
timeout func_only: False
created: 3/3 workers
3 workers [200 items]

...F..F..F2025-08-16 04:07:54,013 - family_assistant.storage.base - INFO - Defined api_tokens table schema.
2025-08-16 04:07:54,242 - family_assistant.storage - INFO - Vector storage module imported successfully.
2025-08-16 04:07:56,903 - family_assistant.llm - INFO - LiteLLM verbose logging is disabled (LITELLM_DEBUG not set or false).
2025-08-16 04:07:57,603 - family_assistant.embeddings - WARNING - sentence-transformers library not found. SentenceTransformerEmbeddingGenerator will not be fully available.
2025-08-16 04:07:59,576 - family_assistant.web.app_creator - WARNING - SessionMiddleware NOT added (SESSION_SECRET_KEY is not set). Accessing request.session will fail, which might break OIDC if it were enabled.
2025-08-16 04:07:59,576 - family_assistant.web.app_creator - INFO - AuthMiddleware NOT added as AUTH_ENABLED is false.
2025-08-16 04:07:59,577 - family_assistant.web.app_creator - INFO - Loaded 33 tool definitions for development mode
2025-08-16 04:07:59,577 - family_assistant.web.app_creator - INFO - Mounted static files from: /workspace/src/family_assistant/static
2025-08-16 04:07:59,579 - family_assistant.web.app_creator - INFO - Registered UI routes: ['GET /', 'GET /chat', 'GET /context', 'GET /tools', 'GET /tool-test-bench', 'GET /errors/{error_id:int}', 'GET /errors', 'GET /notes/edit/{title:str}', 'GET /notes/add', 'GET /notes', 'GET /tasks', 'GET /event-listeners/{listener_id:int}/edit', 'GET /event-listeners/{listener_id:int}', 'GET /event-listeners/new', 'GET /event-listeners', 'GET /history/{conversation_id:str}', 'GET /history', 'GET /events/{event_id:str}', 'GET /events', 'GET /docs/{filename:path}', 'GET /docs', 'GET /settings/tokens', 'GET /documents/{document_id:str}', 'GET /documents/upload', 'GET /documents/', 'GET /documents', 'GET /vector-search']

=================================== FAILURES ===================================
______ test_navigation_dropdowns_open_and_position[16-postgres-chromium] _______
[gw2] linux -- Python 3.12.3 /workspace/.venv/bin/python3

web_test_fixture = WebTestFixture(assistant=<family_assistant.assistant.Assistant object at 0xe3d6cc46fe30>, page=<Page url='http://localhost:52285/notes'>, base_url='http://localhost:52285')

    @pytest.mark.playwright
    @pytest.mark.asyncio
    async def test_navigation_dropdowns_open_and_position(
        web_test_fixture: WebTestFixture,
    ) -> None:
        """Test that navigation dropdowns open and are positioned correctly to be usable.
    
        This test handles the timing complexities of RadixUI NavigationMenu which uses
        animations and asynchronous state updates."""
        page = web_test_fixture.page
        base_url = web_test_fixture.base_url
    
        # Navigate to notes page which has the full navigation menu
        await page.goto(f"{base_url}/notes")
        await page.wait_for_load_state("networkidle")
    
        # Wait for navigation to be rendered and interactive
        await page.wait_for_selector(
            "nav[data-orientation='horizontal']", state="visible", timeout=10000
        )
    
        # Wait for navigation to be fully ready and interactive
        await page.wait_for_function(
            """() => {
                const btn = Array.from(document.querySelectorAll('button')).find(b => b.textContent?.includes('Data'));
                if (!btn) return false;
                const style = getComputedStyle(btn);
                const rect = btn.getBoundingClientRect();
                return style.visibility === 'visible' &&
                       style.opacity === '1' &&
                       rect.width > 0 &&
                       rect.height > 0 &&
                       !btn.disabled;
            }""",
            timeout=3000,
        )
    
        # Test Data dropdown
        data_trigger = page.locator("button:has-text('Data')").first
        await data_trigger.wait_for(state="visible", timeout=5000)
    
        # Ensure the button is actually interactive before clicking
        await page.wait_for_function(
            """() => {
                const buttons = Array.from(document.querySelectorAll('button'));
                const btn = buttons.find(b => b.textContent?.includes('Data'));
                if (!btn) return false;
                const rect = btn.getBoundingClientRect();
                return rect.width > 0 && rect.height > 0;
            }""",
            timeout=5000,
        )
    
        # Click with retry logic in case of timing issues
        for attempt in range(3):
            try:
                await data_trigger.click()
    
                # Wait for dropdown to be fully open with content visible
                await page.wait_for_function(
                    """() => {
                        const buttons = Array.from(document.querySelectorAll('button'));
                        const btn = buttons.find(b => b.textContent?.includes('Data'));
                        if (!btn || btn.getAttribute('aria-expanded') !== 'true') return false;
    
                        const links = Array.from(document.querySelectorAll('a'));
                        const notesLink = links.find(a => a.textContent?.includes('Notes'));
                        if (!notesLink) return false;
    
                        const style = getComputedStyle(notesLink);
                        const rect = notesLink.getBoundingClientRect();
    
                        return style.visibility === 'visible' &&
                               style.opacity === '1' &&
                               rect.width > 0 &&
                               rect.height > 0;
                    }""",
                    timeout=3000,
                )
                break
            except Exception:
                if attempt == 2:
                    raise
                await page.wait_for_timeout(500)
    
        # Check that dropdown opened (button should be expanded)
        is_expanded = await data_trigger.get_attribute("aria-expanded")
        assert is_expanded == "true", "Data dropdown should be expanded after click"
    
        # Ensure dropdown content is visible (look for Notes link)
        notes_link = page.locator("a:has-text('Notes')")
        await notes_link.wait_for(state="visible", timeout=2000)
    
        # Get positions to verify reasonable positioning
        trigger_box = await data_trigger.bounding_box()
        notes_box = await notes_link.bounding_box()
    
        assert trigger_box is not None, "Should be able to get trigger bounding box"
        assert notes_box is not None, "Should be able to get dropdown content bounding box"
    
        # The dropdown should appear below the trigger (reasonable Y positioning)
        assert notes_box["y"] > trigger_box["y"], "Dropdown should appear below trigger"
    
        # The dropdown should not be at the far left edge (x > 10px from left)
        assert notes_box["x"] > 10, (
            f"Dropdown should not be at far left edge, got x={notes_box['x']}"
        )
    
        # Close the Data dropdown by clicking outside
        await page.locator("body").click()
    
        # Wait for the dropdown to fully close before proceeding
        await page.wait_for_function(
            """() => {
                const buttons = Array.from(document.querySelectorAll('button'));
                const btn = buttons.find(b => b.textContent?.includes('Data'));
                return !btn || btn.getAttribute('aria-expanded') !== 'true';
            }""",
            timeout=3000,
        )
    
        # Wait for dropdown to be fully closed
        await page.wait_for_function(
            """() => {
                const buttons = Array.from(document.querySelectorAll('button'));
                const dataBtn = buttons.find(b => b.textContent?.includes('Data'));
                if (!dataBtn) return false;
                // Check aria-expanded is false or not present
                const expanded = dataBtn.getAttribute('aria-expanded');
                return !expanded || expanded === 'false';
            }""",
            timeout=3000,
        )
    
        # Test Internal dropdown with fresh state
        internal_trigger = page.locator("button:has-text('Internal')").first
        await internal_trigger.wait_for(state="visible", timeout=5000)
    
        # Ensure the Internal button is interactive
        await page.wait_for_function(
            """() => {
                const buttons = Array.from(document.querySelectorAll('button'));
                const btn = buttons.find(b => b.textContent?.includes('Internal'));
                if (!btn) return false;
                const rect = btn.getBoundingClientRect();
                return rect.width > 0 && rect.height > 0;
            }""",
            timeout=5000,
        )
    
        # Click with retry logic
        for attempt in range(3):
            try:
                await internal_trigger.click()
    
                # Wait for dropdown content to be fully visible and interactive
                await page.wait_for_function(
                    """() => {
                        const buttons = Array.from(document.querySelectorAll('button'));
                        const btn = buttons.find(b => b.textContent?.includes('Internal'));
                        if (!btn || btn.getAttribute('aria-expanded') !== 'true') return false;
    
                        const links = Array.from(document.querySelectorAll('a'));
                        const toolsLink = links.find(a => a.textContent?.includes('Tools'));
                        if (!toolsLink) return false;
    
                        const rect = toolsLink.getBoundingClientRect();
                        const style = getComputedStyle(toolsLink);
    
                        return rect.width > 0 &&
                               rect.height > 0 &&
                               style.visibility === 'visible' &&
                               style.opacity === '1' &&
                               style.display !== 'none';
                    }""",
                    timeout=3000,
                )
                break
            except Exception:
                if attempt == 2:
                    raise
                # Click outside to reset state
                await page.locator("body").click()
                # Wait for dropdown to close before retry
                await page.wait_for_function(
                    """() => {
                        const buttons = Array.from(document.querySelectorAll('button'));
                        const btn = buttons.find(b => b.textContent?.includes('Internal'));
                        if (!btn) return true;  // If button not found, consider it reset
                        const expanded = btn.getAttribute('aria-expanded');
                        return !expanded || expanded === 'false';
                    }""",
                    timeout=2000,
                )
    
        # Find the Tools link
        tools_link = page.locator("a:has-text('Tools')")
    
        # The key test: Can we actually see the dropdown content?
        is_tools_visible = await tools_link.is_visible()
>       assert is_tools_visible, "Tools link should be visible in Internal dropdown"
E       AssertionError: Tools link should be visible in Internal dropdown
E       assert False

tests/functional/web/test_page_layout.py:208: AssertionError
---------------------------- Captured stdout setup -----------------------------
2025-08-16 04:08:20,424 - tests.conftest - INFO - Using external PostgreSQL from TEST_DATABASE_URL: postgresql+asyncpg://test:test@postgres:5432/test
2025-08-16 04:08:20,425 - tests.conftest - INFO - 
--- PostgreSQL Test DB Setup (test_navigation_dropdowns_open_and_position[16-postgres-chromium]) ---
2025-08-16 04:08:20,425 - tests.conftest - INFO - Creating unique database: test_test_navigation_dropdowns_open_and_position_1fc7f_13fe70d7
2025-08-16 04:08:20,517 - tests.conftest - INFO - Created PostgreSQL test engine for database: test_test_navigation_dropdowns_open_and_position_1fc7f_13fe70d7
2025-08-16 04:08:20,563 - family_assistant.storage.vector - INFO - PostgreSQL dialect detected. Initializing vector extension and indexes...
2025-08-16 04:08:20,585 - family_assistant.storage.vector - INFO - Ensured 'vector' extension exists.
2025-08-16 04:08:20,585 - family_assistant.storage.vector - INFO - PostgreSQL vector database extension initialized.
2025-08-16 04:08:20,588 - tests.conftest - INFO - PostgreSQL vector database components initialized.
2025-08-16 04:08:20,588 - tests.conftest - INFO - Using postgres test engine.
2025-08-16 04:08:20,588 - family_assistant.storage - INFO - Checking database state (attempt 1/10)...
2025-08-16 04:08:20,588 - family_assistant.storage - INFO - ALEMBIC_CONFIG env var not set. Using default path: /workspace/alembic.ini
2025-08-16 04:08:20,589 - family_assistant.storage - INFO - Alembic config loaded. Using script_location: alembic
2025-08-16 04:08:20,589 - family_assistant.storage - INFO - Inspecting database for alembic_version table...
2025-08-16 04:08:20,600 - family_assistant.storage - INFO - Alembic version table found: False
2025-08-16 04:08:20,601 - family_assistant.storage - INFO - New DB: creating schema, stamping with Alembic head...
2025-08-16 04:08:20,601 - family_assistant.storage - INFO - Creating tables from SQLAlchemy metadata...
2025-08-16 04:08:20,726 - family_assistant.storage - INFO - Tables created.
2025-08-16 04:08:20,726 - family_assistant.storage - INFO - Preparing to run Alembic command: ensure_version()
2025-08-16 04:08:20,726 - family_assistant.storage - INFO - [sync] Setting connection for Alembic: <sqlalchemy.engine.base.Connection object at 0xe3d6cc41f4a0>
2025-08-16 04:08:20,726 - family_assistant.storage - INFO - [sync] Executing: ensure_version()
2025-08-16 04:08:20,727 - env_py - INFO - Running migrations in 'online' mode using provided connection.
2025-08-16 04:08:20,727 - env_py - INFO - do_run_migrations: Starting... Dialect: postgresql, Connection: <sqlalchemy.engine.base.Connection object at 0xe3d6cc41f4a0>
2025-08-16 04:08:20,727 - env_py - INFO - do_run_migrations: Configuring context with script_location: alembic
2025-08-16 04:08:20,727 - alembic.runtime.migration - INFO - Context impl PostgresqlImpl.
2025-08-16 04:08:20,727 - alembic.runtime.migration - INFO - Will assume transactional DDL.
2025-08-16 04:08:20,727 - env_py - INFO - do_run_migrations: Context configured. (No destination revision applicable for this command)
2025-08-16 04:08:20,728 - env_py - INFO - Running migrations within transaction for target: (N/A for this command)
2025-08-16 04:08:20,738 - env_py - INFO - Database migrations completed successfully.
2025-08-16 04:08:20,738 - env_py - INFO - Migrations finished using provided connection.
2025-08-16 04:08:20,738 - family_assistant.storage - INFO - [sync] Successfully executed: ensure_version
2025-08-16 04:08:20,738 - family_assistant.storage - INFO - Alembic command ensure_version completed.
2025-08-16 04:08:20,738 - family_assistant.storage - INFO - Preparing to run Alembic command: stamp('head')
2025-08-16 04:08:20,739 - family_assistant.storage - INFO - [sync] Setting connection for Alembic: <sqlalchemy.engine.base.Connection object at 0xe3d6cc5861e0>
2025-08-16 04:08:20,739 - family_assistant.storage - INFO - [sync] Executing: stamp('head')
2025-08-16 04:08:20,739 - env_py - INFO - Running migrations in 'online' mode using provided connection.
2025-08-16 04:08:20,739 - env_py - INFO - do_run_migrations: Starting... Dialect: postgresql, Connection: <sqlalchemy.engine.base.Connection object at 0xe3d6cc5861e0>
2025-08-16 04:08:20,739 - env_py - INFO - do_run_migrations: Configuring context with script_location: alembic
2025-08-16 04:08:20,740 - alembic.runtime.migration - INFO - Context impl PostgresqlImpl.
2025-08-16 04:08:20,740 - alembic.runtime.migration - INFO - Will assume transactional DDL.
2025-08-16 04:08:20,749 - env_py - INFO - do_run_migrations: Context configured. Destination Revision: head
2025-08-16 04:08:20,751 - env_py - INFO - Running migrations within transaction for target: head
2025-08-16 04:08:20,756 - alembic.runtime.migration - INFO - Running stamp_revision  -> 5c039369c3d7
2025-08-16 04:08:20,759 - env_py - INFO - Database migrations completed successfully.
2025-08-16 04:08:20,759 - env_py - INFO - Migrations finished using provided connection.
2025-08-16 04:08:20,759 - family_assistant.storage - INFO - [sync] Successfully executed: stamp
2025-08-16 04:08:20,760 - family_assistant.storage - INFO - Alembic command stamp completed.
2025-08-16 04:08:20,760 - family_assistant.storage - INFO - Initializing vector DB components...
2025-08-16 04:08:20,760 - family_assistant.storage.vector - INFO - PostgreSQL dialect detected. Initializing vector extension and indexes...
2025-08-16 04:08:20,761 - family_assistant.storage.vector - INFO - Ensured 'vector' extension exists.
2025-08-16 04:08:20,762 - family_assistant.storage.vector - INFO - PostgreSQL vector database extension initialized.
2025-08-16 04:08:20,762 - family_assistant.storage - INFO - Vector DB components initialized successfully.
2025-08-16 04:08:20,762 - family_assistant.storage - INFO - Database initialization successful.
2025-08-16 04:08:20,762 - tests.conftest - INFO - Database schema initialized.
2025-08-16 04:08:20,763 - tests.mocks.mock_llm - INFO - RuleBasedMockLLMClient initialized with 0 rules for model 'mock-llm-model'.

=== Starting API server on port 52285 ===
2025-08-16 04:08:20,763 - family_assistant.web.app_creator - INFO - FastAPI debug mode set to: True
Setting up dependencies...
2025-08-16 04:08:20,763 - family_assistant.assistant - INFO - Using model: mock-model-for-testing
2025-08-16 04:08:20,763 - family_assistant.assistant - INFO - Stored configuration in FastAPI app state.
2025-08-16 04:08:20,803 - family_assistant.assistant - INFO - Shared httpx.AsyncClient created.
2025-08-16 04:08:20,803 - family_assistant.assistant - WARNING - No specific API key validation for model: mock-model-for-testing.
2025-08-16 04:08:20,803 - family_assistant.embeddings - INFO - MockEmbeddingGenerator initialized for model: mock-deterministic-embedder, dimensions: 10, map size: 0, default_behavior: generate
2025-08-16 04:08:20,804 - family_assistant.assistant - INFO - Using embedding generator: MockEmbeddingGenerator with model: mock-deterministic-embedder
2025-08-16 04:08:20,804 - family_assistant.assistant - INFO - Using injected database engine
2025-08-16 04:08:20,804 - family_assistant.web.auth - INFO - OIDC Authentication is DISABLED in AuthService.
2025-08-16 04:08:20,804 - family_assistant.assistant - INFO - Authentication configured with database engine
2025-08-16 04:08:20,804 - family_assistant.tools.documents - INFO - Found user documentation files: ['scripting.md', 'USER_GUIDE.md', 'scheduling.md']
2025-08-16 04:08:20,805 - family_assistant.assistant - INFO - Creating root ToolsProvider with all available tools
2025-08-16 04:08:20,805 - family_assistant.tools.infrastructure - INFO - LocalToolsProvider initialized with 33 tools: ['add_or_update_note', 'get_note', 'list_notes', 'delete_note', 'schedule_future_callback', 'schedule_recurring_task', 'schedule_reminder', 'schedule_action', 'schedule_recurring_action', 'search_documents', 'get_full_document_content', 'get_message_history', 'get_user_documentation_content', 'ingest_document_from_url', 'send_message_to_user', 'add_calendar_event', 'search_calendar_events', 'modify_calendar_event', 'delete_calendar_event', 'delegate_to_service', 'list_pending_callbacks', 'modify_pending_callback', 'cancel_pending_callback', 'query_recent_events', 'test_event_listener', 'create_event_listener', 'list_event_listeners', 'delete_event_listener', 'toggle_event_listener', 'validate_event_listener_script', 'test_event_listener_script', 'render_home_assistant_template', 'execute_script']
2025-08-16 04:08:20,805 - family_assistant.tools.infrastructure - INFO - LocalToolsProvider configured with embedding generator: MockEmbeddingGenerator
2025-08-16 04:08:20,805 - family_assistant.tools.mcp - INFO - MCPToolsProvider created for 0 configured servers. Initialization timeout: 60s. Health check interval: 30s. Initialization pending.
2025-08-16 04:08:20,805 - family_assistant.tools.infrastructure - INFO - CompositeToolsProvider initialized with 2 providers
2025-08-16 04:08:20,805 - family_assistant.tools.mcp - INFO - Initializing MCPToolsProvider: Connecting to 0 servers...
2025-08-16 04:08:20,805 - family_assistant.tools.mcp - INFO - Waiting for MCP server connections with a timeout of 60 seconds...
2025-08-16 04:08:20,805 - family_assistant.tools.mcp - INFO - Finished parallel MCP connection attempts (within timeout).
2025-08-16 04:08:20,805 - family_assistant.tools.mcp - INFO - MCPToolsProvider finished processing all 0 configured MCP server(s) in 0.00 seconds. Summary: 0 connected, 0 failed, 0 cancelled. Active sessions: 0. Mapped 0 unique tools from 0 total definitions.
2025-08-16 04:08:20,805 - family_assistant.assistant - INFO - Root ToolsProvider initialized with 33 tools
2025-08-16 04:08:20,805 - family_assistant.assistant - INFO - Initializing ProcessingService for profile ID: 'default_assistant'
2025-08-16 04:08:20,805 - family_assistant.assistant - INFO - Profile 'default_assistant' using overridden LLM client: RuleBasedMockLLMClient
2025-08-16 04:08:20,806 - family_assistant.tools.infrastructure - INFO - ConfirmingToolsProvider initialized with tools requiring confirmation: {'add_or_update_note', 'delete_calendar_event'}
2025-08-16 04:08:20,806 - family_assistant.assistant - INFO - Default processing service set to profile ID: 'default_assistant'.
2025-08-16 04:08:20,826 - family_assistant.assistant - WARNING - No processors in 'indexing_pipeline_config'.
2025-08-16 04:08:20,826 - family_assistant.indexing.document_indexer - INFO - DocumentIndexer initialized with dynamically built pipeline including 0 processors: []
2025-08-16 04:08:20,826 - family_assistant.indexing.email_indexer - INFO - EmailIndexer initialized with an IndexingPipeline instance.
2025-08-16 04:08:20,826 - family_assistant.indexing.notes_indexer - INFO - NotesIndexer initialized with an IndexingPipeline instance.
2025-08-16 04:08:20,826 - family_assistant.assistant - INFO - DocumentIndexer, EmailIndexer, and NotesIndexer initialized.
2025-08-16 04:08:20,826 - family_assistant.assistant - INFO - Telegram service disabled (telegram_enabled=False)
Dependencies set up
Starting API services on port 52285...
Waiting for server initialization...
2025-08-16 04:08:20,827 - family_assistant.assistant - INFO - Telegram service disabled, skipping polling.
2025-08-16 04:08:20,828 - family_assistant.assistant - INFO - Web server running on http://0.0.0.0:52285
2025-08-16 04:08:20,828 - family_assistant.assistant - INFO - In development, run 'poe dev' and access the app at http://localhost:5173
2025-08-16 04:08:20,828 - family_assistant.task_worker - INFO - TaskWorker instance worker-5303763e-6380-4e10-bfe1-5f35de57c503 created.
2025-08-16 04:08:20,828 - family_assistant.task_worker - INFO - Worker worker-5303763e-6380-4e10-bfe1-5f35de57c503: Registered handler for task type: log_message
2025-08-16 04:08:20,828 - family_assistant.task_worker - INFO - Worker worker-5303763e-6380-4e10-bfe1-5f35de57c503: Registered handler for task type: process_uploaded_document
2025-08-16 04:08:20,828 - family_assistant.task_worker - INFO - Worker worker-5303763e-6380-4e10-bfe1-5f35de57c503: Registered handler for task type: index_email
2025-08-16 04:08:20,828 - family_assistant.task_worker - INFO - Worker worker-5303763e-6380-4e10-bfe1-5f35de57c503: Registered handler for task type: index_note
2025-08-16 04:08:20,828 - family_assistant.task_worker - INFO - Worker worker-5303763e-6380-4e10-bfe1-5f35de57c503: Registered handler for task type: llm_callback
2025-08-16 04:08:20,828 - family_assistant.task_worker - INFO - Worker worker-5303763e-6380-4e10-bfe1-5f35de57c503: Registered handler for task type: embed_and_store_batch
2025-08-16 04:08:20,828 - family_assistant.task_worker - INFO - Worker worker-5303763e-6380-4e10-bfe1-5f35de57c503: Registered handler for task type: system_event_cleanup
2025-08-16 04:08:20,828 - family_assistant.task_worker - INFO - Worker worker-5303763e-6380-4e10-bfe1-5f35de57c503: Registered handler for task type: system_error_log_cleanup
2025-08-16 04:08:20,828 - family_assistant.task_worker - INFO - Worker worker-5303763e-6380-4e10-bfe1-5f35de57c503: Registered handler for task type: script_execution
2025-08-16 04:08:20,828 - family_assistant.task_worker - INFO - Worker worker-5303763e-6380-4e10-bfe1-5f35de57c503: Registered handler for task type: reindex_document
2025-08-16 04:08:20,828 - family_assistant.assistant - INFO - Registered task handlers for worker worker-5303763e-6380-4e10-bfe1-5f35de57c503
2025-08-16 04:08:20,829 - family_assistant.task_worker - INFO - Task worker worker-5303763e-6380-4e10-bfe1-5f35de57c503 run loop started.
2025-08-16 04:08:20,829 - family_assistant.task_worker - INFO - Task worker worker-5303763e-6380-4e10-bfe1-5f35de57c503 stopped.
2025-08-16 04:08:20,829 - family_assistant.web.app_creator - INFO - Application starting up...
2025-08-16 04:08:20,829 - family_assistant.web.auth - INFO - OIDC Authentication is DISABLED in AuthService.
2025-08-16 04:08:20,829 - family_assistant.web.app_creator - INFO - AuthService initialized with database engine
Starting health checks...
Waiting for server at http://localhost:52285 (health check: http://localhost:52285/health)
INFO:     127.0.0.1:56184 - "GET /health HTTP/1.1" 200 OK
[0.0s] Health check response: 200
[0.0s] âœ“ Health check passed for http://localhost:52285/health
INFO:     127.0.0.1:56184 - "GET / HTTP/1.1" 302 Found
[0.0s] Root endpoint response: 302

=== API server ready on port 52285 ===
Pre-loading router to initialize dynamic import resolution...
[Request] GET http://localhost:52285/
INFO:     127.0.0.1:56190 - "GET / HTTP/1.1" 302 Found
[Response] 302 http://localhost:52285/
[Request] GET http://localhost:52285/chat
INFO:     127.0.0.1:56190 - "GET /chat HTTP/1.1" 200 OK
[Response] 200 http://localhost:52285/chat
INFO:     127.0.0.1:56190 - "GET /static/dist/assets/router-BDyQ12Xx.js HTTP/1.1" 200 OK
[Request] GET http://localhost:52285/static/dist/assets/router-BDyQ12Xx.js
INFO:     127.0.0.1:56198 - "GET /static/dist/assets/globals-BzhNq9eE.css HTTP/1.1" 200 OK
[Request] GET http://localhost:52285/static/dist/assets/modulepreload-polyfill-B5Qt9EMX.js
INFO:     127.0.0.1:56206 - "GET /static/dist/assets/modulepreload-polyfill-B5Qt9EMX.js HTTP/1.1" 200 OK
INFO:     127.0.0.1:56214 - "GET /static/dist/assets/markdown-DkulxR7L.js HTTP/1.1" 200 OK
[Request] GET http://localhost:52285/static/dist/assets/markdown-DkulxR7L.js
[Request] GET http://localhost:52285/static/dist/assets/client-D4i40GxS.js
INFO:     127.0.0.1:56226 - "GET /static/dist/assets/client-D4i40GxS.js HTTP/1.1" 200 OK
INFO:     127.0.0.1:56236 - "GET /static/dist/assets/ThemeProvider-4Nl18-8f.js HTTP/1.1" 200 OK
[Request] GET http://localhost:52285/static/dist/assets/ThemeProvider-4Nl18-8f.js
[Request] GET http://localhost:52285/static/dist/assets/globals-BzhNq9eE.css
[Response] 200 http://localhost:52285/static/dist/assets/globals-BzhNq9eE.css
[Response] 200 http://localhost:52285/static/dist/assets/router-BDyQ12Xx.js
[Response] 200 http://localhost:52285/static/dist/assets/modulepreload-polyfill-B5Qt9EMX.js
[Response] 200 http://localhost:52285/static/dist/assets/ThemeProvider-4Nl18-8f.js
[Response] 200 http://localhost:52285/static/dist/assets/markdown-DkulxR7L.js
[Response] 200 http://localhost:52285/static/dist/assets/client-D4i40GxS.js
INFO:     127.0.0.1:56214 - "GET /static/dist/assets/button-C280_Z7h.js HTTP/1.1" 200 OK
INFO:     127.0.0.1:56226 - "GET /static/dist/assets/ChatApp-BGzR61B2.js HTTP/1.1" 200 OK
[Request] GET http://localhost:52285/static/dist/assets/ChatApp-BGzR61B2.js
[Request] GET http://localhost:52285/static/dist/assets/button-C280_Z7h.js
[Request] GET http://localhost:52285/static/dist/assets/NavigationSheet-BR3FFw8j.js
[Request] GET http://localhost:52285/static/dist/assets/createLucideIcon-BWE3A16L.js
[Request] GET http://localhost:52285/static/dist/assets/check-B4Bi62mG.js
[Request] GET http://localhost:52285/static/dist/assets/index-DJ5LtvbL.js
[Request] GET http://localhost:52285/static/dist/assets/index-Cw7yfj14.js
[Request] GET http://localhost:52285/static/dist/assets/index-DX5mgmid.js
[Request] GET http://localhost:52285/static/dist/assets/index-B4vh495l.js
[Request] GET http://localhost:52285/static/dist/assets/card-CTXY0ynb.js
[Request] GET http://localhost:52285/static/dist/assets/badge-DPL7DvXz.js
[Request] GET http://localhost:52285/static/dist/assets/index-QvZiqB7f.js
[Request] GET http://localhost:52285/static/dist/assets/ToolUI-d4PjB4dB.js
[Request] GET http://localhost:52285/static/dist/assets/input-DEzFQXe7.js
[Request] GET http://localhost:52285/static/dist/assets/index-BdQq_4o_.js
INFO:     127.0.0.1:56236 - "GET /static/dist/assets/NavigationSheet-BR3FFw8j.js HTTP/1.1" 200 OK
INFO:     127.0.0.1:56206 - "GET /static/dist/assets/createLucideIcon-BWE3A16L.js HTTP/1.1" 200 OK
INFO:     127.0.0.1:56198 - "GET /static/dist/assets/check-B4Bi62mG.js HTTP/1.1" 200 OK
INFO:     127.0.0.1:56190 - "GET /static/dist/assets/index-DJ5LtvbL.js HTTP/1.1" 200 OK
INFO:     127.0.0.1:56214 - "GET /static/dist/assets/index-DX5mgmid.js HTTP/1.1" 200 OK
INFO:     127.0.0.1:56206 - "GET /static/dist/assets/index-Cw7yfj14.js HTTP/1.1" 200 OK
INFO:     127.0.0.1:56198 - "GET /static/dist/assets/card-CTXY0ynb.js HTTP/1.1" 200 OK
INFO:     127.0.0.1:56226 - "GET /static/dist/assets/badge-DPL7DvXz.js HTTP/1.1" 200 OK
INFO:     127.0.0.1:56236 - "GET /static/dist/assets/index-B4vh495l.js HTTP/1.1" 200 OK
INFO:     127.0.0.1:56190 - "GET /static/dist/assets/index-QvZiqB7f.js HTTP/1.1" 200 OK
[Response] 200 http://localhost:52285/static/dist/assets/NavigationSheet-BR3FFw8j.js
[Response] 200 http://localhost:52285/static/dist/assets/createLucideIcon-BWE3A16L.js
[Response] 200 http://localhost:52285/static/dist/assets/button-C280_Z7h.js
[Response] 200 http://localhost:52285/static/dist/assets/index-DJ5LtvbL.js
[Response] 200 http://localhost:52285/static/dist/assets/check-B4Bi62mG.js
[Response] 200 http://localhost:52285/static/dist/assets/ChatApp-BGzR61B2.js
[Response] 200 http://localhost:52285/static/dist/assets/index-DX5mgmid.js
INFO:     127.0.0.1:56214 - "GET /static/dist/assets/ToolUI-d4PjB4dB.js HTTP/1.1" 200 OK
INFO:     127.0.0.1:56206 - "GET /static/dist/assets/input-DEzFQXe7.js HTTP/1.1" 200 OK
INFO:     127.0.0.1:56226 - "GET /static/dist/assets/index-BdQq_4o_.js HTTP/1.1" 200 OK
[Response] 200 http://localhost:52285/static/dist/assets/index-Cw7yfj14.js
[Response] 200 http://localhost:52285/static/dist/assets/badge-DPL7DvXz.js
[Response] 200 http://localhost:52285/static/dist/assets/card-CTXY0ynb.js
[Response] 200 http://localhost:52285/static/dist/assets/index-B4vh495l.js
[Response] 200 http://localhost:52285/static/dist/assets/index-QvZiqB7f.js
[Response] 200 http://localhost:52285/static/dist/assets/input-DEzFQXe7.js
[Response] 200 http://localhost:52285/static/dist/assets/index-BdQq_4o_.js
[Response] 200 http://localhost:52285/static/dist/assets/ToolUI-d4PjB4dB.js
[Request] GET http://localhost:52285/api/v1/chat/conversations
INFO:     127.0.0.1:56214 - "GET /api/v1/chat/conversations HTTP/1.1" 200 OK
[Response] 200 http://localhost:52285/api/v1/chat/conversations
Pre-loading route: /docs
[Request] GET http://localhost:52285/docs
INFO:     127.0.0.1:56214 - "GET /docs HTTP/1.1" 200 OK
[Response] 200 http://localhost:52285/docs
[Request] GET http://localhost:52285/static/dist/assets/router-BDyQ12Xx.js
[Response] 200 http://localhost:52285/static/dist/assets/router-BDyQ12Xx.js
[Request] GET http://localhost:52285/static/dist/assets/modulepreload-polyfill-B5Qt9EMX.js
[Response] 200 http://localhost:52285/static/dist/assets/modulepreload-polyfill-B5Qt9EMX.js
[Request] GET http://localhost:52285/static/dist/assets/markdown-DkulxR7L.js
[Response] 200 http://localhost:52285/static/dist/assets/markdown-DkulxR7L.js
[Request] GET http://localhost:52285/static/dist/assets/client-D4i40GxS.js
[Response] 200 http://localhost:52285/static/dist/assets/client-D4i40GxS.js
[Request] GET http://localhost:52285/static/dist/assets/ThemeProvider-4Nl18-8f.js
[Response] 200 http://localhost:52285/static/dist/assets/ThemeProvider-4Nl18-8f.js
[Request] GET http://localhost:52285/static/dist/assets/globals-BzhNq9eE.css
[Response] 200 http://localhost:52285/static/dist/assets/globals-BzhNq9eE.css
[Request] GET http://localhost:52285/static/dist/assets/Layout--yB9MKwc.js
[Request] GET http://localhost:52285/static/dist/assets/index-Cw7yfj14.js
[Response] 200 http://localhost:52285/static/dist/assets/index-Cw7yfj14.js
[Request] GET http://localhost:52285/static/dist/assets/button-C280_Z7h.js
[Response] 200 http://localhost:52285/static/dist/assets/button-C280_Z7h.js
[Request] GET http://localhost:52285/static/dist/assets/check-B4Bi62mG.js
[Response] 200 http://localhost:52285/static/dist/assets/check-B4Bi62mG.js
[Request] GET http://localhost:52285/static/dist/assets/createLucideIcon-BWE3A16L.js
[Response] 200 http://localhost:52285/static/dist/assets/createLucideIcon-BWE3A16L.js
[Request] GET http://localhost:52285/static/dist/assets/index-DJ5LtvbL.js
[Response] 200 http://localhost:52285/static/dist/assets/index-DJ5LtvbL.js
[Request] GET http://localhost:52285/static/dist/assets/index-DX5mgmid.js
[Response] 200 http://localhost:52285/static/dist/assets/index-DX5mgmid.js
[Request] GET http://localhost:52285/static/dist/assets/index-BVtkVPko.js
[Request] GET http://localhost:52285/static/dist/assets/index-DXxW798u.js
[Request] GET http://localhost:52285/static/dist/assets/NavigationSheet-BR3FFw8j.js
[Response] 200 http://localhost:52285/static/dist/assets/NavigationSheet-BR3FFw8j.js
[Request] GET http://localhost:52285/static/dist/assets/index-B4vh495l.js
[Response] 200 http://localhost:52285/static/dist/assets/index-B4vh495l.js
INFO:     127.0.0.1:56206 - "GET /static/dist/assets/index-DXxW798u.js HTTP/1.1" 200 OK
INFO:     127.0.0.1:56214 - "GET /static/dist/assets/Layout--yB9MKwc.js HTTP/1.1" 200 OK
INFO:     127.0.0.1:56226 - "GET /static/dist/assets/index-BVtkVPko.js HTTP/1.1" 200 OK
[Response] 200 http://localhost:52285/static/dist/assets/index-DXxW798u.js
[Response] 200 http://localhost:52285/static/dist/assets/index-BVtkVPko.js
[Response] 200 http://localhost:52285/static/dist/assets/Layout--yB9MKwc.js
INFO:     127.0.0.1:56214 - "GET /static/dist/assets/DocumentationApp-Cw4oUb1l.css HTTP/1.1" 200 OK
[Request] GET http://localhost:52285/static/dist/assets/DocumentationApp-DJMW469F.js
[Request] GET http://localhost:52285/static/dist/assets/index-QvZiqB7f.js
[Response] 200 http://localhost:52285/static/dist/assets/index-QvZiqB7f.js
[Request] GET http://localhost:52285/static/dist/assets/DocumentationApp-Cw4oUb1l.css
[Response] 200 http://localhost:52285/static/dist/assets/DocumentationApp-Cw4oUb1l.css
INFO:     127.0.0.1:56226 - "GET /static/dist/assets/DocumentationApp-DJMW469F.js HTTP/1.1" 200 OK
[Response] 200 http://localhost:52285/static/dist/assets/DocumentationApp-DJMW469F.js
2025-08-16 04:08:23,821 - family_assistant.tools.documents - INFO - Found user documentation files: ['scripting.md', 'USER_GUIDE.md', 'scheduling.md']
INFO:     127.0.0.1:56226 - "GET /api/documentation/ HTTP/1.1" 200 OK
[Request] GET http://localhost:52285/api/documentation/
[Response] 200 http://localhost:52285/api/documentation/
Pre-loading route: /history
[Request] GET http://localhost:52285/history
INFO:     127.0.0.1:56226 - "GET /history HTTP/1.1" 200 OK
[Response] 200 http://localhost:52285/history
[Request] GET http://localhost:52285/static/dist/assets/router-BDyQ12Xx.js
[Response] 200 http://localhost:52285/static/dist/assets/router-BDyQ12Xx.js
[Request] GET http://localhost:52285/static/dist/assets/modulepreload-polyfill-B5Qt9EMX.js
[Response] 200 http://localhost:52285/static/dist/assets/modulepreload-polyfill-B5Qt9EMX.js
[Request] GET http://localhost:52285/static/dist/assets/markdown-DkulxR7L.js
[Response] 200 http://localhost:52285/static/dist/assets/markdown-DkulxR7L.js
[Request] GET http://localhost:52285/static/dist/assets/client-D4i40GxS.js
[Response] 200 http://localhost:52285/static/dist/assets/client-D4i40GxS.js
[Request] GET http://localhost:52285/static/dist/assets/ThemeProvider-4Nl18-8f.js
[Response] 200 http://localhost:52285/static/dist/assets/ThemeProvider-4Nl18-8f.js
[Request] GET http://localhost:52285/static/dist/assets/globals-BzhNq9eE.css
[Response] 200 http://localhost:52285/static/dist/assets/globals-BzhNq9eE.css
[Request] GET http://localhost:52285/static/dist/assets/Layout--yB9MKwc.js
[Response] 200 http://localhost:52285/static/dist/assets/Layout--yB9MKwc.js
[Request] GET http://localhost:52285/static/dist/assets/index-Cw7yfj14.js
[Response] 200 http://localhost:52285/static/dist/assets/index-Cw7yfj14.js
[Request] GET http://localhost:52285/static/dist/assets/button-C280_Z7h.js
[Response] 200 http://localhost:52285/static/dist/assets/button-C280_Z7h.js
[Request] GET http://localhost:52285/static/dist/assets/check-B4Bi62mG.js
[Response] 200 http://localhost:52285/static/dist/assets/check-B4Bi62mG.js
[Request] GET http://localhost:52285/static/dist/assets/createLucideIcon-BWE3A16L.js
[Response] 200 http://localhost:52285/static/dist/assets/createLucideIcon-BWE3A16L.js
[Request] GET http://localhost:52285/static/dist/assets/index-DJ5LtvbL.js
[Response] 200 http://localhost:52285/static/dist/assets/index-DJ5LtvbL.js
[Request] GET http://localhost:52285/static/dist/assets/index-DX5mgmid.js
[Response] 200 http://localhost:52285/static/dist/assets/index-DX5mgmid.js
[Request] GET http://localhost:52285/static/dist/assets/index-BVtkVPko.js
[Response] 200 http://localhost:52285/static/dist/assets/index-BVtkVPko.js
[Request] GET http://localhost:52285/static/dist/assets/index-DXxW798u.js
[Response] 200 http://localhost:52285/static/dist/assets/index-DXxW798u.js
[Request] GET http://localhost:52285/static/dist/assets/NavigationSheet-BR3FFw8j.js
[Response] 200 http://localhost:52285/static/dist/assets/NavigationSheet-BR3FFw8j.js
[Request] GET http://localhost:52285/static/dist/assets/index-B4vh495l.js
[Response] 200 http://localhost:52285/static/dist/assets/index-B4vh495l.js
INFO:     127.0.0.1:56226 - "GET /static/dist/assets/HistoryApp-BJY3MQD0.js HTTP/1.1" 200 OK
INFO:     127.0.0.1:56214 - "GET /static/dist/assets/label-taXZMDI0.js HTTP/1.1" 200 OK
[Request] GET http://localhost:52285/static/dist/assets/HistoryApp-BJY3MQD0.js
[Request] GET http://localhost:52285/static/dist/assets/input-DEzFQXe7.js
INFO:     127.0.0.1:56206 - "GET /static/dist/assets/select-CtKAwL8N.js HTTP/1.1" 200 OK
INFO:     127.0.0.1:56190 - "GET /static/dist/assets/HistoryApp-DOqE_fhl.css HTTP/1.1" 200 OK
[Response] 200 http://localhost:52285/static/dist/assets/input-DEzFQXe7.js
INFO:     127.0.0.1:56236 - "GET /static/dist/assets/chevron-up-C2znuyBj.js HTTP/1.1" 200 OK
[Request] GET http://localhost:52285/static/dist/assets/label-taXZMDI0.js
[Request] GET http://localhost:52285/static/dist/assets/select-CtKAwL8N.js
[Request] GET http://localhost:52285/static/dist/assets/index-BdQq_4o_.js
[Response] 200 http://localhost:52285/static/dist/assets/index-BdQq_4o_.js
[Request] GET http://localhost:52285/static/dist/assets/chevron-up-C2znuyBj.js
[Request] GET http://localhost:52285/static/dist/assets/HistoryApp-DOqE_fhl.css
[Response] 200 http://localhost:52285/static/dist/assets/HistoryApp-DOqE_fhl.css
[Response] 200 http://localhost:52285/static/dist/assets/label-taXZMDI0.js
[Response] 200 http://localhost:52285/static/dist/assets/HistoryApp-BJY3MQD0.js
[Response] 200 http://localhost:52285/static/dist/assets/chevron-up-C2znuyBj.js
[Response] 200 http://localhost:52285/static/dist/assets/select-CtKAwL8N.js
[Request] GET http://localhost:52285/api/v1/chat/conversations?limit=20&offset=0
INFO:     127.0.0.1:56206 - "GET /api/v1/chat/conversations?limit=20&offset=0 HTTP/1.1" 200 OK
[Response] 200 http://localhost:52285/api/v1/chat/conversations?limit=20&offset=0
Pre-loading route: /notes
[Request] GET http://localhost:52285/notes
INFO:     127.0.0.1:56206 - "GET /notes HTTP/1.1" 200 OK
[Response] 200 http://localhost:52285/notes
[Request] GET http://localhost:52285/static/dist/assets/router-BDyQ12Xx.js
[Response] 200 http://localhost:52285/static/dist/assets/router-BDyQ12Xx.js
[Request] GET http://localhost:52285/static/dist/assets/modulepreload-polyfill-B5Qt9EMX.js
[Response] 200 http://localhost:52285/static/dist/assets/modulepreload-polyfill-B5Qt9EMX.js
[Request] GET http://localhost:52285/static/dist/assets/markdown-DkulxR7L.js
[Response] 200 http://localhost:52285/static/dist/assets/markdown-DkulxR7L.js
[Request] GET http://localhost:52285/static/dist/assets/client-D4i40GxS.js
[Response] 200 http://localhost:52285/static/dist/assets/client-D4i40GxS.js
[Request] GET http://localhost:52285/static/dist/assets/ThemeProvider-4Nl18-8f.js
[Response] 200 http://localhost:52285/static/dist/assets/ThemeProvider-4Nl18-8f.js
[Request] GET http://localhost:52285/static/dist/assets/globals-BzhNq9eE.css
[Response] 200 http://localhost:52285/static/dist/assets/globals-BzhNq9eE.css
[Request] GET http://localhost:52285/static/dist/assets/Layout--yB9MKwc.js
[Response] 200 http://localhost:52285/static/dist/assets/Layout--yB9MKwc.js
[Request] GET http://localhost:52285/static/dist/assets/index-Cw7yfj14.js
[Response] 200 http://localhost:52285/static/dist/assets/index-Cw7yfj14.js
[Request] GET http://localhost:52285/static/dist/assets/button-C280_Z7h.js
[Response] 200 http://localhost:52285/static/dist/assets/button-C280_Z7h.js
[Request] GET http://localhost:52285/static/dist/assets/check-B4Bi62mG.js
[Response] 200 http://localhost:52285/static/dist/assets/check-B4Bi62mG.js
[Request] GET http://localhost:52285/static/dist/assets/createLucideIcon-BWE3A16L.js
[Response] 200 http://localhost:52285/static/dist/assets/createLucideIcon-BWE3A16L.js
[Request] GET http://localhost:52285/static/dist/assets/index-DJ5LtvbL.js
[Response] 200 http://localhost:52285/static/dist/assets/index-DJ5LtvbL.js
[Request] GET http://localhost:52285/static/dist/assets/index-DX5mgmid.js
[Response] 200 http://localhost:52285/static/dist/assets/index-DX5mgmid.js
[Request] GET http://localhost:52285/static/dist/assets/index-BVtkVPko.js
[Response] 200 http://localhost:52285/static/dist/assets/index-BVtkVPko.js
[Request] GET http://localhost:52285/static/dist/assets/index-DXxW798u.js
[Response] 200 http://localhost:52285/static/dist/assets/index-DXxW798u.js
[Request] GET http://localhost:52285/static/dist/assets/NavigationSheet-BR3FFw8j.js
[Response] 200 http://localhost:52285/static/dist/assets/NavigationSheet-BR3FFw8j.js
[Request] GET http://localhost:52285/static/dist/assets/index-B4vh495l.js
[Response] 200 http://localhost:52285/static/dist/assets/index-B4vh495l.js
[Request] GET http://localhost:52285/static/dist/assets/NotesApp-DTM5rAw_.js
[Request] GET http://localhost:52285/static/dist/assets/data-table-INSCgcXf.js
INFO:     127.0.0.1:56206 - "GET /static/dist/assets/NotesApp-DTM5rAw_.js HTTP/1.1" 200 OK
[Request] GET http://localhost:52285/static/dist/assets/input-DEzFQXe7.js
INFO:     127.0.0.1:56236 - "GET /static/dist/assets/data-table-INSCgcXf.js HTTP/1.1" 200 OK
[Response] 200 http://localhost:52285/static/dist/assets/input-DEzFQXe7.js
INFO:     127.0.0.1:56214 - "GET /static/dist/assets/checkbox-B_ltOU5r.js HTTP/1.1" 200 OK
INFO:     127.0.0.1:56190 - "GET /static/dist/assets/textarea-1cCUDJPF.js HTTP/1.1" 200 OK
INFO:     127.0.0.1:56226 - "GET /static/dist/assets/alert-BaJRipSp.js HTTP/1.1" 200 OK
[Request] GET http://localhost:52285/static/dist/assets/chevron-up-C2znuyBj.js
[Response] 200 http://localhost:52285/static/dist/assets/chevron-up-C2znuyBj.js
[Request] GET http://localhost:52285/static/dist/assets/textarea-1cCUDJPF.js
[Request] GET http://localhost:52285/static/dist/assets/checkbox-B_ltOU5r.js
[Request] GET http://localhost:52285/static/dist/assets/label-taXZMDI0.js
[Response] 200 http://localhost:52285/static/dist/assets/label-taXZMDI0.js
[Request] GET http://localhost:52285/static/dist/assets/card-CTXY0ynb.js
[Response] 200 http://localhost:52285/static/dist/assets/card-CTXY0ynb.js
[Request] GET http://localhost:52285/static/dist/assets/alert-BaJRipSp.js
[Response] 200 http://localhost:52285/static/dist/assets/NotesApp-DTM5rAw_.js
[Response] 200 http://localhost:52285/static/dist/assets/checkbox-B_ltOU5r.js
[Response] 200 http://localhost:52285/static/dist/assets/alert-BaJRipSp.js
[Response] 200 http://localhost:52285/static/dist/assets/textarea-1cCUDJPF.js
[Response] 200 http://localhost:52285/static/dist/assets/data-table-INSCgcXf.js
[Request] GET http://localhost:52285/api/notes/
INFO:     127.0.0.1:56190 - "GET /api/notes/ HTTP/1.1" 200 OK
[Response] 200 http://localhost:52285/api/notes/
[Request] GET http://localhost:52285/
INFO:     127.0.0.1:56190 - "GET / HTTP/1.1" 302 Found
[Response] 302 http://localhost:52285/
[Request] GET http://localhost:52285/chat
[Response] 200 http://localhost:52285/chat
[Request] GET http://localhost:52285/static/dist/assets/router-BDyQ12Xx.js
[Response] 200 http://localhost:52285/static/dist/assets/router-BDyQ12Xx.js
[Request] GET http://localhost:52285/static/dist/assets/modulepreload-polyfill-B5Qt9EMX.js
[Response] 200 http://localhost:52285/static/dist/assets/modulepreload-polyfill-B5Qt9EMX.js
[Request] GET http://localhost:52285/static/dist/assets/markdown-DkulxR7L.js
[Response] 200 http://localhost:52285/static/dist/assets/markdown-DkulxR7L.js
[Request] GET http://localhost:52285/static/dist/assets/client-D4i40GxS.js
[Response] 200 http://localhost:52285/static/dist/assets/client-D4i40GxS.js
[Request] GET http://localhost:52285/static/dist/assets/ThemeProvider-4Nl18-8f.js
[Response] 200 http://localhost:52285/static/dist/assets/ThemeProvider-4Nl18-8f.js
[Request] GET http://localhost:52285/static/dist/assets/globals-BzhNq9eE.css
[Response] 200 http://localhost:52285/static/dist/assets/globals-BzhNq9eE.css
[Request] GET http://localhost:52285/static/dist/assets/ChatApp-BGzR61B2.js
[Response] 200 http://localhost:52285/static/dist/assets/ChatApp-BGzR61B2.js
[Request] GET http://localhost:52285/static/dist/assets/button-C280_Z7h.js
[Response] 200 http://localhost:52285/static/dist/assets/button-C280_Z7h.js
[Request] GET http://localhost:52285/static/dist/assets/NavigationSheet-BR3FFw8j.js
[Response] 200 http://localhost:52285/static/dist/assets/NavigationSheet-BR3FFw8j.js
[Request] GET http://localhost:52285/static/dist/assets/createLucideIcon-BWE3A16L.js
[Response] 200 http://localhost:52285/static/dist/assets/createLucideIcon-BWE3A16L.js
[Request] GET http://localhost:52285/static/dist/assets/check-B4Bi62mG.js
[Response] 200 http://localhost:52285/static/dist/assets/check-B4Bi62mG.js
[Request] GET http://localhost:52285/static/dist/assets/index-DJ5LtvbL.js
[Response] 200 http://localhost:52285/static/dist/assets/index-DJ5LtvbL.js
[Request] GET http://localhost:52285/static/dist/assets/index-Cw7yfj14.js
[Response] 200 http://localhost:52285/static/dist/assets/index-Cw7yfj14.js
[Request] GET http://localhost:52285/static/dist/assets/index-DX5mgmid.js
[Response] 200 http://localhost:52285/static/dist/assets/index-DX5mgmid.js
[Request] GET http://localhost:52285/static/dist/assets/index-B4vh495l.js
[Response] 200 http://localhost:52285/static/dist/assets/index-B4vh495l.js
[Request] GET http://localhost:52285/static/dist/assets/card-CTXY0ynb.js
[Response] 200 http://localhost:52285/static/dist/assets/card-CTXY0ynb.js
[Request] GET http://localhost:52285/static/dist/assets/badge-DPL7DvXz.js
[Response] 200 http://localhost:52285/static/dist/assets/badge-DPL7DvXz.js
[Request] GET http://localhost:52285/static/dist/assets/index-QvZiqB7f.js
[Response] 200 http://localhost:52285/static/dist/assets/index-QvZiqB7f.js
[Request] GET http://localhost:52285/static/dist/assets/ToolUI-d4PjB4dB.js
[Response] 200 http://localhost:52285/static/dist/assets/ToolUI-d4PjB4dB.js
[Request] GET http://localhost:52285/static/dist/assets/input-DEzFQXe7.js
[Response] 200 http://localhost:52285/static/dist/assets/input-DEzFQXe7.js
[Request] GET http://localhost:52285/static/dist/assets/index-BdQq_4o_.js
[Response] 200 http://localhost:52285/static/dist/assets/index-BdQq_4o_.js
[Request] GET http://localhost:52285/api/v1/chat/conversations
[Request] GET http://localhost:52285/api/v1/chat/conversations/web_conv_d35927b6-89d4-4aa8-881b-eddf3cfc9cbb/messages
INFO:     127.0.0.1:56190 - "GET /api/v1/chat/conversations HTTP/1.1" 200 OK
[Response] 200 http://localhost:52285/api/v1/chat/conversations
INFO:     127.0.0.1:56226 - "GET /api/v1/chat/conversations/web_conv_d35927b6-89d4-4aa8-881b-eddf3cfc9cbb/messages HTTP/1.1" 200 OK
[Response] 200 http://localhost:52285/api/v1/chat/conversations/web_conv_d35927b6-89d4-4aa8-881b-eddf3cfc9cbb/messages
Router and dynamic imports initialization complete
---------------------------- Captured stderr setup -----------------------------
INFO:     Started server process [1224490]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
INFO:     Uvicorn running on http://0.0.0.0:52285 (Press CTRL+C to quit)
------------------------------ Captured log setup ------------------------------
INFO     tests.conftest:conftest.py:530 Using external PostgreSQL from TEST_DATABASE_URL: postgresql+asyncpg://test:test@postgres:5432/test
INFO     tests.conftest:conftest.py:213 
--- PostgreSQL Test DB Setup (test_navigation_dropdowns_open_and_position[16-postgres-chromium]) ---
INFO     tests.conftest:conftest.py:214 Creating unique database: test_test_navigation_dropdowns_open_and_position_1fc7f_13fe70d7
INFO     tests.conftest:conftest.py:235 Created PostgreSQL test engine for database: test_test_navigation_dropdowns_open_and_position_1fc7f_13fe70d7
INFO     family_assistant.storage.vector:vector.py:186 PostgreSQL dialect detected. Initializing vector extension and indexes...
INFO     family_assistant.storage.vector:vector.py:196 Ensured 'vector' extension exists.
INFO     family_assistant.storage.vector:vector.py:205 PostgreSQL vector database extension initialized.
INFO     tests.conftest:conftest.py:240 PostgreSQL vector database components initialized.
INFO     tests.conftest:conftest.py:246 Using postgres test engine.
INFO     family_assistant.storage:__init__.py:260 Checking database state (attempt 1/10)...
INFO     family_assistant.storage:__init__.py:155 ALEMBIC_CONFIG env var not set. Using default path: /workspace/alembic.ini
INFO     family_assistant.storage:__init__.py:172 Alembic config loaded. Using script_location: alembic
INFO     family_assistant.storage:__init__.py:76 Inspecting database for alembic_version table...
INFO     family_assistant.storage:__init__.py:91 Alembic version table found: False
INFO     family_assistant.storage:__init__.py:270 New DB: creating schema, stamping with Alembic head...
INFO     family_assistant.storage:__init__.py:214 Creating tables from SQLAlchemy metadata...
INFO     family_assistant.storage:__init__.py:217 Tables created.
INFO     family_assistant.storage:__init__.py:184 Preparing to run Alembic command: ensure_version()
INFO     family_assistant.storage:__init__.py:190 [sync] Setting connection for Alembic: <sqlalchemy.engine.base.Connection object at 0xe3d6cc41f4a0>
INFO     family_assistant.storage:__init__.py:192 [sync] Executing: ensure_version()
INFO     env_py:env.py:161 Running migrations in 'online' mode using provided connection.
INFO     env_py:env.py:64 do_run_migrations: Starting... Dialect: postgresql, Connection: <sqlalchemy.engine.base.Connection object at 0xe3d6cc41f4a0>
INFO     env_py:env.py:67 do_run_migrations: Configuring context with script_location: alembic
INFO     alembic.runtime.migration:migration.py:211 Context impl PostgresqlImpl.
INFO     alembic.runtime.migration:migration.py:214 Will assume transactional DDL.
INFO     env_py:env.py:85 do_run_migrations: Context configured. (No destination revision applicable for this command)
INFO     env_py:env.py:101 Running migrations within transaction for target: (N/A for this command)
INFO     env_py:env.py:105 Database migrations completed successfully.
INFO     env_py:env.py:165 Migrations finished using provided connection.
INFO     family_assistant.storage:__init__.py:195 [sync] Successfully executed: ensure_version
INFO     family_assistant.storage:__init__.py:204 Alembic command ensure_version completed.
INFO     family_assistant.storage:__init__.py:184 Preparing to run Alembic command: stamp('head')
INFO     family_assistant.storage:__init__.py:190 [sync] Setting connection for Alembic: <sqlalchemy.engine.base.Connection object at 0xe3d6cc5861e0>
INFO     family_assistant.storage:__init__.py:192 [sync] Executing: stamp('head')
INFO     env_py:env.py:161 Running migrations in 'online' mode using provided connection.
INFO     env_py:env.py:64 do_run_migrations: Starting... Dialect: postgresql, Connection: <sqlalchemy.engine.base.Connection object at 0xe3d6cc5861e0>
INFO     env_py:env.py:67 do_run_migrations: Configuring context with script_location: alembic
INFO     alembic.runtime.migration:migration.py:211 Context impl PostgresqlImpl.
INFO     alembic.runtime.migration:migration.py:214 Will assume transactional DDL.
INFO     env_py:env.py:81 do_run_migrations: Context configured. Destination Revision: head
INFO     env_py:env.py:101 Running migrations within transaction for target: head
INFO     alembic.runtime.migration:migration.py:622 Running stamp_revision  -> 5c039369c3d7
INFO     env_py:env.py:105 Database migrations completed successfully.
INFO     env_py:env.py:165 Migrations finished using provided connection.
INFO     family_assistant.storage:__init__.py:195 [sync] Successfully executed: stamp
INFO     family_assistant.storage:__init__.py:204 Alembic command stamp completed.
INFO     family_assistant.storage:__init__.py:223 Initializing vector DB components...
INFO     family_assistant.storage.vector:vector.py:186 PostgreSQL dialect detected. Initializing vector extension and indexes...
INFO     family_assistant.storage.vector:vector.py:196 Ensured 'vector' extension exists.
INFO     family_assistant.storage.vector:vector.py:205 PostgreSQL vector database extension initialized.
INFO     family_assistant.storage:__init__.py:232 Vector DB components initialized successfully.
INFO     family_assistant.storage:__init__.py:276 Database initialization successful.
INFO     tests.conftest:conftest.py:252 Database schema initialized.
INFO     tests.mocks.mock_llm:mock_llm.py:65 RuleBasedMockLLMClient initialized with 0 rules for model 'mock-llm-model'.
INFO     family_assistant.web.app_creator:app_creator.py:297 FastAPI debug mode set to: True
INFO     family_assistant.assistant:assistant.py:194 Using model: mock-model-for-testing
INFO     family_assistant.assistant:assistant.py:198 Stored configuration in FastAPI app state.
INFO     family_assistant.assistant:assistant.py:201 Shared httpx.AsyncClient created.
WARNING  family_assistant.assistant:assistant.py:227 No specific API key validation for model: mock-model-for-testing.
INFO     family_assistant.embeddings:embeddings.py:434 MockEmbeddingGenerator initialized for model: mock-deterministic-embedder, dimensions: 10, map size: 0, default_behavior: generate
INFO     family_assistant.assistant:assistant.py:260 Using embedding generator: MockEmbeddingGenerator with model: mock-deterministic-embedder
INFO     family_assistant.assistant:assistant.py:269 Using injected database engine
INFO     family_assistant.web.auth:auth.py:86 OIDC Authentication is DISABLED in AuthService.
INFO     family_assistant.assistant:assistant.py:285 Authentication configured with database engine
INFO     family_assistant.tools.documents:documents.py:206 Found user documentation files: ['scripting.md', 'USER_GUIDE.md', 'scheduling.md']
INFO     family_assistant.assistant:assistant.py:356 Creating root ToolsProvider with all available tools
INFO     family_assistant.tools.infrastructure:infrastructure.py:147 LocalToolsProvider initialized with 33 tools: ['add_or_update_note', 'get_note', 'list_notes', 'delete_note', 'schedule_future_callback', 'schedule_recurring_task', 'schedule_reminder', 'schedule_action', 'schedule_recurring_action', 'search_documents', 'get_full_document_content', 'get_message_history', 'get_user_documentation_content', 'ingest_document_from_url', 'send_message_to_user', 'add_calendar_event', 'search_calendar_events', 'modify_calendar_event', 'delete_calendar_event', 'delegate_to_service', 'list_pending_callbacks', 'modify_pending_callback', 'cancel_pending_callback', 'query_recent_events', 'test_event_listener', 'create_event_listener', 'list_event_listeners', 'delete_event_listener', 'toggle_event_listener', 'validate_event_listener_script', 'test_event_listener_script', 'render_home_assistant_template', 'execute_script']
INFO     family_assistant.tools.infrastructure:infrastructure.py:151 LocalToolsProvider configured with embedding generator: MockEmbeddingGenerator
INFO     family_assistant.tools.mcp:mcp.py:54 MCPToolsProvider created for 0 configured servers. Initialization timeout: 60s. Health check interval: 30s. Initialization pending.
INFO     family_assistant.tools.infrastructure:infrastructure.py:338 CompositeToolsProvider initialized with 2 providers
INFO     family_assistant.tools.mcp:mcp.py:282 Initializing MCPToolsProvider: Connecting to 0 servers...
INFO     family_assistant.tools.mcp:mcp.py:316 Waiting for MCP server connections with a timeout of 60 seconds...
INFO     family_assistant.tools.mcp:mcp.py:322 Finished parallel MCP connection attempts (within timeout).
INFO     family_assistant.tools.mcp:mcp.py:453 MCPToolsProvider finished processing all 0 configured MCP server(s) in 0.00 seconds. Summary: 0 connected, 0 failed, 0 cancelled. Active sessions: 0. Mapped 0 unique tools from 0 total definitions.
INFO     family_assistant.assistant:assistant.py:386 Root ToolsProvider initialized with 33 tools
INFO     family_assistant.assistant:assistant.py:392 Initializing ProcessingService for profile ID: 'default_assistant'
INFO     family_assistant.assistant:assistant.py:405 Profile 'default_assistant' using overridden LLM client: RuleBasedMockLLMClient
INFO     family_assistant.tools.infrastructure:infrastructure.py:478 ConfirmingToolsProvider initialized with tools requiring confirmation: {'add_or_update_note', 'delete_calendar_event'}
INFO     family_assistant.assistant:assistant.py:744 Default processing service set to profile ID: 'default_assistant'.
WARNING  family_assistant.assistant:assistant.py:753 No processors in 'indexing_pipeline_config'.
INFO     family_assistant.indexing.document_indexer:document_indexer.py:165 DocumentIndexer initialized with dynamically built pipeline including 0 processors: []
INFO     family_assistant.indexing.email_indexer:email_indexer.py:167 EmailIndexer initialized with an IndexingPipeline instance.
INFO     family_assistant.indexing.notes_indexer:notes_indexer.py:33 NotesIndexer initialized with an IndexingPipeline instance.
INFO     family_assistant.assistant:assistant.py:763 DocumentIndexer, EmailIndexer, and NotesIndexer initialized.
INFO     family_assistant.assistant:assistant.py:793 Telegram service disabled (telegram_enabled=False)
INFO     family_assistant.assistant:assistant.py:862 Telegram service disabled, skipping polling.
INFO     family_assistant.assistant:assistant.py:872 Web server running on http://0.0.0.0:52285
INFO     family_assistant.assistant:assistant.py:873 In development, run 'poe dev' and access the app at http://localhost:5173
INFO     family_assistant.assistant:assistant.py:934 Registered task handlers for worker worker-5303763e-6380-4e10-bfe1-5f35de57c503
INFO     family_assistant.web.app_creator:app_creator.py:150 Application starting up...
INFO     family_assistant.web.auth:auth.py:86 OIDC Authentication is DISABLED in AuthService.
INFO     family_assistant.web.app_creator:app_creator.py:156 AuthService initialized with database engine
INFO     family_assistant.tools.documents:documents.py:206 Found user documentation files: ['scripting.md', 'USER_GUIDE.md', 'scheduling.md']
----------------------------- Captured stdout call -----------------------------
[Request] GET http://localhost:52285/notes
[Response] 200 http://localhost:52285/notes
[Request] GET http://localhost:52285/static/dist/assets/router-BDyQ12Xx.js
[Response] 200 http://localhost:52285/static/dist/assets/router-BDyQ12Xx.js
[Request] GET http://localhost:52285/static/dist/assets/modulepreload-polyfill-B5Qt9EMX.js
[Response] 200 http://localhost:52285/static/dist/assets/modulepreload-polyfill-B5Qt9EMX.js
[Request] GET http://localhost:52285/static/dist/assets/markdown-DkulxR7L.js
[Response] 200 http://localhost:52285/static/dist/assets/markdown-DkulxR7L.js
[Request] GET http://localhost:52285/static/dist/assets/client-D4i40GxS.js
[Response] 200 http://localhost:52285/static/dist/assets/client-D4i40GxS.js
[Request] GET http://localhost:52285/static/dist/assets/ThemeProvider-4Nl18-8f.js
[Response] 200 http://localhost:52285/static/dist/assets/ThemeProvider-4Nl18-8f.js
[Request] GET http://localhost:52285/static/dist/assets/globals-BzhNq9eE.css
[Response] 200 http://localhost:52285/static/dist/assets/globals-BzhNq9eE.css
[Request] GET http://localhost:52285/static/dist/assets/Layout--yB9MKwc.js
[Response] 200 http://localhost:52285/static/dist/assets/Layout--yB9MKwc.js
[Request] GET http://localhost:52285/static/dist/assets/index-Cw7yfj14.js
[Response] 200 http://localhost:52285/static/dist/assets/index-Cw7yfj14.js
[Request] GET http://localhost:52285/static/dist/assets/button-C280_Z7h.js
[Response] 200 http://localhost:52285/static/dist/assets/button-C280_Z7h.js
[Request] GET http://localhost:52285/static/dist/assets/check-B4Bi62mG.js
[Response] 200 http://localhost:52285/static/dist/assets/check-B4Bi62mG.js
[Request] GET http://localhost:52285/static/dist/assets/createLucideIcon-BWE3A16L.js
[Response] 200 http://localhost:52285/static/dist/assets/createLucideIcon-BWE3A16L.js
[Request] GET http://localhost:52285/static/dist/assets/index-DJ5LtvbL.js
[Response] 200 http://localhost:52285/static/dist/assets/index-DJ5LtvbL.js
[Request] GET http://localhost:52285/static/dist/assets/index-DX5mgmid.js
[Response] 200 http://localhost:52285/static/dist/assets/index-DX5mgmid.js
[Request] GET http://localhost:52285/static/dist/assets/index-BVtkVPko.js
[Response] 200 http://localhost:52285/static/dist/assets/index-BVtkVPko.js
[Request] GET http://localhost:52285/static/dist/assets/index-DXxW798u.js
[Response] 200 http://localhost:52285/static/dist/assets/index-DXxW798u.js
[Request] GET http://localhost:52285/static/dist/assets/NavigationSheet-BR3FFw8j.js
[Response] 200 http://localhost:52285/static/dist/assets/NavigationSheet-BR3FFw8j.js
[Request] GET http://localhost:52285/static/dist/assets/index-B4vh495l.js
[Response] 200 http://localhost:52285/static/dist/assets/index-B4vh495l.js
[Request] GET http://localhost:52285/static/dist/assets/NotesApp-DTM5rAw_.js
[Response] 200 http://localhost:52285/static/dist/assets/NotesApp-DTM5rAw_.js
[Request] GET http://localhost:52285/static/dist/assets/data-table-INSCgcXf.js
[Response] 200 http://localhost:52285/static/dist/assets/data-table-INSCgcXf.js
[Request] GET http://localhost:52285/static/dist/assets/input-DEzFQXe7.js
[Response] 200 http://localhost:52285/static/dist/assets/input-DEzFQXe7.js
[Request] GET http://localhost:52285/static/dist/assets/chevron-up-C2znuyBj.js
[Response] 200 http://localhost:52285/static/dist/assets/chevron-up-C2znuyBj.js
[Request] GET http://localhost:52285/static/dist/assets/textarea-1cCUDJPF.js
[Response] 200 http://localhost:52285/static/dist/assets/textarea-1cCUDJPF.js
[Request] GET http://localhost:52285/static/dist/assets/checkbox-B_ltOU5r.js
[Response] 200 http://localhost:52285/static/dist/assets/checkbox-B_ltOU5r.js
[Request] GET http://localhost:52285/static/dist/assets/label-taXZMDI0.js
[Response] 200 http://localhost:52285/static/dist/assets/label-taXZMDI0.js
[Request] GET http://localhost:52285/static/dist/assets/card-CTXY0ynb.js
[Response] 200 http://localhost:52285/static/dist/assets/card-CTXY0ynb.js
[Request] GET http://localhost:52285/static/dist/assets/alert-BaJRipSp.js
[Response] 200 http://localhost:52285/static/dist/assets/alert-BaJRipSp.js
[Request] GET http://localhost:52285/api/notes/
INFO:     127.0.0.1:56226 - "GET /api/notes/ HTTP/1.1" 200 OK
[Response] 200 http://localhost:52285/api/notes/
2025-08-16 04:08:28,901 - family_assistant.task_worker - INFO - Task worker worker-79ced9fe-7671-4388-a6cd-cb0578271c85 stopped.
--------------------------- Captured stdout teardown ---------------------------
2025-08-16 04:08:31,775 - family_assistant.assistant - WARNING - Received signal TEST. Initiating shutdown via Assistant...
2025-08-16 04:08:31,776 - family_assistant.assistant - INFO - Shutdown signal received by Assistant. Stopping services...
2025-08-16 04:08:31,895 - family_assistant.web.app_creator - INFO - Application shutting down...
2025-08-16 04:08:31,895 - family_assistant.assistant - INFO - Web server stopped.
2025-08-16 04:08:31,895 - tests.conftest - INFO - --- Test DB Teardown (test_navigation_dropdowns_open_and_position[16-postgres-chromium]) ---
2025-08-16 04:08:32,006 - tests.conftest - INFO - Test engine disposed.
2025-08-16 04:08:32,226 - tests.conftest - INFO - Dropped test database: test_test_navigation_dropdowns_open_and_position_1fc7f_13fe70d7
2025-08-16 04:08:32,291 - tests.conftest - INFO - External PostgreSQL usage completed.

=== Browser closed successfully ===

=== Playwright stopped successfully ===
2025-08-16 04:08:32,362 - family_assistant.assistant - INFO - Task worker health monitor stopped
2025-08-16 04:08:32,362 - family_assistant.assistant - INFO - Task worker health monitor stopped
--------------------------- Captured stderr teardown ---------------------------
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:     Application shutdown complete.
INFO:     Finished server process [1224490]
---------------------------- Captured log teardown -----------------------------
WARNING  family_assistant.assistant:assistant.py:963 Received signal TEST. Initiating shutdown via Assistant...
INFO     family_assistant.assistant:assistant.py:951 Shutdown signal received by Assistant. Stopping services...
INFO     family_assistant.web.app_creator:app_creator.py:167 Application shutting down...
INFO     family_assistant.assistant:assistant.py:956 Web server stopped.
INFO     tests.conftest:conftest.py:259 --- Test DB Teardown (test_navigation_dropdowns_open_and_position[16-postgres-chromium]) ---
INFO     tests.conftest:conftest.py:274 Test engine disposed.
INFO     tests.conftest:conftest.py:299 Dropped test database: test_test_navigation_dropdowns_open_and_position_1fc7f_13fe70d7
INFO     tests.conftest:conftest.py:548 External PostgreSQL usage completed.
INFO     family_assistant.assistant:assistant.py:1123 Task worker health monitor stopped
INFO     family_assistant.assistant:assistant.py:1123 Task worker health monitor stopped
________ test_navigation_dropdowns_open_and_position[9-sqlite-chromium] ________
[gw1] linux -- Python 3.12.3 /workspace/.venv/bin/python3

web_test_fixture = WebTestFixture(assistant=<family_assistant.assistant.Assistant object at 0xe516f66feae0>, page=<Page url='http://localhost:54749/notes'>, base_url='http://localhost:54749')

    @pytest.mark.playwright
    @pytest.mark.asyncio
    async def test_navigation_dropdowns_open_and_position(
        web_test_fixture: WebTestFixture,
    ) -> None:
        """Test that navigation dropdowns open and are positioned correctly to be usable.
    
        This test handles the timing complexities of RadixUI NavigationMenu which uses
        animations and asynchronous state updates."""
        page = web_test_fixture.page
        base_url = web_test_fixture.base_url
    
        # Navigate to notes page which has the full navigation menu
        await page.goto(f"{base_url}/notes")
        await page.wait_for_load_state("networkidle")
    
        # Wait for navigation to be rendered and interactive
        await page.wait_for_selector(
            "nav[data-orientation='horizontal']", state="visible", timeout=10000
        )
    
        # Wait for navigation to be fully ready and interactive
        await page.wait_for_function(
            """() => {
                const btn = Array.from(document.querySelectorAll('button')).find(b => b.textContent?.includes('Data'));
                if (!btn) return false;
                const style = getComputedStyle(btn);
                const rect = btn.getBoundingClientRect();
                return style.visibility === 'visible' &&
                       style.opacity === '1' &&
                       rect.width > 0 &&
                       rect.height > 0 &&
                       !btn.disabled;
            }""",
            timeout=3000,
        )
    
        # Test Data dropdown
        data_trigger = page.locator("button:has-text('Data')").first
        await data_trigger.wait_for(state="visible", timeout=5000)
    
        # Ensure the button is actually interactive before clicking
        await page.wait_for_function(
            """() => {
                const buttons = Array.from(document.querySelectorAll('button'));
                const btn = buttons.find(b => b.textContent?.includes('Data'));
                if (!btn) return false;
                const rect = btn.getBoundingClientRect();
                return rect.width > 0 && rect.height > 0;
            }""",
            timeout=5000,
        )
    
        # Click with retry logic in case of timing issues
        for attempt in range(3):
            try:
                await data_trigger.click()
    
                # Wait for dropdown to be fully open with content visible
                await page.wait_for_function(
                    """() => {
                        const buttons = Array.from(document.querySelectorAll('button'));
                        const btn = buttons.find(b => b.textContent?.includes('Data'));
                        if (!btn || btn.getAttribute('aria-expanded') !== 'true') return false;
    
                        const links = Array.from(document.querySelectorAll('a'));
                        const notesLink = links.find(a => a.textContent?.includes('Notes'));
                        if (!notesLink) return false;
    
                        const style = getComputedStyle(notesLink);
                        const rect = notesLink.getBoundingClientRect();
    
                        return style.visibility === 'visible' &&
                               style.opacity === '1' &&
                               rect.width > 0 &&
                               rect.height > 0;
                    }""",
                    timeout=3000,
                )
                break
            except Exception:
                if attempt == 2:
                    raise
                await page.wait_for_timeout(500)
    
        # Check that dropdown opened (button should be expanded)
        is_expanded = await data_trigger.get_attribute("aria-expanded")
        assert is_expanded == "true", "Data dropdown should be expanded after click"
    
        # Ensure dropdown content is visible (look for Notes link)
        notes_link = page.locator("a:has-text('Notes')")
        await notes_link.wait_for(state="visible", timeout=2000)
    
        # Get positions to verify reasonable positioning
        trigger_box = await data_trigger.bounding_box()
        notes_box = await notes_link.bounding_box()
    
        assert trigger_box is not None, "Should be able to get trigger bounding box"
        assert notes_box is not None, "Should be able to get dropdown content bounding box"
    
        # The dropdown should appear below the trigger (reasonable Y positioning)
        assert notes_box["y"] > trigger_box["y"], "Dropdown should appear below trigger"
    
        # The dropdown should not be at the far left edge (x > 10px from left)
        assert notes_box["x"] > 10, (
            f"Dropdown should not be at far left edge, got x={notes_box['x']}"
        )
    
        # Close the Data dropdown by clicking outside
        await page.locator("body").click()
    
        # Wait for the dropdown to fully close before proceeding
        await page.wait_for_function(
            """() => {
                const buttons = Array.from(document.querySelectorAll('button'));
                const btn = buttons.find(b => b.textContent?.includes('Data'));
                return !btn || btn.getAttribute('aria-expanded') !== 'true';
            }""",
            timeout=3000,
        )
    
        # Wait for dropdown to be fully closed
        await page.wait_for_function(
            """() => {
                const buttons = Array.from(document.querySelectorAll('button'));
                const dataBtn = buttons.find(b => b.textContent?.includes('Data'));
                if (!dataBtn) return false;
                // Check aria-expanded is false or not present
                const expanded = dataBtn.getAttribute('aria-expanded');
                return !expanded || expanded === 'false';
            }""",
            timeout=3000,
        )
    
        # Test Internal dropdown with fresh state
        internal_trigger = page.locator("button:has-text('Internal')").first
        await internal_trigger.wait_for(state="visible", timeout=5000)
    
        # Ensure the Internal button is interactive
        await page.wait_for_function(
            """() => {
                const buttons = Array.from(document.querySelectorAll('button'));
                const btn = buttons.find(b => b.textContent?.includes('Internal'));
                if (!btn) return false;
                const rect = btn.getBoundingClientRect();
                return rect.width > 0 && rect.height > 0;
            }""",
            timeout=5000,
        )
    
        # Click with retry logic
        for attempt in range(3):
            try:
                await internal_trigger.click()
    
                # Wait for dropdown content to be fully visible and interactive
                await page.wait_for_function(
                    """() => {
                        const buttons = Array.from(document.querySelectorAll('button'));
                        const btn = buttons.find(b => b.textContent?.includes('Internal'));
                        if (!btn || btn.getAttribute('aria-expanded') !== 'true') return false;
    
                        const links = Array.from(document.querySelectorAll('a'));
                        const toolsLink = links.find(a => a.textContent?.includes('Tools'));
                        if (!toolsLink) return false;
    
                        const rect = toolsLink.getBoundingClientRect();
                        const style = getComputedStyle(toolsLink);
    
                        return rect.width > 0 &&
                               rect.height > 0 &&
                               style.visibility === 'visible' &&
                               style.opacity === '1' &&
                               style.display !== 'none';
                    }""",
                    timeout=3000,
                )
                break
            except Exception:
                if attempt == 2:
                    raise
                # Click outside to reset state
                await page.locator("body").click()
                # Wait for dropdown to close before retry
                await page.wait_for_function(
                    """() => {
                        const buttons = Array.from(document.querySelectorAll('button'));
                        const btn = buttons.find(b => b.textContent?.includes('Internal'));
                        if (!btn) return true;  // If button not found, consider it reset
                        const expanded = btn.getAttribute('aria-expanded');
                        return !expanded || expanded === 'false';
                    }""",
                    timeout=2000,
                )
    
        # Find the Tools link
        tools_link = page.locator("a:has-text('Tools')")
    
        # The key test: Can we actually see the dropdown content?
        is_tools_visible = await tools_link.is_visible()
>       assert is_tools_visible, "Tools link should be visible in Internal dropdown"
E       AssertionError: Tools link should be visible in Internal dropdown
E       assert False

tests/functional/web/test_page_layout.py:208: AssertionError
---------------------------- Captured stdout setup -----------------------------
2025-08-16 04:08:32,390 - tests.conftest - INFO - 
--- SQLite Test DB Setup (test_navigation_dropdowns_open_and_position[9-sqlite-chromium]) ---
2025-08-16 04:08:32,391 - tests.conftest - INFO - Created SQLite test engine: sqlite+aiosqlite:////tmp/fa_test_2cjp3jiz.sqlite
2025-08-16 04:08:32,391 - tests.conftest - INFO - Using sqlite test engine.
2025-08-16 04:08:32,391 - family_assistant.storage - INFO - Checking database state (attempt 1/10)...
2025-08-16 04:08:32,391 - family_assistant.storage - INFO - ALEMBIC_CONFIG env var not set. Using default path: /workspace/alembic.ini
2025-08-16 04:08:32,392 - family_assistant.storage - INFO - Alembic config loaded. Using script_location: alembic
2025-08-16 04:08:32,392 - family_assistant.storage - INFO - Inspecting database for alembic_version table...
2025-08-16 04:08:32,405 - family_assistant.storage - INFO - Alembic version table found: False
2025-08-16 04:08:32,405 - family_assistant.storage - INFO - New DB: creating schema, stamping with Alembic head...
2025-08-16 04:08:32,405 - family_assistant.storage - INFO - Creating tables from SQLAlchemy metadata...
2025-08-16 04:08:32,473 - family_assistant.storage - INFO - Tables created.
2025-08-16 04:08:32,473 - family_assistant.storage - INFO - Preparing to run Alembic command: ensure_version()
2025-08-16 04:08:32,475 - family_assistant.storage - INFO - [sync] Setting connection for Alembic: <sqlalchemy.engine.base.Connection object at 0xe516f61e12b0>
2025-08-16 04:08:32,475 - family_assistant.storage - INFO - [sync] Executing: ensure_version()
2025-08-16 04:08:32,475 - env_py - INFO - Running migrations in 'online' mode using provided connection.
2025-08-16 04:08:32,475 - env_py - INFO - do_run_migrations: Starting... Dialect: sqlite, Connection: <sqlalchemy.engine.base.Connection object at 0xe516f61e12b0>
2025-08-16 04:08:32,475 - env_py - INFO - do_run_migrations: Configuring context with script_location: alembic
2025-08-16 04:08:32,476 - alembic.runtime.migration - INFO - Context impl SQLiteImpl.
2025-08-16 04:08:32,476 - alembic.runtime.migration - INFO - Will assume non-transactional DDL.
2025-08-16 04:08:32,476 - env_py - INFO - do_run_migrations: Context configured. (No destination revision applicable for this command)
2025-08-16 04:08:32,476 - env_py - INFO - Running SQLite migrations (non-transactional DDL) for target: (N/A for this command)
2025-08-16 04:08:32,482 - env_py - INFO - Database migrations completed successfully.
2025-08-16 04:08:32,482 - env_py - INFO - Migrations finished using provided connection.
2025-08-16 04:08:32,482 - family_assistant.storage - INFO - [sync] Successfully executed: ensure_version
2025-08-16 04:08:32,482 - family_assistant.storage - INFO - Alembic command ensure_version completed.
2025-08-16 04:08:32,483 - family_assistant.storage - INFO - Preparing to run Alembic command: stamp('head')
2025-08-16 04:08:32,484 - family_assistant.storage - INFO - [sync] Setting connection for Alembic: <sqlalchemy.engine.base.Connection object at 0xe517040c3f50>
2025-08-16 04:08:32,484 - family_assistant.storage - INFO - [sync] Executing: stamp('head')
2025-08-16 04:08:32,484 - env_py - INFO - Running migrations in 'online' mode using provided connection.
2025-08-16 04:08:32,484 - env_py - INFO - do_run_migrations: Starting... Dialect: sqlite, Connection: <sqlalchemy.engine.base.Connection object at 0xe517040c3f50>
2025-08-16 04:08:32,485 - env_py - INFO - do_run_migrations: Configuring context with script_location: alembic
2025-08-16 04:08:32,485 - alembic.runtime.migration - INFO - Context impl SQLiteImpl.
2025-08-16 04:08:32,485 - alembic.runtime.migration - INFO - Will assume non-transactional DDL.
2025-08-16 04:08:32,491 - env_py - INFO - do_run_migrations: Context configured. Destination Revision: head
2025-08-16 04:08:32,491 - env_py - INFO - Running SQLite migrations (non-transactional DDL) for target: head
2025-08-16 04:08:32,495 - alembic.runtime.migration - INFO - Running stamp_revision  -> 5c039369c3d7
2025-08-16 04:08:32,496 - env_py - INFO - Database migrations completed successfully.
2025-08-16 04:08:32,496 - env_py - INFO - Migrations finished using provided connection.
2025-08-16 04:08:32,496 - family_assistant.storage - INFO - [sync] Successfully executed: stamp
2025-08-16 04:08:32,497 - family_assistant.storage - INFO - Alembic command stamp completed.
2025-08-16 04:08:32,497 - family_assistant.storage - INFO - Initializing vector DB components...
2025-08-16 04:08:32,498 - family_assistant.storage.vector - WARNING - Database dialect is 'sqlite', not 'postgresql'. Skipping vector extension and index creation. Vector search functionality may be limited or unavailable.
2025-08-16 04:08:32,498 - family_assistant.storage - INFO - Vector DB components initialized successfully.
2025-08-16 04:08:32,498 - family_assistant.storage - INFO - Database initialization successful.
2025-08-16 04:08:32,498 - tests.conftest - INFO - Database schema initialized.
2025-08-16 04:08:32,499 - tests.mocks.mock_llm - INFO - RuleBasedMockLLMClient initialized with 0 rules for model 'mock-llm-model'.

=== Starting API server on port 54749 ===
2025-08-16 04:08:32,499 - family_assistant.web.app_creator - INFO - FastAPI debug mode set to: True
Setting up dependencies...
2025-08-16 04:08:32,499 - family_assistant.assistant - INFO - Using model: mock-model-for-testing
2025-08-16 04:08:32,499 - family_assistant.assistant - INFO - Stored configuration in FastAPI app state.
2025-08-16 04:08:32,536 - family_assistant.assistant - INFO - Shared httpx.AsyncClient created.
2025-08-16 04:08:32,536 - family_assistant.assistant - WARNING - No specific API key validation for model: mock-model-for-testing.
2025-08-16 04:08:32,536 - family_assistant.embeddings - INFO - MockEmbeddingGenerator initialized for model: mock-deterministic-embedder, dimensions: 10, map size: 0, default_behavior: generate
2025-08-16 04:08:32,536 - family_assistant.assistant - INFO - Using embedding generator: MockEmbeddingGenerator with model: mock-deterministic-embedder
2025-08-16 04:08:32,536 - family_assistant.assistant - INFO - Using injected database engine
2025-08-16 04:08:32,540 - family_assistant.web.auth - INFO - OIDC Authentication is DISABLED in AuthService.
2025-08-16 04:08:32,540 - family_assistant.assistant - INFO - Authentication configured with database engine
2025-08-16 04:08:32,541 - family_assistant.tools.documents - INFO - Found user documentation files: ['scripting.md', 'USER_GUIDE.md', 'scheduling.md']
2025-08-16 04:08:32,541 - family_assistant.assistant - INFO - Creating root ToolsProvider with all available tools
2025-08-16 04:08:32,542 - family_assistant.tools.infrastructure - INFO - LocalToolsProvider initialized with 33 tools: ['add_or_update_note', 'get_note', 'list_notes', 'delete_note', 'schedule_future_callback', 'schedule_recurring_task', 'schedule_reminder', 'schedule_action', 'schedule_recurring_action', 'search_documents', 'get_full_document_content', 'get_message_history', 'get_user_documentation_content', 'ingest_document_from_url', 'send_message_to_user', 'add_calendar_event', 'search_calendar_events', 'modify_calendar_event', 'delete_calendar_event', 'delegate_to_service', 'list_pending_callbacks', 'modify_pending_callback', 'cancel_pending_callback', 'query_recent_events', 'test_event_listener', 'create_event_listener', 'list_event_listeners', 'delete_event_listener', 'toggle_event_listener', 'validate_event_listener_script', 'test_event_listener_script', 'render_home_assistant_template', 'execute_script']
2025-08-16 04:08:32,542 - family_assistant.tools.infrastructure - INFO - LocalToolsProvider configured with embedding generator: MockEmbeddingGenerator
2025-08-16 04:08:32,542 - family_assistant.tools.mcp - INFO - MCPToolsProvider created for 0 configured servers. Initialization timeout: 60s. Health check interval: 30s. Initialization pending.
2025-08-16 04:08:32,542 - family_assistant.tools.infrastructure - INFO - CompositeToolsProvider initialized with 2 providers
2025-08-16 04:08:32,542 - family_assistant.tools.mcp - INFO - Initializing MCPToolsProvider: Connecting to 0 servers...
2025-08-16 04:08:32,542 - family_assistant.tools.mcp - INFO - Waiting for MCP server connections with a timeout of 60 seconds...
2025-08-16 04:08:32,542 - family_assistant.tools.mcp - INFO - Finished parallel MCP connection attempts (within timeout).
2025-08-16 04:08:32,542 - family_assistant.tools.mcp - INFO - MCPToolsProvider finished processing all 0 configured MCP server(s) in 0.00 seconds. Summary: 0 connected, 0 failed, 0 cancelled. Active sessions: 0. Mapped 0 unique tools from 0 total definitions.
2025-08-16 04:08:32,542 - family_assistant.assistant - INFO - Root ToolsProvider initialized with 33 tools
2025-08-16 04:08:32,542 - family_assistant.assistant - INFO - Initializing ProcessingService for profile ID: 'default_assistant'
2025-08-16 04:08:32,542 - family_assistant.assistant - INFO - Profile 'default_assistant' using overridden LLM client: RuleBasedMockLLMClient
2025-08-16 04:08:32,542 - family_assistant.tools.infrastructure - INFO - ConfirmingToolsProvider initialized with tools requiring confirmation: {'delete_calendar_event', 'add_or_update_note'}
2025-08-16 04:08:32,542 - family_assistant.assistant - INFO - Default processing service set to profile ID: 'default_assistant'.
2025-08-16 04:08:32,564 - family_assistant.assistant - WARNING - No processors in 'indexing_pipeline_config'.
2025-08-16 04:08:32,564 - family_assistant.indexing.document_indexer - INFO - DocumentIndexer initialized with dynamically built pipeline including 0 processors: []
2025-08-16 04:08:32,565 - family_assistant.indexing.email_indexer - INFO - EmailIndexer initialized with an IndexingPipeline instance.
2025-08-16 04:08:32,565 - family_assistant.indexing.notes_indexer - INFO - NotesIndexer initialized with an IndexingPipeline instance.
2025-08-16 04:08:32,565 - family_assistant.assistant - INFO - DocumentIndexer, EmailIndexer, and NotesIndexer initialized.
2025-08-16 04:08:32,565 - family_assistant.assistant - INFO - Telegram service disabled (telegram_enabled=False)
Dependencies set up
Starting API services on port 54749...
Waiting for server initialization...
2025-08-16 04:08:32,565 - family_assistant.assistant - INFO - Telegram service disabled, skipping polling.
2025-08-16 04:08:32,566 - family_assistant.assistant - INFO - Web server running on http://0.0.0.0:54749
2025-08-16 04:08:32,566 - family_assistant.assistant - INFO - In development, run 'poe dev' and access the app at http://localhost:5173
2025-08-16 04:08:32,566 - family_assistant.task_worker - INFO - TaskWorker instance worker-bb854dd1-f782-4283-9c0f-13278daf22f7 created.
2025-08-16 04:08:32,566 - family_assistant.task_worker - INFO - Worker worker-bb854dd1-f782-4283-9c0f-13278daf22f7: Registered handler for task type: log_message
2025-08-16 04:08:32,566 - family_assistant.task_worker - INFO - Worker worker-bb854dd1-f782-4283-9c0f-13278daf22f7: Registered handler for task type: process_uploaded_document
2025-08-16 04:08:32,566 - family_assistant.task_worker - INFO - Worker worker-bb854dd1-f782-4283-9c0f-13278daf22f7: Registered handler for task type: index_email
2025-08-16 04:08:32,566 - family_assistant.task_worker - INFO - Worker worker-bb854dd1-f782-4283-9c0f-13278daf22f7: Registered handler for task type: index_note
2025-08-16 04:08:32,566 - family_assistant.task_worker - INFO - Worker worker-bb854dd1-f782-4283-9c0f-13278daf22f7: Registered handler for task type: llm_callback
2025-08-16 04:08:32,566 - family_assistant.task_worker - INFO - Worker worker-bb854dd1-f782-4283-9c0f-13278daf22f7: Registered handler for task type: embed_and_store_batch
2025-08-16 04:08:32,566 - family_assistant.task_worker - INFO - Worker worker-bb854dd1-f782-4283-9c0f-13278daf22f7: Registered handler for task type: system_event_cleanup
2025-08-16 04:08:32,566 - family_assistant.task_worker - INFO - Worker worker-bb854dd1-f782-4283-9c0f-13278daf22f7: Registered handler for task type: system_error_log_cleanup
2025-08-16 04:08:32,566 - family_assistant.task_worker - INFO - Worker worker-bb854dd1-f782-4283-9c0f-13278daf22f7: Registered handler for task type: script_execution
2025-08-16 04:08:32,566 - family_assistant.task_worker - INFO - Worker worker-bb854dd1-f782-4283-9c0f-13278daf22f7: Registered handler for task type: reindex_document
2025-08-16 04:08:32,566 - family_assistant.assistant - INFO - Registered task handlers for worker worker-bb854dd1-f782-4283-9c0f-13278daf22f7
2025-08-16 04:08:32,567 - family_assistant.task_worker - INFO - Task worker worker-bb854dd1-f782-4283-9c0f-13278daf22f7 run loop started.
2025-08-16 04:08:32,567 - family_assistant.task_worker - INFO - Task worker worker-bb854dd1-f782-4283-9c0f-13278daf22f7 stopped.
2025-08-16 04:08:32,567 - family_assistant.web.app_creator - INFO - Application starting up...
2025-08-16 04:08:32,567 - family_assistant.web.auth - INFO - OIDC Authentication is DISABLED in AuthService.
2025-08-16 04:08:32,567 - family_assistant.web.app_creator - INFO - AuthService initialized with database engine
Starting health checks...
Waiting for server at http://localhost:54749 (health check: http://localhost:54749/health)
INFO:     127.0.0.1:49014 - "GET /health HTTP/1.1" 200 OK
[0.0s] Health check response: 200
[0.0s] âœ“ Health check passed for http://localhost:54749/health
INFO:     127.0.0.1:49014 - "GET / HTTP/1.1" 302 Found
[0.0s] Root endpoint response: 302

=== API server ready on port 54749 ===
Pre-loading router to initialize dynamic import resolution...
[Request] GET http://localhost:54749/
INFO:     127.0.0.1:49018 - "GET / HTTP/1.1" 302 Found
[Response] 302 http://localhost:54749/
[Request] GET http://localhost:54749/chat
INFO:     127.0.0.1:49018 - "GET /chat HTTP/1.1" 200 OK
[Response] 200 http://localhost:54749/chat
INFO:     127.0.0.1:49018 - "GET /static/dist/assets/router-BDyQ12Xx.js HTTP/1.1" 200 OK
INFO:     127.0.0.1:49028 - "GET /static/dist/assets/modulepreload-polyfill-B5Qt9EMX.js HTTP/1.1" 200 OK
[Request] GET http://localhost:54749/static/dist/assets/router-BDyQ12Xx.js
[Request] GET http://localhost:54749/static/dist/assets/modulepreload-polyfill-B5Qt9EMX.js
[Request] GET http://localhost:54749/static/dist/assets/markdown-DkulxR7L.js
INFO:     127.0.0.1:49056 - "GET /static/dist/assets/client-D4i40GxS.js HTTP/1.1" 200 OK
INFO:     127.0.0.1:49040 - "GET /static/dist/assets/markdown-DkulxR7L.js HTTP/1.1" 200 OK
INFO:     127.0.0.1:49020 - "GET /static/dist/assets/globals-BzhNq9eE.css HTTP/1.1" 200 OK
[Request] GET http://localhost:54749/static/dist/assets/client-D4i40GxS.js
INFO:     127.0.0.1:49062 - "GET /static/dist/assets/ThemeProvider-4Nl18-8f.js HTTP/1.1" 200 OK
[Request] GET http://localhost:54749/static/dist/assets/ThemeProvider-4Nl18-8f.js
[Request] GET http://localhost:54749/static/dist/assets/globals-BzhNq9eE.css
[Response] 200 http://localhost:54749/static/dist/assets/router-BDyQ12Xx.js
[Response] 200 http://localhost:54749/static/dist/assets/globals-BzhNq9eE.css
[Response] 200 http://localhost:54749/static/dist/assets/modulepreload-polyfill-B5Qt9EMX.js
[Response] 200 http://localhost:54749/static/dist/assets/ThemeProvider-4Nl18-8f.js
[Response] 200 http://localhost:54749/static/dist/assets/markdown-DkulxR7L.js
[Response] 200 http://localhost:54749/static/dist/assets/client-D4i40GxS.js
INFO:     127.0.0.1:49056 - "GET /static/dist/assets/button-C280_Z7h.js HTTP/1.1" 200 OK
INFO:     127.0.0.1:49040 - "GET /static/dist/assets/ChatApp-BGzR61B2.js HTTP/1.1" 200 OK
INFO:     127.0.0.1:49028 - "GET /static/dist/assets/check-B4Bi62mG.js HTTP/1.1" 200 OK
INFO:     127.0.0.1:49020 - "GET /static/dist/assets/NavigationSheet-BR3FFw8j.js HTTP/1.1" 200 OK
INFO:     127.0.0.1:49062 - "GET /static/dist/assets/createLucideIcon-BWE3A16L.js HTTP/1.1" 200 OK
INFO:     127.0.0.1:49018 - "GET /static/dist/assets/index-DJ5LtvbL.js HTTP/1.1" 200 OK
INFO:     127.0.0.1:49020 - "GET /static/dist/assets/index-DX5mgmid.js HTTP/1.1" 200 OK
INFO:     127.0.0.1:49056 - "GET /static/dist/assets/index-Cw7yfj14.js HTTP/1.1" 200 OK
[Request] GET http://localhost:54749/static/dist/assets/ChatApp-BGzR61B2.js
[Request] GET http://localhost:54749/static/dist/assets/button-C280_Z7h.js
INFO:     127.0.0.1:49040 - "GET /static/dist/assets/card-CTXY0ynb.js HTTP/1.1" 200 OK
INFO:     127.0.0.1:49028 - "GET /static/dist/assets/index-B4vh495l.js HTTP/1.1" 200 OK
[Request] GET http://localhost:54749/static/dist/assets/NavigationSheet-BR3FFw8j.js
[Request] GET http://localhost:54749/static/dist/assets/createLucideIcon-BWE3A16L.js
[Request] GET http://localhost:54749/static/dist/assets/check-B4Bi62mG.js
[Request] GET http://localhost:54749/static/dist/assets/index-DJ5LtvbL.js
INFO:     127.0.0.1:49062 - "GET /static/dist/assets/badge-DPL7DvXz.js HTTP/1.1" 200 OK
[Request] GET http://localhost:54749/static/dist/assets/index-Cw7yfj14.js
[Request] GET http://localhost:54749/static/dist/assets/index-DX5mgmid.js
[Request] GET http://localhost:54749/static/dist/assets/index-B4vh495l.js
[Request] GET http://localhost:54749/static/dist/assets/card-CTXY0ynb.js
[Request] GET http://localhost:54749/static/dist/assets/badge-DPL7DvXz.js
INFO:     127.0.0.1:49056 - "GET /static/dist/assets/index-QvZiqB7f.js HTTP/1.1" 200 OK
[Request] GET http://localhost:54749/static/dist/assets/index-QvZiqB7f.js
[Request] GET http://localhost:54749/static/dist/assets/ToolUI-d4PjB4dB.js
[Request] GET http://localhost:54749/static/dist/assets/input-DEzFQXe7.js
INFO:     127.0.0.1:49028 - "GET /static/dist/assets/index-BdQq_4o_.js HTTP/1.1" 200 OK
[Request] GET http://localhost:54749/static/dist/assets/index-BdQq_4o_.js
[Response] 200 http://localhost:54749/static/dist/assets/check-B4Bi62mG.js
INFO:     127.0.0.1:49018 - "GET /static/dist/assets/ToolUI-d4PjB4dB.js HTTP/1.1" 200 OK
[Response] 200 http://localhost:54749/static/dist/assets/button-C280_Z7h.js
INFO:     127.0.0.1:49020 - "GET /static/dist/assets/input-DEzFQXe7.js HTTP/1.1" 200 OK
[Response] 200 http://localhost:54749/static/dist/assets/NavigationSheet-BR3FFw8j.js
[Response] 200 http://localhost:54749/static/dist/assets/createLucideIcon-BWE3A16L.js
[Response] 200 http://localhost:54749/static/dist/assets/ChatApp-BGzR61B2.js
[Response] 200 http://localhost:54749/static/dist/assets/index-Cw7yfj14.js
[Response] 200 http://localhost:54749/static/dist/assets/index-B4vh495l.js
[Response] 200 http://localhost:54749/static/dist/assets/card-CTXY0ynb.js
[Response] 200 http://localhost:54749/static/dist/assets/index-DX5mgmid.js
[Response] 200 http://localhost:54749/static/dist/assets/index-DJ5LtvbL.js
[Response] 200 http://localhost:54749/static/dist/assets/badge-DPL7DvXz.js
[Response] 200 http://localhost:54749/static/dist/assets/index-QvZiqB7f.js
[Response] 200 http://localhost:54749/static/dist/assets/input-DEzFQXe7.js
[Response] 200 http://localhost:54749/static/dist/assets/index-BdQq_4o_.js
[Response] 200 http://localhost:54749/static/dist/assets/ToolUI-d4PjB4dB.js
[Request] GET http://localhost:54749/api/v1/chat/conversations
INFO:     127.0.0.1:49018 - "GET /api/v1/chat/conversations HTTP/1.1" 200 OK
[Response] 200 http://localhost:54749/api/v1/chat/conversations
Pre-loading route: /docs
[Request] GET http://localhost:54749/docs
INFO:     127.0.0.1:49018 - "GET /docs HTTP/1.1" 200 OK
[Response] 200 http://localhost:54749/docs
[Request] GET http://localhost:54749/static/dist/assets/router-BDyQ12Xx.js
[Response] 200 http://localhost:54749/static/dist/assets/router-BDyQ12Xx.js
[Request] GET http://localhost:54749/static/dist/assets/modulepreload-polyfill-B5Qt9EMX.js
[Response] 200 http://localhost:54749/static/dist/assets/modulepreload-polyfill-B5Qt9EMX.js
[Request] GET http://localhost:54749/static/dist/assets/markdown-DkulxR7L.js
[Response] 200 http://localhost:54749/static/dist/assets/markdown-DkulxR7L.js
[Request] GET http://localhost:54749/static/dist/assets/client-D4i40GxS.js
[Response] 200 http://localhost:54749/static/dist/assets/client-D4i40GxS.js
[Request] GET http://localhost:54749/static/dist/assets/ThemeProvider-4Nl18-8f.js
[Response] 200 http://localhost:54749/static/dist/assets/ThemeProvider-4Nl18-8f.js
[Request] GET http://localhost:54749/static/dist/assets/globals-BzhNq9eE.css
[Response] 200 http://localhost:54749/static/dist/assets/globals-BzhNq9eE.css
[Request] GET http://localhost:54749/static/dist/assets/Layout--yB9MKwc.js
[Request] GET http://localhost:54749/static/dist/assets/index-Cw7yfj14.js
[Response] 200 http://localhost:54749/static/dist/assets/index-Cw7yfj14.js
[Request] GET http://localhost:54749/static/dist/assets/button-C280_Z7h.js
[Response] 200 http://localhost:54749/static/dist/assets/button-C280_Z7h.js
[Request] GET http://localhost:54749/static/dist/assets/check-B4Bi62mG.js
[Response] 200 http://localhost:54749/static/dist/assets/check-B4Bi62mG.js
[Request] GET http://localhost:54749/static/dist/assets/createLucideIcon-BWE3A16L.js
INFO:     127.0.0.1:49018 - "GET /static/dist/assets/Layout--yB9MKwc.js HTTP/1.1" 200 OK
[Response] 200 http://localhost:54749/static/dist/assets/createLucideIcon-BWE3A16L.js
INFO:     127.0.0.1:49028 - "GET /static/dist/assets/index-BVtkVPko.js HTTP/1.1" 200 OK
INFO:     127.0.0.1:49020 - "GET /static/dist/assets/index-DXxW798u.js HTTP/1.1" 200 OK
[Request] GET http://localhost:54749/static/dist/assets/index-DJ5LtvbL.js
[Response] 200 http://localhost:54749/static/dist/assets/index-DJ5LtvbL.js
[Request] GET http://localhost:54749/static/dist/assets/index-DX5mgmid.js
[Response] 200 http://localhost:54749/static/dist/assets/index-DX5mgmid.js
[Request] GET http://localhost:54749/static/dist/assets/index-BVtkVPko.js
[Request] GET http://localhost:54749/static/dist/assets/index-DXxW798u.js
[Request] GET http://localhost:54749/static/dist/assets/NavigationSheet-BR3FFw8j.js
[Response] 200 http://localhost:54749/static/dist/assets/NavigationSheet-BR3FFw8j.js
[Request] GET http://localhost:54749/static/dist/assets/index-B4vh495l.js
[Response] 200 http://localhost:54749/static/dist/assets/index-B4vh495l.js
[Response] 200 http://localhost:54749/static/dist/assets/index-BVtkVPko.js
[Response] 200 http://localhost:54749/static/dist/assets/index-DXxW798u.js
[Response] 200 http://localhost:54749/static/dist/assets/Layout--yB9MKwc.js
[Request] GET http://localhost:54749/static/dist/assets/DocumentationApp-DJMW469F.js
[Request] GET http://localhost:54749/static/dist/assets/index-QvZiqB7f.js
[Response] 200 http://localhost:54749/static/dist/assets/index-QvZiqB7f.js
[Request] GET http://localhost:54749/static/dist/assets/DocumentationApp-Cw4oUb1l.css
INFO:     127.0.0.1:49020 - "GET /static/dist/assets/DocumentationApp-Cw4oUb1l.css HTTP/1.1" 200 OK
INFO:     127.0.0.1:49018 - "GET /static/dist/assets/DocumentationApp-DJMW469F.js HTTP/1.1" 200 OK
[Response] 200 http://localhost:54749/static/dist/assets/DocumentationApp-Cw4oUb1l.css
[Response] 200 http://localhost:54749/static/dist/assets/DocumentationApp-DJMW469F.js
2025-08-16 04:08:35,528 - family_assistant.tools.documents - INFO - Found user documentation files: ['scripting.md', 'USER_GUIDE.md', 'scheduling.md']
INFO:     127.0.0.1:49018 - "GET /api/documentation/ HTTP/1.1" 200 OK
[Request] GET http://localhost:54749/api/documentation/
[Response] 200 http://localhost:54749/api/documentation/
Pre-loading route: /history
[Request] GET http://localhost:54749/history
INFO:     127.0.0.1:49018 - "GET /history HTTP/1.1" 200 OK
[Response] 200 http://localhost:54749/history
[Request] GET http://localhost:54749/static/dist/assets/router-BDyQ12Xx.js
[Response] 200 http://localhost:54749/static/dist/assets/router-BDyQ12Xx.js
[Request] GET http://localhost:54749/static/dist/assets/modulepreload-polyfill-B5Qt9EMX.js
[Response] 200 http://localhost:54749/static/dist/assets/modulepreload-polyfill-B5Qt9EMX.js
[Request] GET http://localhost:54749/static/dist/assets/markdown-DkulxR7L.js
[Response] 200 http://localhost:54749/static/dist/assets/markdown-DkulxR7L.js
[Request] GET http://localhost:54749/static/dist/assets/client-D4i40GxS.js
[Response] 200 http://localhost:54749/static/dist/assets/client-D4i40GxS.js
[Request] GET http://localhost:54749/static/dist/assets/ThemeProvider-4Nl18-8f.js
[Response] 200 http://localhost:54749/static/dist/assets/ThemeProvider-4Nl18-8f.js
[Request] GET http://localhost:54749/static/dist/assets/globals-BzhNq9eE.css
[Response] 200 http://localhost:54749/static/dist/assets/globals-BzhNq9eE.css
[Request] GET http://localhost:54749/static/dist/assets/Layout--yB9MKwc.js
[Response] 200 http://localhost:54749/static/dist/assets/Layout--yB9MKwc.js
[Request] GET http://localhost:54749/static/dist/assets/index-Cw7yfj14.js
[Response] 200 http://localhost:54749/static/dist/assets/index-Cw7yfj14.js
[Request] GET http://localhost:54749/static/dist/assets/button-C280_Z7h.js
[Response] 200 http://localhost:54749/static/dist/assets/button-C280_Z7h.js
[Request] GET http://localhost:54749/static/dist/assets/check-B4Bi62mG.js
[Response] 200 http://localhost:54749/static/dist/assets/check-B4Bi62mG.js
[Request] GET http://localhost:54749/static/dist/assets/createLucideIcon-BWE3A16L.js
[Response] 200 http://localhost:54749/static/dist/assets/createLucideIcon-BWE3A16L.js
[Request] GET http://localhost:54749/static/dist/assets/index-DJ5LtvbL.js
[Response] 200 http://localhost:54749/static/dist/assets/index-DJ5LtvbL.js
[Request] GET http://localhost:54749/static/dist/assets/index-DX5mgmid.js
[Response] 200 http://localhost:54749/static/dist/assets/index-DX5mgmid.js
[Request] GET http://localhost:54749/static/dist/assets/index-BVtkVPko.js
[Response] 200 http://localhost:54749/static/dist/assets/index-BVtkVPko.js
[Request] GET http://localhost:54749/static/dist/assets/index-DXxW798u.js
[Response] 200 http://localhost:54749/static/dist/assets/index-DXxW798u.js
[Request] GET http://localhost:54749/static/dist/assets/NavigationSheet-BR3FFw8j.js
[Response] 200 http://localhost:54749/static/dist/assets/NavigationSheet-BR3FFw8j.js
[Request] GET http://localhost:54749/static/dist/assets/index-B4vh495l.js
[Response] 200 http://localhost:54749/static/dist/assets/index-B4vh495l.js
INFO:     127.0.0.1:49018 - "GET /static/dist/assets/HistoryApp-BJY3MQD0.js HTTP/1.1" 200 OK
INFO:     127.0.0.1:49062 - "GET /static/dist/assets/HistoryApp-DOqE_fhl.css HTTP/1.1" 200 OK
[Request] GET http://localhost:54749/static/dist/assets/HistoryApp-BJY3MQD0.js
INFO:     127.0.0.1:49028 - "GET /static/dist/assets/select-CtKAwL8N.js HTTP/1.1" 200 OK
[Request] GET http://localhost:54749/static/dist/assets/input-DEzFQXe7.js
INFO:     127.0.0.1:49020 - "GET /static/dist/assets/label-taXZMDI0.js HTTP/1.1" 200 OK
INFO:     127.0.0.1:49056 - "GET /static/dist/assets/chevron-up-C2znuyBj.js HTTP/1.1" 200 OK
[Response] 200 http://localhost:54749/static/dist/assets/input-DEzFQXe7.js
[Request] GET http://localhost:54749/static/dist/assets/label-taXZMDI0.js
[Request] GET http://localhost:54749/static/dist/assets/select-CtKAwL8N.js
[Request] GET http://localhost:54749/static/dist/assets/index-BdQq_4o_.js
[Response] 200 http://localhost:54749/static/dist/assets/index-BdQq_4o_.js
[Request] GET http://localhost:54749/static/dist/assets/chevron-up-C2znuyBj.js
[Request] GET http://localhost:54749/static/dist/assets/HistoryApp-DOqE_fhl.css
[Response] 200 http://localhost:54749/static/dist/assets/HistoryApp-DOqE_fhl.css
[Response] 200 http://localhost:54749/static/dist/assets/HistoryApp-BJY3MQD0.js
[Response] 200 http://localhost:54749/static/dist/assets/chevron-up-C2znuyBj.js
[Response] 200 http://localhost:54749/static/dist/assets/label-taXZMDI0.js
[Response] 200 http://localhost:54749/static/dist/assets/select-CtKAwL8N.js
[Request] GET http://localhost:54749/api/v1/chat/conversations?limit=20&offset=0
INFO:     127.0.0.1:49020 - "GET /api/v1/chat/conversations?limit=20&offset=0 HTTP/1.1" 200 OK
[Response] 200 http://localhost:54749/api/v1/chat/conversations?limit=20&offset=0
Pre-loading route: /notes
[Request] GET http://localhost:54749/notes
INFO:     127.0.0.1:49020 - "GET /notes HTTP/1.1" 200 OK
[Response] 200 http://localhost:54749/notes
[Request] GET http://localhost:54749/static/dist/assets/router-BDyQ12Xx.js
[Response] 200 http://localhost:54749/static/dist/assets/router-BDyQ12Xx.js
[Request] GET http://localhost:54749/static/dist/assets/modulepreload-polyfill-B5Qt9EMX.js
[Response] 200 http://localhost:54749/static/dist/assets/modulepreload-polyfill-B5Qt9EMX.js
[Request] GET http://localhost:54749/static/dist/assets/markdown-DkulxR7L.js
[Response] 200 http://localhost:54749/static/dist/assets/markdown-DkulxR7L.js
[Request] GET http://localhost:54749/static/dist/assets/client-D4i40GxS.js
[Response] 200 http://localhost:54749/static/dist/assets/client-D4i40GxS.js
[Request] GET http://localhost:54749/static/dist/assets/ThemeProvider-4Nl18-8f.js
[Response] 200 http://localhost:54749/static/dist/assets/ThemeProvider-4Nl18-8f.js
[Request] GET http://localhost:54749/static/dist/assets/globals-BzhNq9eE.css
[Response] 200 http://localhost:54749/static/dist/assets/globals-BzhNq9eE.css
[Request] GET http://localhost:54749/static/dist/assets/Layout--yB9MKwc.js
[Response] 200 http://localhost:54749/static/dist/assets/Layout--yB9MKwc.js
[Request] GET http://localhost:54749/static/dist/assets/index-Cw7yfj14.js
[Response] 200 http://localhost:54749/static/dist/assets/index-Cw7yfj14.js
[Request] GET http://localhost:54749/static/dist/assets/button-C280_Z7h.js
[Response] 200 http://localhost:54749/static/dist/assets/button-C280_Z7h.js
[Request] GET http://localhost:54749/static/dist/assets/check-B4Bi62mG.js
[Response] 200 http://localhost:54749/static/dist/assets/check-B4Bi62mG.js
[Request] GET http://localhost:54749/static/dist/assets/createLucideIcon-BWE3A16L.js
[Response] 200 http://localhost:54749/static/dist/assets/createLucideIcon-BWE3A16L.js
[Request] GET http://localhost:54749/static/dist/assets/index-DJ5LtvbL.js
[Response] 200 http://localhost:54749/static/dist/assets/index-DJ5LtvbL.js
[Request] GET http://localhost:54749/static/dist/assets/index-DX5mgmid.js
[Response] 200 http://localhost:54749/static/dist/assets/index-DX5mgmid.js
[Request] GET http://localhost:54749/static/dist/assets/index-BVtkVPko.js
[Response] 200 http://localhost:54749/static/dist/assets/index-BVtkVPko.js
[Request] GET http://localhost:54749/static/dist/assets/index-DXxW798u.js
[Response] 200 http://localhost:54749/static/dist/assets/index-DXxW798u.js
[Request] GET http://localhost:54749/static/dist/assets/NavigationSheet-BR3FFw8j.js
[Response] 200 http://localhost:54749/static/dist/assets/NavigationSheet-BR3FFw8j.js
[Request] GET http://localhost:54749/static/dist/assets/index-B4vh495l.js
[Response] 200 http://localhost:54749/static/dist/assets/index-B4vh495l.js
[Request] GET http://localhost:54749/static/dist/assets/NotesApp-DTM5rAw_.js
INFO:     127.0.0.1:49018 - "GET /static/dist/assets/alert-BaJRipSp.js HTTP/1.1" 200 OK
INFO:     127.0.0.1:49062 - "GET /static/dist/assets/checkbox-B_ltOU5r.js HTTP/1.1" 200 OK
INFO:     127.0.0.1:49056 - "GET /static/dist/assets/data-table-INSCgcXf.js HTTP/1.1" 200 OK
[Request] GET http://localhost:54749/static/dist/assets/data-table-INSCgcXf.js
INFO:     127.0.0.1:49020 - "GET /static/dist/assets/NotesApp-DTM5rAw_.js HTTP/1.1" 200 OK
INFO:     127.0.0.1:49028 - "GET /static/dist/assets/textarea-1cCUDJPF.js HTTP/1.1" 200 OK
[Request] GET http://localhost:54749/static/dist/assets/input-DEzFQXe7.js
[Response] 200 http://localhost:54749/static/dist/assets/input-DEzFQXe7.js
[Request] GET http://localhost:54749/static/dist/assets/chevron-up-C2znuyBj.js
[Response] 200 http://localhost:54749/static/dist/assets/chevron-up-C2znuyBj.js
[Request] GET http://localhost:54749/static/dist/assets/textarea-1cCUDJPF.js
[Request] GET http://localhost:54749/static/dist/assets/checkbox-B_ltOU5r.js
[Request] GET http://localhost:54749/static/dist/assets/label-taXZMDI0.js
[Response] 200 http://localhost:54749/static/dist/assets/label-taXZMDI0.js
[Request] GET http://localhost:54749/static/dist/assets/card-CTXY0ynb.js
[Response] 200 http://localhost:54749/static/dist/assets/card-CTXY0ynb.js
[Request] GET http://localhost:54749/static/dist/assets/alert-BaJRipSp.js
[Response] 200 http://localhost:54749/static/dist/assets/checkbox-B_ltOU5r.js
[Response] 200 http://localhost:54749/static/dist/assets/textarea-1cCUDJPF.js
[Response] 200 http://localhost:54749/static/dist/assets/NotesApp-DTM5rAw_.js
[Response] 200 http://localhost:54749/static/dist/assets/data-table-INSCgcXf.js
[Response] 200 http://localhost:54749/static/dist/assets/alert-BaJRipSp.js
[Request] GET http://localhost:54749/api/notes/
INFO:     127.0.0.1:49018 - "GET /api/notes/ HTTP/1.1" 200 OK
[Response] 200 http://localhost:54749/api/notes/
[Request] GET http://localhost:54749/
INFO:     127.0.0.1:49018 - "GET / HTTP/1.1" 302 Found
[Response] 302 http://localhost:54749/
[Request] GET http://localhost:54749/chat
[Response] 200 http://localhost:54749/chat
[Request] GET http://localhost:54749/static/dist/assets/router-BDyQ12Xx.js
[Response] 200 http://localhost:54749/static/dist/assets/router-BDyQ12Xx.js
[Request] GET http://localhost:54749/static/dist/assets/modulepreload-polyfill-B5Qt9EMX.js
[Response] 200 http://localhost:54749/static/dist/assets/modulepreload-polyfill-B5Qt9EMX.js
[Request] GET http://localhost:54749/static/dist/assets/markdown-DkulxR7L.js
[Response] 200 http://localhost:54749/static/dist/assets/markdown-DkulxR7L.js
[Request] GET http://localhost:54749/static/dist/assets/client-D4i40GxS.js
[Response] 200 http://localhost:54749/static/dist/assets/client-D4i40GxS.js
[Request] GET http://localhost:54749/static/dist/assets/ThemeProvider-4Nl18-8f.js
[Response] 200 http://localhost:54749/static/dist/assets/ThemeProvider-4Nl18-8f.js
[Request] GET http://localhost:54749/static/dist/assets/globals-BzhNq9eE.css
[Response] 200 http://localhost:54749/static/dist/assets/globals-BzhNq9eE.css
[Request] GET http://localhost:54749/static/dist/assets/ChatApp-BGzR61B2.js
[Response] 200 http://localhost:54749/static/dist/assets/ChatApp-BGzR61B2.js
[Request] GET http://localhost:54749/static/dist/assets/button-C280_Z7h.js
[Response] 200 http://localhost:54749/static/dist/assets/button-C280_Z7h.js
[Request] GET http://localhost:54749/static/dist/assets/NavigationSheet-BR3FFw8j.js
[Response] 200 http://localhost:54749/static/dist/assets/NavigationSheet-BR3FFw8j.js
[Request] GET http://localhost:54749/static/dist/assets/createLucideIcon-BWE3A16L.js
[Response] 200 http://localhost:54749/static/dist/assets/createLucideIcon-BWE3A16L.js
[Request] GET http://localhost:54749/static/dist/assets/check-B4Bi62mG.js
[Response] 200 http://localhost:54749/static/dist/assets/check-B4Bi62mG.js
[Request] GET http://localhost:54749/static/dist/assets/index-DJ5LtvbL.js
[Response] 200 http://localhost:54749/static/dist/assets/index-DJ5LtvbL.js
[Request] GET http://localhost:54749/static/dist/assets/index-Cw7yfj14.js
[Response] 200 http://localhost:54749/static/dist/assets/index-Cw7yfj14.js
[Request] GET http://localhost:54749/static/dist/assets/index-DX5mgmid.js
[Response] 200 http://localhost:54749/static/dist/assets/index-DX5mgmid.js
[Request] GET http://localhost:54749/static/dist/assets/index-B4vh495l.js
[Response] 200 http://localhost:54749/static/dist/assets/index-B4vh495l.js
[Request] GET http://localhost:54749/static/dist/assets/card-CTXY0ynb.js
[Response] 200 http://localhost:54749/static/dist/assets/card-CTXY0ynb.js
[Request] GET http://localhost:54749/static/dist/assets/badge-DPL7DvXz.js
[Response] 200 http://localhost:54749/static/dist/assets/badge-DPL7DvXz.js
[Request] GET http://localhost:54749/static/dist/assets/index-QvZiqB7f.js
[Response] 200 http://localhost:54749/static/dist/assets/index-QvZiqB7f.js
[Request] GET http://localhost:54749/static/dist/assets/ToolUI-d4PjB4dB.js
[Response] 200 http://localhost:54749/static/dist/assets/ToolUI-d4PjB4dB.js
[Request] GET http://localhost:54749/static/dist/assets/input-DEzFQXe7.js
[Response] 200 http://localhost:54749/static/dist/assets/input-DEzFQXe7.js
[Request] GET http://localhost:54749/static/dist/assets/index-BdQq_4o_.js
[Response] 200 http://localhost:54749/static/dist/assets/index-BdQq_4o_.js
[Request] GET http://localhost:54749/api/v1/chat/conversations
[Request] GET http://localhost:54749/api/v1/chat/conversations/web_conv_7efe4a5c-c87e-4371-94ee-8e1681c3ccfc/messages
INFO:     127.0.0.1:49056 - "GET /api/v1/chat/conversations/web_conv_7efe4a5c-c87e-4371-94ee-8e1681c3ccfc/messages HTTP/1.1" 200 OK
INFO:     127.0.0.1:49018 - "GET /api/v1/chat/conversations HTTP/1.1" 200 OK
[Response] 200 http://localhost:54749/api/v1/chat/conversations/web_conv_7efe4a5c-c87e-4371-94ee-8e1681c3ccfc/messages
[Response] 200 http://localhost:54749/api/v1/chat/conversations
2025-08-16 04:08:38,905 - family_assistant.assistant - WARNING - Task worker exited normally, restarting...
2025-08-16 04:08:38,905 - family_assistant.assistant - INFO - Restarting task worker...
2025-08-16 04:08:38,905 - family_assistant.assistant - INFO - Task worker health monitor stopped
2025-08-16 04:08:38,906 - family_assistant.task_worker - INFO - Task worker worker-87ddeed4-3e27-4b74-8025-cdd091ac5375 run loop started.
2025-08-16 04:08:38,906 - family_assistant.task_worker - INFO - Task worker worker-87ddeed4-3e27-4b74-8025-cdd091ac5375 stopped.
Router and dynamic imports initialization complete
---------------------------- Captured stderr setup -----------------------------
INFO:     Started server process [1224487]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
INFO:     Uvicorn running on http://0.0.0.0:54749 (Press CTRL+C to quit)
------------------------------ Captured log setup ------------------------------
INFO     tests.conftest:conftest.py:178 
--- SQLite Test DB Setup (test_navigation_dropdowns_open_and_position[9-sqlite-chromium]) ---
INFO     tests.conftest:conftest.py:179 Created SQLite test engine: sqlite+aiosqlite:////tmp/fa_test_2cjp3jiz.sqlite
INFO     tests.conftest:conftest.py:246 Using sqlite test engine.
INFO     family_assistant.storage:__init__.py:260 Checking database state (attempt 1/10)...
INFO     family_assistant.storage:__init__.py:155 ALEMBIC_CONFIG env var not set. Using default path: /workspace/alembic.ini
INFO     family_assistant.storage:__init__.py:172 Alembic config loaded. Using script_location: alembic
INFO     family_assistant.storage:__init__.py:76 Inspecting database for alembic_version table...
INFO     family_assistant.storage:__init__.py:91 Alembic version table found: False
INFO     family_assistant.storage:__init__.py:270 New DB: creating schema, stamping with Alembic head...
INFO     family_assistant.storage:__init__.py:214 Creating tables from SQLAlchemy metadata...
INFO     family_assistant.storage:__init__.py:217 Tables created.
INFO     family_assistant.storage:__init__.py:184 Preparing to run Alembic command: ensure_version()
INFO     family_assistant.storage:__init__.py:190 [sync] Setting connection for Alembic: <sqlalchemy.engine.base.Connection object at 0xe516f61e12b0>
INFO     family_assistant.storage:__init__.py:192 [sync] Executing: ensure_version()
INFO     env_py:env.py:161 Running migrations in 'online' mode using provided connection.
INFO     env_py:env.py:64 do_run_migrations: Starting... Dialect: sqlite, Connection: <sqlalchemy.engine.base.Connection object at 0xe516f61e12b0>
INFO     env_py:env.py:67 do_run_migrations: Configuring context with script_location: alembic
INFO     alembic.runtime.migration:migration.py:211 Context impl SQLiteImpl.
INFO     alembic.runtime.migration:migration.py:214 Will assume non-transactional DDL.
INFO     env_py:env.py:85 do_run_migrations: Context configured. (No destination revision applicable for this command)
INFO     env_py:env.py:94 Running SQLite migrations (non-transactional DDL) for target: (N/A for this command)
INFO     env_py:env.py:105 Database migrations completed successfully.
INFO     env_py:env.py:165 Migrations finished using provided connection.
INFO     family_assistant.storage:__init__.py:195 [sync] Successfully executed: ensure_version
INFO     family_assistant.storage:__init__.py:204 Alembic command ensure_version completed.
INFO     family_assistant.storage:__init__.py:184 Preparing to run Alembic command: stamp('head')
INFO     family_assistant.storage:__init__.py:190 [sync] Setting connection for Alembic: <sqlalchemy.engine.base.Connection object at 0xe517040c3f50>
INFO     family_assistant.storage:__init__.py:192 [sync] Executing: stamp('head')
INFO     env_py:env.py:161 Running migrations in 'online' mode using provided connection.
INFO     env_py:env.py:64 do_run_migrations: Starting... Dialect: sqlite, Connection: <sqlalchemy.engine.base.Connection object at 0xe517040c3f50>
INFO     env_py:env.py:67 do_run_migrations: Configuring context with script_location: alembic
INFO     alembic.runtime.migration:migration.py:211 Context impl SQLiteImpl.
INFO     alembic.runtime.migration:migration.py:214 Will assume non-transactional DDL.
INFO     env_py:env.py:81 do_run_migrations: Context configured. Destination Revision: head
INFO     env_py:env.py:94 Running SQLite migrations (non-transactional DDL) for target: head
INFO     alembic.runtime.migration:migration.py:622 Running stamp_revision  -> 5c039369c3d7
INFO     env_py:env.py:105 Database migrations completed successfully.
INFO     env_py:env.py:165 Migrations finished using provided connection.
INFO     family_assistant.storage:__init__.py:195 [sync] Successfully executed: stamp
INFO     family_assistant.storage:__init__.py:204 Alembic command stamp completed.
INFO     family_assistant.storage:__init__.py:223 Initializing vector DB components...
WARNING  family_assistant.storage.vector:vector.py:207 Database dialect is 'sqlite', not 'postgresql'. Skipping vector extension and index creation. Vector search functionality may be limited or unavailable.
INFO     family_assistant.storage:__init__.py:232 Vector DB components initialized successfully.
INFO     family_assistant.storage:__init__.py:276 Database initialization successful.
INFO     tests.conftest:conftest.py:252 Database schema initialized.
INFO     tests.mocks.mock_llm:mock_llm.py:65 RuleBasedMockLLMClient initialized with 0 rules for model 'mock-llm-model'.
INFO     family_assistant.web.app_creator:app_creator.py:297 FastAPI debug mode set to: True
INFO     family_assistant.assistant:assistant.py:194 Using model: mock-model-for-testing
INFO     family_assistant.assistant:assistant.py:198 Stored configuration in FastAPI app state.
INFO     family_assistant.assistant:assistant.py:201 Shared httpx.AsyncClient created.
WARNING  family_assistant.assistant:assistant.py:227 No specific API key validation for model: mock-model-for-testing.
INFO     family_assistant.embeddings:embeddings.py:434 MockEmbeddingGenerator initialized for model: mock-deterministic-embedder, dimensions: 10, map size: 0, default_behavior: generate
INFO     family_assistant.assistant:assistant.py:260 Using embedding generator: MockEmbeddingGenerator with model: mock-deterministic-embedder
INFO     family_assistant.assistant:assistant.py:269 Using injected database engine
INFO     family_assistant.web.auth:auth.py:86 OIDC Authentication is DISABLED in AuthService.
INFO     family_assistant.assistant:assistant.py:285 Authentication configured with database engine
INFO     family_assistant.tools.documents:documents.py:206 Found user documentation files: ['scripting.md', 'USER_GUIDE.md', 'scheduling.md']
INFO     family_assistant.assistant:assistant.py:356 Creating root ToolsProvider with all available tools
INFO     family_assistant.tools.infrastructure:infrastructure.py:147 LocalToolsProvider initialized with 33 tools: ['add_or_update_note', 'get_note', 'list_notes', 'delete_note', 'schedule_future_callback', 'schedule_recurring_task', 'schedule_reminder', 'schedule_action', 'schedule_recurring_action', 'search_documents', 'get_full_document_content', 'get_message_history', 'get_user_documentation_content', 'ingest_document_from_url', 'send_message_to_user', 'add_calendar_event', 'search_calendar_events', 'modify_calendar_event', 'delete_calendar_event', 'delegate_to_service', 'list_pending_callbacks', 'modify_pending_callback', 'cancel_pending_callback', 'query_recent_events', 'test_event_listener', 'create_event_listener', 'list_event_listeners', 'delete_event_listener', 'toggle_event_listener', 'validate_event_listener_script', 'test_event_listener_script', 'render_home_assistant_template', 'execute_script']
INFO     family_assistant.tools.infrastructure:infrastructure.py:151 LocalToolsProvider configured with embedding generator: MockEmbeddingGenerator
INFO     family_assistant.tools.mcp:mcp.py:54 MCPToolsProvider created for 0 configured servers. Initialization timeout: 60s. Health check interval: 30s. Initialization pending.
INFO     family_assistant.tools.infrastructure:infrastructure.py:338 CompositeToolsProvider initialized with 2 providers
INFO     family_assistant.tools.mcp:mcp.py:282 Initializing MCPToolsProvider: Connecting to 0 servers...
INFO     family_assistant.tools.mcp:mcp.py:316 Waiting for MCP server connections with a timeout of 60 seconds...
INFO     family_assistant.tools.mcp:mcp.py:322 Finished parallel MCP connection attempts (within timeout).
INFO     family_assistant.tools.mcp:mcp.py:453 MCPToolsProvider finished processing all 0 configured MCP server(s) in 0.00 seconds. Summary: 0 connected, 0 failed, 0 cancelled. Active sessions: 0. Mapped 0 unique tools from 0 total definitions.
INFO     family_assistant.assistant:assistant.py:386 Root ToolsProvider initialized with 33 tools
INFO     family_assistant.assistant:assistant.py:392 Initializing ProcessingService for profile ID: 'default_assistant'
INFO     family_assistant.assistant:assistant.py:405 Profile 'default_assistant' using overridden LLM client: RuleBasedMockLLMClient
INFO     family_assistant.tools.infrastructure:infrastructure.py:478 ConfirmingToolsProvider initialized with tools requiring confirmation: {'delete_calendar_event', 'add_or_update_note'}
INFO     family_assistant.assistant:assistant.py:744 Default processing service set to profile ID: 'default_assistant'.
WARNING  family_assistant.assistant:assistant.py:753 No processors in 'indexing_pipeline_config'.
INFO     family_assistant.indexing.document_indexer:document_indexer.py:165 DocumentIndexer initialized with dynamically built pipeline including 0 processors: []
INFO     family_assistant.indexing.email_indexer:email_indexer.py:167 EmailIndexer initialized with an IndexingPipeline instance.
INFO     family_assistant.indexing.notes_indexer:notes_indexer.py:33 NotesIndexer initialized with an IndexingPipeline instance.
INFO     family_assistant.assistant:assistant.py:763 DocumentIndexer, EmailIndexer, and NotesIndexer initialized.
INFO     family_assistant.assistant:assistant.py:793 Telegram service disabled (telegram_enabled=False)
INFO     family_assistant.assistant:assistant.py:862 Telegram service disabled, skipping polling.
INFO     family_assistant.assistant:assistant.py:872 Web server running on http://0.0.0.0:54749
INFO     family_assistant.assistant:assistant.py:873 In development, run 'poe dev' and access the app at http://localhost:5173
INFO     family_assistant.assistant:assistant.py:934 Registered task handlers for worker worker-bb854dd1-f782-4283-9c0f-13278daf22f7
INFO     family_assistant.web.app_creator:app_creator.py:150 Application starting up...
INFO     family_assistant.web.auth:auth.py:86 OIDC Authentication is DISABLED in AuthService.
INFO     family_assistant.web.app_creator:app_creator.py:156 AuthService initialized with database engine
INFO     family_assistant.tools.documents:documents.py:206 Found user documentation files: ['scripting.md', 'USER_GUIDE.md', 'scheduling.md']
WARNING  family_assistant.assistant:assistant.py:1081 Task worker exited normally, restarting...
INFO     family_assistant.assistant:assistant.py:1088 Restarting task worker...
INFO     family_assistant.assistant:assistant.py:1123 Task worker health monitor stopped
----------------------------- Captured stdout call -----------------------------
[Request] GET http://localhost:54749/notes
[Response] 200 http://localhost:54749/notes
[Request] GET http://localhost:54749/static/dist/assets/router-BDyQ12Xx.js
[Response] 200 http://localhost:54749/static/dist/assets/router-BDyQ12Xx.js
[Request] GET http://localhost:54749/static/dist/assets/modulepreload-polyfill-B5Qt9EMX.js
[Response] 200 http://localhost:54749/static/dist/assets/modulepreload-polyfill-B5Qt9EMX.js
[Request] GET http://localhost:54749/static/dist/assets/markdown-DkulxR7L.js
[Response] 200 http://localhost:54749/static/dist/assets/markdown-DkulxR7L.js
[Request] GET http://localhost:54749/static/dist/assets/client-D4i40GxS.js
[Response] 200 http://localhost:54749/static/dist/assets/client-D4i40GxS.js
[Request] GET http://localhost:54749/static/dist/assets/ThemeProvider-4Nl18-8f.js
[Response] 200 http://localhost:54749/static/dist/assets/ThemeProvider-4Nl18-8f.js
[Request] GET http://localhost:54749/static/dist/assets/globals-BzhNq9eE.css
[Response] 200 http://localhost:54749/static/dist/assets/globals-BzhNq9eE.css
[Request] GET http://localhost:54749/static/dist/assets/Layout--yB9MKwc.js
[Response] 200 http://localhost:54749/static/dist/assets/Layout--yB9MKwc.js
[Request] GET http://localhost:54749/static/dist/assets/index-Cw7yfj14.js
[Response] 200 http://localhost:54749/static/dist/assets/index-Cw7yfj14.js
[Request] GET http://localhost:54749/static/dist/assets/button-C280_Z7h.js
[Response] 200 http://localhost:54749/static/dist/assets/button-C280_Z7h.js
[Request] GET http://localhost:54749/static/dist/assets/check-B4Bi62mG.js
[Response] 200 http://localhost:54749/static/dist/assets/check-B4Bi62mG.js
[Request] GET http://localhost:54749/static/dist/assets/createLucideIcon-BWE3A16L.js
[Response] 200 http://localhost:54749/static/dist/assets/createLucideIcon-BWE3A16L.js
[Request] GET http://localhost:54749/static/dist/assets/index-DJ5LtvbL.js
[Response] 200 http://localhost:54749/static/dist/assets/index-DJ5LtvbL.js
[Request] GET http://localhost:54749/static/dist/assets/index-DX5mgmid.js
[Response] 200 http://localhost:54749/static/dist/assets/index-DX5mgmid.js
[Request] GET http://localhost:54749/static/dist/assets/index-BVtkVPko.js
[Response] 200 http://localhost:54749/static/dist/assets/index-BVtkVPko.js
[Request] GET http://localhost:54749/static/dist/assets/index-DXxW798u.js
[Response] 200 http://localhost:54749/static/dist/assets/index-DXxW798u.js
[Request] GET http://localhost:54749/static/dist/assets/NavigationSheet-BR3FFw8j.js
[Response] 200 http://localhost:54749/static/dist/assets/NavigationSheet-BR3FFw8j.js
[Request] GET http://localhost:54749/static/dist/assets/index-B4vh495l.js
[Response] 200 http://localhost:54749/static/dist/assets/index-B4vh495l.js
[Request] GET http://localhost:54749/static/dist/assets/NotesApp-DTM5rAw_.js
[Response] 200 http://localhost:54749/static/dist/assets/NotesApp-DTM5rAw_.js
[Request] GET http://localhost:54749/static/dist/assets/data-table-INSCgcXf.js
[Response] 200 http://localhost:54749/static/dist/assets/data-table-INSCgcXf.js
[Request] GET http://localhost:54749/static/dist/assets/input-DEzFQXe7.js
[Response] 200 http://localhost:54749/static/dist/assets/input-DEzFQXe7.js
[Request] GET http://localhost:54749/static/dist/assets/chevron-up-C2znuyBj.js
[Response] 200 http://localhost:54749/static/dist/assets/chevron-up-C2znuyBj.js
[Request] GET http://localhost:54749/static/dist/assets/textarea-1cCUDJPF.js
[Response] 200 http://localhost:54749/static/dist/assets/textarea-1cCUDJPF.js
[Request] GET http://localhost:54749/static/dist/assets/checkbox-B_ltOU5r.js
[Response] 200 http://localhost:54749/static/dist/assets/checkbox-B_ltOU5r.js
[Request] GET http://localhost:54749/static/dist/assets/label-taXZMDI0.js
[Response] 200 http://localhost:54749/static/dist/assets/label-taXZMDI0.js
[Request] GET http://localhost:54749/static/dist/assets/card-CTXY0ynb.js
[Response] 200 http://localhost:54749/static/dist/assets/card-CTXY0ynb.js
[Request] GET http://localhost:54749/static/dist/assets/alert-BaJRipSp.js
[Response] 200 http://localhost:54749/static/dist/assets/alert-BaJRipSp.js
[Request] GET http://localhost:54749/api/notes/
INFO:     127.0.0.1:49018 - "GET /api/notes/ HTTP/1.1" 200 OK
[Response] 200 http://localhost:54749/api/notes/
--------------------------- Captured stdout teardown ---------------------------
2025-08-16 04:08:43,424 - family_assistant.assistant - WARNING - Received signal TEST. Initiating shutdown via Assistant...
2025-08-16 04:08:43,424 - family_assistant.assistant - INFO - Shutdown signal received by Assistant. Stopping services...
2025-08-16 04:08:43,609 - family_assistant.web.app_creator - INFO - Application shutting down...
2025-08-16 04:08:43,609 - family_assistant.assistant - INFO - Web server stopped.
2025-08-16 04:08:43,610 - tests.conftest - INFO - --- Test DB Teardown (test_navigation_dropdowns_open_and_position[9-sqlite-chromium]) ---
2025-08-16 04:08:43,618 - tests.conftest - INFO - Test engine disposed.
2025-08-16 04:08:43,619 - tests.conftest - INFO - Removed temporary SQLite database file.
2025-08-16 04:08:43,687 - tests.conftest - INFO - External PostgreSQL usage completed.

=== Browser closed successfully ===

=== Playwright stopped successfully ===
2025-08-16 04:08:43,755 - family_assistant.assistant - INFO - Task worker health monitor stopped
2025-08-16 04:08:43,755 - family_assistant.assistant - INFO - Task worker health monitor stopped
--------------------------- Captured stderr teardown ---------------------------
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:     Application shutdown complete.
INFO:     Finished server process [1224487]
---------------------------- Captured log teardown -----------------------------
WARNING  family_assistant.assistant:assistant.py:963 Received signal TEST. Initiating shutdown via Assistant...
INFO     family_assistant.assistant:assistant.py:951 Shutdown signal received by Assistant. Stopping services...
INFO     family_assistant.web.app_creator:app_creator.py:167 Application shutting down...
INFO     family_assistant.assistant:assistant.py:956 Web server stopped.
INFO     tests.conftest:conftest.py:259 --- Test DB Teardown (test_navigation_dropdowns_open_and_position[9-sqlite-chromium]) ---
INFO     tests.conftest:conftest.py:274 Test engine disposed.
INFO     tests.conftest:conftest.py:277 Removed temporary SQLite database file.
INFO     tests.conftest:conftest.py:548 External PostgreSQL usage completed.
INFO     family_assistant.assistant:assistant.py:1123 Task worker health monitor stopped
INFO     family_assistant.assistant:assistant.py:1123 Task worker health monitor stopped
________ test_navigation_dropdowns_open_and_position[2-sqlite-chromium] ________
[gw0] linux -- Python 3.12.3 /workspace/.venv/bin/python3

web_test_fixture = WebTestFixture(assistant=<family_assistant.assistant.Assistant object at 0xe576bc26d820>, page=<Page url='http://localhost:42461/notes'>, base_url='http://localhost:42461')

    @pytest.mark.playwright
    @pytest.mark.asyncio
    async def test_navigation_dropdowns_open_and_position(
        web_test_fixture: WebTestFixture,
    ) -> None:
        """Test that navigation dropdowns open and are positioned correctly to be usable.
    
        This test handles the timing complexities of RadixUI NavigationMenu which uses
        animations and asynchronous state updates."""
        page = web_test_fixture.page
        base_url = web_test_fixture.base_url
    
        # Navigate to notes page which has the full navigation menu
        await page.goto(f"{base_url}/notes")
        await page.wait_for_load_state("networkidle")
    
        # Wait for navigation to be rendered and interactive
        await page.wait_for_selector(
            "nav[data-orientation='horizontal']", state="visible", timeout=10000
        )
    
        # Wait for navigation to be fully ready and interactive
        await page.wait_for_function(
            """() => {
                const btn = Array.from(document.querySelectorAll('button')).find(b => b.textContent?.includes('Data'));
                if (!btn) return false;
                const style = getComputedStyle(btn);
                const rect = btn.getBoundingClientRect();
                return style.visibility === 'visible' &&
                       style.opacity === '1' &&
                       rect.width > 0 &&
                       rect.height > 0 &&
                       !btn.disabled;
            }""",
            timeout=3000,
        )
    
        # Test Data dropdown
        data_trigger = page.locator("button:has-text('Data')").first
        await data_trigger.wait_for(state="visible", timeout=5000)
    
        # Ensure the button is actually interactive before clicking
        await page.wait_for_function(
            """() => {
                const buttons = Array.from(document.querySelectorAll('button'));
                const btn = buttons.find(b => b.textContent?.includes('Data'));
                if (!btn) return false;
                const rect = btn.getBoundingClientRect();
                return rect.width > 0 && rect.height > 0;
            }""",
            timeout=5000,
        )
    
        # Click with retry logic in case of timing issues
        for attempt in range(3):
            try:
                await data_trigger.click()
    
                # Wait for dropdown to be fully open with content visible
                await page.wait_for_function(
                    """() => {
                        const buttons = Array.from(document.querySelectorAll('button'));
                        const btn = buttons.find(b => b.textContent?.includes('Data'));
                        if (!btn || btn.getAttribute('aria-expanded') !== 'true') return false;
    
                        const links = Array.from(document.querySelectorAll('a'));
                        const notesLink = links.find(a => a.textContent?.includes('Notes'));
                        if (!notesLink) return false;
    
                        const style = getComputedStyle(notesLink);
                        const rect = notesLink.getBoundingClientRect();
    
                        return style.visibility === 'visible' &&
                               style.opacity === '1' &&
                               rect.width > 0 &&
                               rect.height > 0;
                    }""",
                    timeout=3000,
                )
                break
            except Exception:
                if attempt == 2:
                    raise
                await page.wait_for_timeout(500)
    
        # Check that dropdown opened (button should be expanded)
        is_expanded = await data_trigger.get_attribute("aria-expanded")
        assert is_expanded == "true", "Data dropdown should be expanded after click"
    
        # Ensure dropdown content is visible (look for Notes link)
        notes_link = page.locator("a:has-text('Notes')")
        await notes_link.wait_for(state="visible", timeout=2000)
    
        # Get positions to verify reasonable positioning
        trigger_box = await data_trigger.bounding_box()
        notes_box = await notes_link.bounding_box()
    
        assert trigger_box is not None, "Should be able to get trigger bounding box"
        assert notes_box is not None, "Should be able to get dropdown content bounding box"
    
        # The dropdown should appear below the trigger (reasonable Y positioning)
        assert notes_box["y"] > trigger_box["y"], "Dropdown should appear below trigger"
    
        # The dropdown should not be at the far left edge (x > 10px from left)
        assert notes_box["x"] > 10, (
            f"Dropdown should not be at far left edge, got x={notes_box['x']}"
        )
    
        # Close the Data dropdown by clicking outside
        await page.locator("body").click()
    
        # Wait for the dropdown to fully close before proceeding
        await page.wait_for_function(
            """() => {
                const buttons = Array.from(document.querySelectorAll('button'));
                const btn = buttons.find(b => b.textContent?.includes('Data'));
                return !btn || btn.getAttribute('aria-expanded') !== 'true';
            }""",
            timeout=3000,
        )
    
        # Wait for dropdown to be fully closed
        await page.wait_for_function(
            """() => {
                const buttons = Array.from(document.querySelectorAll('button'));
                const dataBtn = buttons.find(b => b.textContent?.includes('Data'));
                if (!dataBtn) return false;
                // Check aria-expanded is false or not present
                const expanded = dataBtn.getAttribute('aria-expanded');
                return !expanded || expanded === 'false';
            }""",
            timeout=3000,
        )
    
        # Test Internal dropdown with fresh state
        internal_trigger = page.locator("button:has-text('Internal')").first
        await internal_trigger.wait_for(state="visible", timeout=5000)
    
        # Ensure the Internal button is interactive
        await page.wait_for_function(
            """() => {
                const buttons = Array.from(document.querySelectorAll('button'));
                const btn = buttons.find(b => b.textContent?.includes('Internal'));
                if (!btn) return false;
                const rect = btn.getBoundingClientRect();
                return rect.width > 0 && rect.height > 0;
            }""",
            timeout=5000,
        )
    
        # Click with retry logic
        for attempt in range(3):
            try:
                await internal_trigger.click()
    
                # Wait for dropdown content to be fully visible and interactive
                await page.wait_for_function(
                    """() => {
                        const buttons = Array.from(document.querySelectorAll('button'));
                        const btn = buttons.find(b => b.textContent?.includes('Internal'));
                        if (!btn || btn.getAttribute('aria-expanded') !== 'true') return false;
    
                        const links = Array.from(document.querySelectorAll('a'));
                        const toolsLink = links.find(a => a.textContent?.includes('Tools'));
                        if (!toolsLink) return false;
    
                        const rect = toolsLink.getBoundingClientRect();
                        const style = getComputedStyle(toolsLink);
    
                        return rect.width > 0 &&
                               rect.height > 0 &&
                               style.visibility === 'visible' &&
                               style.opacity === '1' &&
                               style.display !== 'none';
                    }""",
                    timeout=3000,
                )
                break
            except Exception:
                if attempt == 2:
                    raise
                # Click outside to reset state
                await page.locator("body").click()
                # Wait for dropdown to close before retry
                await page.wait_for_function(
                    """() => {
                        const buttons = Array.from(document.querySelectorAll('button'));
                        const btn = buttons.find(b => b.textContent?.includes('Internal'));
                        if (!btn) return true;  // If button not found, consider it reset
                        const expanded = btn.getAttribute('aria-expanded');
                        return !expanded || expanded === 'false';
                    }""",
                    timeout=2000,
                )
    
        # Find the Tools link
        tools_link = page.locator("a:has-text('Tools')")
    
        # The key test: Can we actually see the dropdown content?
        is_tools_visible = await tools_link.is_visible()
>       assert is_tools_visible, "Tools link should be visible in Internal dropdown"
E       AssertionError: Tools link should be visible in Internal dropdown
E       assert False

tests/functional/web/test_page_layout.py:208: AssertionError
---------------------------- Captured stdout setup -----------------------------
2025-08-16 04:08:55,699 - tests.conftest - INFO - 
--- SQLite Test DB Setup (test_navigation_dropdowns_open_and_position[2-sqlite-chromium]) ---
2025-08-16 04:08:55,699 - tests.conftest - INFO - Created SQLite test engine: sqlite+aiosqlite:////tmp/fa_test_adbi9i5i.sqlite
2025-08-16 04:08:55,699 - tests.conftest - INFO - Using sqlite test engine.
2025-08-16 04:08:55,699 - family_assistant.storage - INFO - Checking database state (attempt 1/10)...
2025-08-16 04:08:55,699 - family_assistant.storage - INFO - ALEMBIC_CONFIG env var not set. Using default path: /workspace/alembic.ini
2025-08-16 04:08:55,700 - family_assistant.storage - INFO - Alembic config loaded. Using script_location: alembic
2025-08-16 04:08:55,700 - family_assistant.storage - INFO - Inspecting database for alembic_version table...
2025-08-16 04:08:55,714 - family_assistant.storage - INFO - Alembic version table found: False
2025-08-16 04:08:55,714 - family_assistant.storage - INFO - New DB: creating schema, stamping with Alembic head...
2025-08-16 04:08:55,714 - family_assistant.storage - INFO - Creating tables from SQLAlchemy metadata...
2025-08-16 04:08:55,779 - family_assistant.storage - INFO - Tables created.
2025-08-16 04:08:55,779 - family_assistant.storage - INFO - Preparing to run Alembic command: ensure_version()
2025-08-16 04:08:55,780 - family_assistant.storage - INFO - [sync] Setting connection for Alembic: <sqlalchemy.engine.base.Connection object at 0xe576dc1ca0f0>
2025-08-16 04:08:55,780 - family_assistant.storage - INFO - [sync] Executing: ensure_version()
2025-08-16 04:08:55,780 - env_py - INFO - Running migrations in 'online' mode using provided connection.
2025-08-16 04:08:55,781 - env_py - INFO - do_run_migrations: Starting... Dialect: sqlite, Connection: <sqlalchemy.engine.base.Connection object at 0xe576dc1ca0f0>
2025-08-16 04:08:55,781 - env_py - INFO - do_run_migrations: Configuring context with script_location: alembic
2025-08-16 04:08:55,781 - alembic.runtime.migration - INFO - Context impl SQLiteImpl.
2025-08-16 04:08:55,781 - alembic.runtime.migration - INFO - Will assume non-transactional DDL.
2025-08-16 04:08:55,781 - env_py - INFO - do_run_migrations: Context configured. (No destination revision applicable for this command)
2025-08-16 04:08:55,781 - env_py - INFO - Running SQLite migrations (non-transactional DDL) for target: (N/A for this command)
2025-08-16 04:08:55,786 - env_py - INFO - Database migrations completed successfully.
2025-08-16 04:08:55,787 - env_py - INFO - Migrations finished using provided connection.
2025-08-16 04:08:55,787 - family_assistant.storage - INFO - [sync] Successfully executed: ensure_version
2025-08-16 04:08:55,787 - family_assistant.storage - INFO - Alembic command ensure_version completed.
2025-08-16 04:08:55,787 - family_assistant.storage - INFO - Preparing to run Alembic command: stamp('head')
2025-08-16 04:08:55,788 - family_assistant.storage - INFO - [sync] Setting connection for Alembic: <sqlalchemy.engine.base.Connection object at 0xe576bc1fe000>
2025-08-16 04:08:55,788 - family_assistant.storage - INFO - [sync] Executing: stamp('head')
2025-08-16 04:08:55,789 - env_py - INFO - Running migrations in 'online' mode using provided connection.
2025-08-16 04:08:55,789 - env_py - INFO - do_run_migrations: Starting... Dialect: sqlite, Connection: <sqlalchemy.engine.base.Connection object at 0xe576bc1fe000>
2025-08-16 04:08:55,789 - env_py - INFO - do_run_migrations: Configuring context with script_location: alembic
2025-08-16 04:08:55,789 - alembic.runtime.migration - INFO - Context impl SQLiteImpl.
2025-08-16 04:08:55,789 - alembic.runtime.migration - INFO - Will assume non-transactional DDL.
2025-08-16 04:08:55,794 - env_py - INFO - do_run_migrations: Context configured. Destination Revision: head
2025-08-16 04:08:55,794 - env_py - INFO - Running SQLite migrations (non-transactional DDL) for target: head
2025-08-16 04:08:55,797 - alembic.runtime.migration - INFO - Running stamp_revision  -> 5c039369c3d7
2025-08-16 04:08:55,799 - env_py - INFO - Database migrations completed successfully.
2025-08-16 04:08:55,799 - env_py - INFO - Migrations finished using provided connection.
2025-08-16 04:08:55,799 - family_assistant.storage - INFO - [sync] Successfully executed: stamp
2025-08-16 04:08:55,799 - family_assistant.storage - INFO - Alembic command stamp completed.
2025-08-16 04:08:55,800 - family_assistant.storage - INFO - Initializing vector DB components...
2025-08-16 04:08:55,801 - family_assistant.storage.vector - WARNING - Database dialect is 'sqlite', not 'postgresql'. Skipping vector extension and index creation. Vector search functionality may be limited or unavailable.
2025-08-16 04:08:55,801 - family_assistant.storage - INFO - Vector DB components initialized successfully.
2025-08-16 04:08:55,801 - family_assistant.storage - INFO - Database initialization successful.
2025-08-16 04:08:55,801 - tests.conftest - INFO - Database schema initialized.
2025-08-16 04:08:55,802 - tests.mocks.mock_llm - INFO - RuleBasedMockLLMClient initialized with 0 rules for model 'mock-llm-model'.

=== Starting API server on port 42461 ===
2025-08-16 04:08:55,802 - family_assistant.web.app_creator - INFO - FastAPI debug mode set to: True
Setting up dependencies...
2025-08-16 04:08:55,802 - family_assistant.assistant - INFO - Using model: mock-model-for-testing
2025-08-16 04:08:55,802 - family_assistant.assistant - INFO - Stored configuration in FastAPI app state.
2025-08-16 04:08:55,834 - family_assistant.assistant - INFO - Shared httpx.AsyncClient created.
2025-08-16 04:08:55,834 - family_assistant.assistant - WARNING - No specific API key validation for model: mock-model-for-testing.
2025-08-16 04:08:55,834 - family_assistant.embeddings - INFO - MockEmbeddingGenerator initialized for model: mock-deterministic-embedder, dimensions: 10, map size: 0, default_behavior: generate
2025-08-16 04:08:55,834 - family_assistant.assistant - INFO - Using embedding generator: MockEmbeddingGenerator with model: mock-deterministic-embedder
2025-08-16 04:08:55,834 - family_assistant.assistant - INFO - Using injected database engine
2025-08-16 04:08:55,834 - family_assistant.web.auth - INFO - OIDC Authentication is DISABLED in AuthService.
2025-08-16 04:08:55,834 - family_assistant.assistant - INFO - Authentication configured with database engine
2025-08-16 04:08:55,835 - family_assistant.tools.documents - INFO - Found user documentation files: ['scripting.md', 'USER_GUIDE.md', 'scheduling.md']
2025-08-16 04:08:55,835 - family_assistant.assistant - INFO - Creating root ToolsProvider with all available tools
2025-08-16 04:08:55,835 - family_assistant.tools.infrastructure - INFO - LocalToolsProvider initialized with 33 tools: ['add_or_update_note', 'get_note', 'list_notes', 'delete_note', 'schedule_future_callback', 'schedule_recurring_task', 'schedule_reminder', 'schedule_action', 'schedule_recurring_action', 'search_documents', 'get_full_document_content', 'get_message_history', 'get_user_documentation_content', 'ingest_document_from_url', 'send_message_to_user', 'add_calendar_event', 'search_calendar_events', 'modify_calendar_event', 'delete_calendar_event', 'delegate_to_service', 'list_pending_callbacks', 'modify_pending_callback', 'cancel_pending_callback', 'query_recent_events', 'test_event_listener', 'create_event_listener', 'list_event_listeners', 'delete_event_listener', 'toggle_event_listener', 'validate_event_listener_script', 'test_event_listener_script', 'render_home_assistant_template', 'execute_script']
2025-08-16 04:08:55,835 - family_assistant.tools.infrastructure - INFO - LocalToolsProvider configured with embedding generator: MockEmbeddingGenerator
2025-08-16 04:08:55,836 - family_assistant.tools.mcp - INFO - MCPToolsProvider created for 0 configured servers. Initialization timeout: 60s. Health check interval: 30s. Initialization pending.
2025-08-16 04:08:55,836 - family_assistant.tools.infrastructure - INFO - CompositeToolsProvider initialized with 2 providers
2025-08-16 04:08:55,836 - family_assistant.tools.mcp - INFO - Initializing MCPToolsProvider: Connecting to 0 servers...
2025-08-16 04:08:55,836 - family_assistant.tools.mcp - INFO - Waiting for MCP server connections with a timeout of 60 seconds...
2025-08-16 04:08:55,836 - family_assistant.tools.mcp - INFO - Finished parallel MCP connection attempts (within timeout).
2025-08-16 04:08:55,836 - family_assistant.tools.mcp - INFO - MCPToolsProvider finished processing all 0 configured MCP server(s) in 0.00 seconds. Summary: 0 connected, 0 failed, 0 cancelled. Active sessions: 0. Mapped 0 unique tools from 0 total definitions.
2025-08-16 04:08:55,836 - family_assistant.assistant - INFO - Root ToolsProvider initialized with 33 tools
2025-08-16 04:08:55,836 - family_assistant.assistant - INFO - Initializing ProcessingService for profile ID: 'default_assistant'
2025-08-16 04:08:55,836 - family_assistant.assistant - INFO - Profile 'default_assistant' using overridden LLM client: RuleBasedMockLLMClient
2025-08-16 04:08:55,836 - family_assistant.tools.infrastructure - INFO - ConfirmingToolsProvider initialized with tools requiring confirmation: {'delete_calendar_event', 'add_or_update_note'}
2025-08-16 04:08:55,836 - family_assistant.assistant - INFO - Default processing service set to profile ID: 'default_assistant'.
2025-08-16 04:08:55,855 - family_assistant.assistant - WARNING - No processors in 'indexing_pipeline_config'.
2025-08-16 04:08:55,855 - family_assistant.indexing.document_indexer - INFO - DocumentIndexer initialized with dynamically built pipeline including 0 processors: []
2025-08-16 04:08:55,856 - family_assistant.indexing.email_indexer - INFO - EmailIndexer initialized with an IndexingPipeline instance.
2025-08-16 04:08:55,856 - family_assistant.indexing.notes_indexer - INFO - NotesIndexer initialized with an IndexingPipeline instance.
2025-08-16 04:08:55,856 - family_assistant.assistant - INFO - DocumentIndexer, EmailIndexer, and NotesIndexer initialized.
2025-08-16 04:08:55,856 - family_assistant.assistant - INFO - Telegram service disabled (telegram_enabled=False)
Dependencies set up
Starting API services on port 42461...
Waiting for server initialization...
2025-08-16 04:08:55,856 - family_assistant.assistant - INFO - Telegram service disabled, skipping polling.
2025-08-16 04:08:55,857 - family_assistant.assistant - INFO - Web server running on http://0.0.0.0:42461
2025-08-16 04:08:55,857 - family_assistant.assistant - INFO - In development, run 'poe dev' and access the app at http://localhost:5173
2025-08-16 04:08:55,857 - family_assistant.task_worker - INFO - TaskWorker instance worker-882a8055-58a2-49ff-bd3a-391c5b826e3e created.
2025-08-16 04:08:55,857 - family_assistant.task_worker - INFO - Worker worker-882a8055-58a2-49ff-bd3a-391c5b826e3e: Registered handler for task type: log_message
2025-08-16 04:08:55,857 - family_assistant.task_worker - INFO - Worker worker-882a8055-58a2-49ff-bd3a-391c5b826e3e: Registered handler for task type: process_uploaded_document
2025-08-16 04:08:55,857 - family_assistant.task_worker - INFO - Worker worker-882a8055-58a2-49ff-bd3a-391c5b826e3e: Registered handler for task type: index_email
2025-08-16 04:08:55,857 - family_assistant.task_worker - INFO - Worker worker-882a8055-58a2-49ff-bd3a-391c5b826e3e: Registered handler for task type: index_note
2025-08-16 04:08:55,857 - family_assistant.task_worker - INFO - Worker worker-882a8055-58a2-49ff-bd3a-391c5b826e3e: Registered handler for task type: llm_callback
2025-08-16 04:08:55,857 - family_assistant.task_worker - INFO - Worker worker-882a8055-58a2-49ff-bd3a-391c5b826e3e: Registered handler for task type: embed_and_store_batch
2025-08-16 04:08:55,857 - family_assistant.task_worker - INFO - Worker worker-882a8055-58a2-49ff-bd3a-391c5b826e3e: Registered handler for task type: system_event_cleanup
2025-08-16 04:08:55,857 - family_assistant.task_worker - INFO - Worker worker-882a8055-58a2-49ff-bd3a-391c5b826e3e: Registered handler for task type: system_error_log_cleanup
2025-08-16 04:08:55,857 - family_assistant.task_worker - INFO - Worker worker-882a8055-58a2-49ff-bd3a-391c5b826e3e: Registered handler for task type: script_execution
2025-08-16 04:08:55,857 - family_assistant.task_worker - INFO - Worker worker-882a8055-58a2-49ff-bd3a-391c5b826e3e: Registered handler for task type: reindex_document
2025-08-16 04:08:55,857 - family_assistant.assistant - INFO - Registered task handlers for worker worker-882a8055-58a2-49ff-bd3a-391c5b826e3e
2025-08-16 04:08:55,858 - family_assistant.task_worker - INFO - Task worker worker-882a8055-58a2-49ff-bd3a-391c5b826e3e run loop started.
2025-08-16 04:08:55,858 - family_assistant.task_worker - INFO - Task worker worker-882a8055-58a2-49ff-bd3a-391c5b826e3e stopped.
2025-08-16 04:08:55,858 - family_assistant.web.app_creator - INFO - Application starting up...
2025-08-16 04:08:55,858 - family_assistant.web.auth - INFO - OIDC Authentication is DISABLED in AuthService.
2025-08-16 04:08:55,858 - family_assistant.web.app_creator - INFO - AuthService initialized with database engine
Starting health checks...
Waiting for server at http://localhost:42461 (health check: http://localhost:42461/health)
INFO:     127.0.0.1:53240 - "GET /health HTTP/1.1" 200 OK
[0.0s] Health check response: 200
[0.0s] âœ“ Health check passed for http://localhost:42461/health
INFO:     127.0.0.1:53240 - "GET / HTTP/1.1" 302 Found
[0.0s] Root endpoint response: 302

=== API server ready on port 42461 ===
Pre-loading router to initialize dynamic import resolution...
[Request] GET http://localhost:42461/
INFO:     127.0.0.1:53252 - "GET / HTTP/1.1" 302 Found
[Response] 302 http://localhost:42461/
[Request] GET http://localhost:42461/chat
INFO:     127.0.0.1:53252 - "GET /chat HTTP/1.1" 200 OK
[Response] 200 http://localhost:42461/chat
INFO:     127.0.0.1:53252 - "GET /static/dist/assets/router-BDyQ12Xx.js HTTP/1.1" 200 OK
[Request] GET http://localhost:42461/static/dist/assets/router-BDyQ12Xx.js
[Request] GET http://localhost:42461/static/dist/assets/modulepreload-polyfill-B5Qt9EMX.js
INFO:     127.0.0.1:53264 - "GET /static/dist/assets/globals-BzhNq9eE.css HTTP/1.1" 200 OK
INFO:     127.0.0.1:53276 - "GET /static/dist/assets/markdown-DkulxR7L.js HTTP/1.1" 200 OK
INFO:     127.0.0.1:53272 - "GET /static/dist/assets/modulepreload-polyfill-B5Qt9EMX.js HTTP/1.1" 200 OK
[Request] GET http://localhost:42461/static/dist/assets/markdown-DkulxR7L.js
[Request] GET http://localhost:42461/static/dist/assets/client-D4i40GxS.js
INFO:     127.0.0.1:53292 - "GET /static/dist/assets/client-D4i40GxS.js HTTP/1.1" 200 OK
INFO:     127.0.0.1:53296 - "GET /static/dist/assets/ThemeProvider-4Nl18-8f.js HTTP/1.1" 200 OK
[Request] GET http://localhost:42461/static/dist/assets/ThemeProvider-4Nl18-8f.js
[Request] GET http://localhost:42461/static/dist/assets/globals-BzhNq9eE.css
[Response] 200 http://localhost:42461/static/dist/assets/globals-BzhNq9eE.css
[Response] 200 http://localhost:42461/static/dist/assets/router-BDyQ12Xx.js
[Response] 200 http://localhost:42461/static/dist/assets/modulepreload-polyfill-B5Qt9EMX.js
[Response] 200 http://localhost:42461/static/dist/assets/ThemeProvider-4Nl18-8f.js
[Response] 200 http://localhost:42461/static/dist/assets/markdown-DkulxR7L.js
[Response] 200 http://localhost:42461/static/dist/assets/client-D4i40GxS.js
[Request] GET http://localhost:42461/static/dist/assets/ChatApp-BGzR61B2.js
[Request] GET http://localhost:42461/static/dist/assets/button-C280_Z7h.js
[Request] GET http://localhost:42461/static/dist/assets/NavigationSheet-BR3FFw8j.js
[Request] GET http://localhost:42461/static/dist/assets/createLucideIcon-BWE3A16L.js
[Request] GET http://localhost:42461/static/dist/assets/check-B4Bi62mG.js
[Request] GET http://localhost:42461/static/dist/assets/index-DJ5LtvbL.js
[Request] GET http://localhost:42461/static/dist/assets/index-Cw7yfj14.js
[Request] GET http://localhost:42461/static/dist/assets/index-DX5mgmid.js
[Request] GET http://localhost:42461/static/dist/assets/index-B4vh495l.js
[Request] GET http://localhost:42461/static/dist/assets/card-CTXY0ynb.js
[Request] GET http://localhost:42461/static/dist/assets/badge-DPL7DvXz.js
[Request] GET http://localhost:42461/static/dist/assets/index-QvZiqB7f.js
[Request] GET http://localhost:42461/static/dist/assets/ToolUI-d4PjB4dB.js
INFO:     127.0.0.1:53264 - "GET /static/dist/assets/createLucideIcon-BWE3A16L.js HTTP/1.1" 200 OK
[Request] GET http://localhost:42461/static/dist/assets/input-DEzFQXe7.js
INFO:     127.0.0.1:53252 - "GET /static/dist/assets/index-DJ5LtvbL.js HTTP/1.1" 200 OK
INFO:     127.0.0.1:53296 - "GET /static/dist/assets/NavigationSheet-BR3FFw8j.js HTTP/1.1" 200 OK
INFO:     127.0.0.1:53272 - "GET /static/dist/assets/check-B4Bi62mG.js HTTP/1.1" 200 OK
[Request] GET http://localhost:42461/static/dist/assets/index-BdQq_4o_.js
INFO:     127.0.0.1:53276 - "GET /static/dist/assets/button-C280_Z7h.js HTTP/1.1" 200 OK
INFO:     127.0.0.1:53292 - "GET /static/dist/assets/ChatApp-BGzR61B2.js HTTP/1.1" 200 OK
[Response] 200 http://localhost:42461/static/dist/assets/createLucideIcon-BWE3A16L.js
INFO:     127.0.0.1:53252 - "GET /static/dist/assets/index-DX5mgmid.js HTTP/1.1" 200 OK
INFO:     127.0.0.1:53264 - "GET /static/dist/assets/index-B4vh495l.js HTTP/1.1" 200 OK
[Response] 200 http://localhost:42461/static/dist/assets/check-B4Bi62mG.js
INFO:     127.0.0.1:53296 - "GET /static/dist/assets/index-Cw7yfj14.js HTTP/1.1" 200 OK
INFO:     127.0.0.1:53272 - "GET /static/dist/assets/card-CTXY0ynb.js HTTP/1.1" 200 OK
[Response] 200 http://localhost:42461/static/dist/assets/NavigationSheet-BR3FFw8j.js
[Response] 200 http://localhost:42461/static/dist/assets/index-DJ5LtvbL.js
[Response] 200 http://localhost:42461/static/dist/assets/button-C280_Z7h.js
INFO:     127.0.0.1:53276 - "GET /static/dist/assets/badge-DPL7DvXz.js HTTP/1.1" 200 OK
[Response] 200 http://localhost:42461/static/dist/assets/index-B4vh495l.js
[Response] 200 http://localhost:42461/static/dist/assets/index-Cw7yfj14.js
INFO:     127.0.0.1:53272 - "GET /static/dist/assets/index-BdQq_4o_.js HTTP/1.1" 200 OK
INFO:     127.0.0.1:53264 - "GET /static/dist/assets/ToolUI-d4PjB4dB.js HTTP/1.1" 200 OK
INFO:     127.0.0.1:53296 - "GET /static/dist/assets/input-DEzFQXe7.js HTTP/1.1" 200 OK
INFO:     127.0.0.1:53292 - "GET /static/dist/assets/index-QvZiqB7f.js HTTP/1.1" 200 OK
[Response] 200 http://localhost:42461/static/dist/assets/ChatApp-BGzR61B2.js
[Response] 200 http://localhost:42461/static/dist/assets/card-CTXY0ynb.js
[Response] 200 http://localhost:42461/static/dist/assets/index-DX5mgmid.js
[Response] 200 http://localhost:42461/static/dist/assets/badge-DPL7DvXz.js
[Response] 200 http://localhost:42461/static/dist/assets/index-BdQq_4o_.js
[Response] 200 http://localhost:42461/static/dist/assets/input-DEzFQXe7.js
[Response] 200 http://localhost:42461/static/dist/assets/index-QvZiqB7f.js
[Response] 200 http://localhost:42461/static/dist/assets/ToolUI-d4PjB4dB.js
[Request] GET http://localhost:42461/api/v1/chat/conversations
INFO:     127.0.0.1:53264 - "GET /api/v1/chat/conversations HTTP/1.1" 200 OK
[Response] 200 http://localhost:42461/api/v1/chat/conversations
Pre-loading route: /docs
[Request] GET http://localhost:42461/docs
INFO:     127.0.0.1:53264 - "GET /docs HTTP/1.1" 200 OK
[Response] 200 http://localhost:42461/docs
[Request] GET http://localhost:42461/static/dist/assets/router-BDyQ12Xx.js
[Response] 200 http://localhost:42461/static/dist/assets/router-BDyQ12Xx.js
[Request] GET http://localhost:42461/static/dist/assets/modulepreload-polyfill-B5Qt9EMX.js
[Response] 200 http://localhost:42461/static/dist/assets/modulepreload-polyfill-B5Qt9EMX.js
[Request] GET http://localhost:42461/static/dist/assets/markdown-DkulxR7L.js
[Response] 200 http://localhost:42461/static/dist/assets/markdown-DkulxR7L.js
[Request] GET http://localhost:42461/static/dist/assets/client-D4i40GxS.js
[Response] 200 http://localhost:42461/static/dist/assets/client-D4i40GxS.js
[Request] GET http://localhost:42461/static/dist/assets/ThemeProvider-4Nl18-8f.js
[Response] 200 http://localhost:42461/static/dist/assets/ThemeProvider-4Nl18-8f.js
[Request] GET http://localhost:42461/static/dist/assets/globals-BzhNq9eE.css
[Response] 200 http://localhost:42461/static/dist/assets/globals-BzhNq9eE.css
[Request] GET http://localhost:42461/static/dist/assets/Layout--yB9MKwc.js
[Request] GET http://localhost:42461/static/dist/assets/index-Cw7yfj14.js
[Response] 200 http://localhost:42461/static/dist/assets/index-Cw7yfj14.js
[Request] GET http://localhost:42461/static/dist/assets/button-C280_Z7h.js
[Response] 200 http://localhost:42461/static/dist/assets/button-C280_Z7h.js
[Request] GET http://localhost:42461/static/dist/assets/check-B4Bi62mG.js
[Response] 200 http://localhost:42461/static/dist/assets/check-B4Bi62mG.js
[Request] GET http://localhost:42461/static/dist/assets/createLucideIcon-BWE3A16L.js
[Response] 200 http://localhost:42461/static/dist/assets/createLucideIcon-BWE3A16L.js
[Request] GET http://localhost:42461/static/dist/assets/index-DJ5LtvbL.js
[Response] 200 http://localhost:42461/static/dist/assets/index-DJ5LtvbL.js
[Request] GET http://localhost:42461/static/dist/assets/index-DX5mgmid.js
[Response] 200 http://localhost:42461/static/dist/assets/index-DX5mgmid.js
INFO:     127.0.0.1:53264 - "GET /static/dist/assets/Layout--yB9MKwc.js HTTP/1.1" 200 OK
[Request] GET http://localhost:42461/static/dist/assets/index-BVtkVPko.js
INFO:     127.0.0.1:53292 - "GET /static/dist/assets/index-DXxW798u.js HTTP/1.1" 200 OK
[Request] GET http://localhost:42461/static/dist/assets/index-DXxW798u.js
[Request] GET http://localhost:42461/static/dist/assets/NavigationSheet-BR3FFw8j.js
[Response] 200 http://localhost:42461/static/dist/assets/NavigationSheet-BR3FFw8j.js
[Request] GET http://localhost:42461/static/dist/assets/index-B4vh495l.js
[Response] 200 http://localhost:42461/static/dist/assets/index-B4vh495l.js
INFO:     127.0.0.1:53296 - "GET /static/dist/assets/index-BVtkVPko.js HTTP/1.1" 200 OK
[Response] 200 http://localhost:42461/static/dist/assets/index-DXxW798u.js
[Response] 200 http://localhost:42461/static/dist/assets/index-BVtkVPko.js
[Response] 200 http://localhost:42461/static/dist/assets/Layout--yB9MKwc.js
[Request] GET http://localhost:42461/static/dist/assets/DocumentationApp-DJMW469F.js
[Request] GET http://localhost:42461/static/dist/assets/index-QvZiqB7f.js
[Response] 200 http://localhost:42461/static/dist/assets/index-QvZiqB7f.js
[Request] GET http://localhost:42461/static/dist/assets/DocumentationApp-Cw4oUb1l.css
INFO:     127.0.0.1:53264 - "GET /static/dist/assets/DocumentationApp-Cw4oUb1l.css HTTP/1.1" 200 OK
INFO:     127.0.0.1:53296 - "GET /static/dist/assets/DocumentationApp-DJMW469F.js HTTP/1.1" 200 OK
[Response] 200 http://localhost:42461/static/dist/assets/DocumentationApp-Cw4oUb1l.css
[Response] 200 http://localhost:42461/static/dist/assets/DocumentationApp-DJMW469F.js
2025-08-16 04:08:58,834 - family_assistant.tools.documents - INFO - Found user documentation files: ['scripting.md', 'USER_GUIDE.md', 'scheduling.md']
INFO:     127.0.0.1:53264 - "GET /api/documentation/ HTTP/1.1" 200 OK
[Request] GET http://localhost:42461/api/documentation/
[Response] 200 http://localhost:42461/api/documentation/
Pre-loading route: /history
[Request] GET http://localhost:42461/history
INFO:     127.0.0.1:53264 - "GET /history HTTP/1.1" 200 OK
[Response] 200 http://localhost:42461/history
[Request] GET http://localhost:42461/static/dist/assets/router-BDyQ12Xx.js
[Response] 200 http://localhost:42461/static/dist/assets/router-BDyQ12Xx.js
[Request] GET http://localhost:42461/static/dist/assets/modulepreload-polyfill-B5Qt9EMX.js
[Response] 200 http://localhost:42461/static/dist/assets/modulepreload-polyfill-B5Qt9EMX.js
[Request] GET http://localhost:42461/static/dist/assets/markdown-DkulxR7L.js
[Response] 200 http://localhost:42461/static/dist/assets/markdown-DkulxR7L.js
[Request] GET http://localhost:42461/static/dist/assets/client-D4i40GxS.js
[Response] 200 http://localhost:42461/static/dist/assets/client-D4i40GxS.js
[Request] GET http://localhost:42461/static/dist/assets/ThemeProvider-4Nl18-8f.js
[Response] 200 http://localhost:42461/static/dist/assets/ThemeProvider-4Nl18-8f.js
[Request] GET http://localhost:42461/static/dist/assets/globals-BzhNq9eE.css
[Response] 200 http://localhost:42461/static/dist/assets/globals-BzhNq9eE.css
[Request] GET http://localhost:42461/static/dist/assets/Layout--yB9MKwc.js
[Response] 200 http://localhost:42461/static/dist/assets/Layout--yB9MKwc.js
[Request] GET http://localhost:42461/static/dist/assets/index-Cw7yfj14.js
[Response] 200 http://localhost:42461/static/dist/assets/index-Cw7yfj14.js
[Request] GET http://localhost:42461/static/dist/assets/button-C280_Z7h.js
[Response] 200 http://localhost:42461/static/dist/assets/button-C280_Z7h.js
[Request] GET http://localhost:42461/static/dist/assets/check-B4Bi62mG.js
[Response] 200 http://localhost:42461/static/dist/assets/check-B4Bi62mG.js
[Request] GET http://localhost:42461/static/dist/assets/createLucideIcon-BWE3A16L.js
[Response] 200 http://localhost:42461/static/dist/assets/createLucideIcon-BWE3A16L.js
[Request] GET http://localhost:42461/static/dist/assets/index-DJ5LtvbL.js
[Response] 200 http://localhost:42461/static/dist/assets/index-DJ5LtvbL.js
[Request] GET http://localhost:42461/static/dist/assets/index-DX5mgmid.js
[Response] 200 http://localhost:42461/static/dist/assets/index-DX5mgmid.js
[Request] GET http://localhost:42461/static/dist/assets/index-BVtkVPko.js
[Response] 200 http://localhost:42461/static/dist/assets/index-BVtkVPko.js
[Request] GET http://localhost:42461/static/dist/assets/index-DXxW798u.js
[Response] 200 http://localhost:42461/static/dist/assets/index-DXxW798u.js
[Request] GET http://localhost:42461/static/dist/assets/NavigationSheet-BR3FFw8j.js
[Response] 200 http://localhost:42461/static/dist/assets/NavigationSheet-BR3FFw8j.js
[Request] GET http://localhost:42461/static/dist/assets/index-B4vh495l.js
[Response] 200 http://localhost:42461/static/dist/assets/index-B4vh495l.js
[Request] GET http://localhost:42461/static/dist/assets/HistoryApp-BJY3MQD0.js
[Request] GET http://localhost:42461/static/dist/assets/input-DEzFQXe7.js
[Response] 200 http://localhost:42461/static/dist/assets/input-DEzFQXe7.js
INFO:     127.0.0.1:53264 - "GET /static/dist/assets/HistoryApp-BJY3MQD0.js HTTP/1.1" 200 OK
[Request] GET http://localhost:42461/static/dist/assets/label-taXZMDI0.js
[Request] GET http://localhost:42461/static/dist/assets/select-CtKAwL8N.js
[Request] GET http://localhost:42461/static/dist/assets/index-BdQq_4o_.js
[Response] 200 http://localhost:42461/static/dist/assets/index-BdQq_4o_.js
[Request] GET http://localhost:42461/static/dist/assets/chevron-up-C2znuyBj.js
[Request] GET http://localhost:42461/static/dist/assets/HistoryApp-DOqE_fhl.css
INFO:     127.0.0.1:53296 - "GET /static/dist/assets/label-taXZMDI0.js HTTP/1.1" 200 OK
INFO:     127.0.0.1:53292 - "GET /static/dist/assets/select-CtKAwL8N.js HTTP/1.1" 200 OK
INFO:     127.0.0.1:53272 - "GET /static/dist/assets/chevron-up-C2znuyBj.js HTTP/1.1" 200 OK
[Response] 200 http://localhost:42461/static/dist/assets/HistoryApp-BJY3MQD0.js
[Response] 200 http://localhost:42461/static/dist/assets/label-taXZMDI0.js
INFO:     127.0.0.1:53276 - "GET /static/dist/assets/HistoryApp-DOqE_fhl.css HTTP/1.1" 200 OK
[Response] 200 http://localhost:42461/static/dist/assets/chevron-up-C2znuyBj.js
[Response] 200 http://localhost:42461/static/dist/assets/HistoryApp-DOqE_fhl.css
[Response] 200 http://localhost:42461/static/dist/assets/select-CtKAwL8N.js
[Request] GET http://localhost:42461/api/v1/chat/conversations?limit=20&offset=0
INFO:     127.0.0.1:53276 - "GET /api/v1/chat/conversations?limit=20&offset=0 HTTP/1.1" 200 OK
[Response] 200 http://localhost:42461/api/v1/chat/conversations?limit=20&offset=0
Pre-loading route: /notes
[Request] GET http://localhost:42461/notes
INFO:     127.0.0.1:53276 - "GET /notes HTTP/1.1" 200 OK
[Response] 200 http://localhost:42461/notes
[Request] GET http://localhost:42461/static/dist/assets/router-BDyQ12Xx.js
[Response] 200 http://localhost:42461/static/dist/assets/router-BDyQ12Xx.js
[Request] GET http://localhost:42461/static/dist/assets/modulepreload-polyfill-B5Qt9EMX.js
[Response] 200 http://localhost:42461/static/dist/assets/modulepreload-polyfill-B5Qt9EMX.js
[Request] GET http://localhost:42461/static/dist/assets/markdown-DkulxR7L.js
[Response] 200 http://localhost:42461/static/dist/assets/markdown-DkulxR7L.js
[Request] GET http://localhost:42461/static/dist/assets/client-D4i40GxS.js
[Response] 200 http://localhost:42461/static/dist/assets/client-D4i40GxS.js
[Request] GET http://localhost:42461/static/dist/assets/ThemeProvider-4Nl18-8f.js
[Response] 200 http://localhost:42461/static/dist/assets/ThemeProvider-4Nl18-8f.js
[Request] GET http://localhost:42461/static/dist/assets/globals-BzhNq9eE.css
[Response] 200 http://localhost:42461/static/dist/assets/globals-BzhNq9eE.css
[Request] GET http://localhost:42461/static/dist/assets/Layout--yB9MKwc.js
[Response] 200 http://localhost:42461/static/dist/assets/Layout--yB9MKwc.js
[Request] GET http://localhost:42461/static/dist/assets/index-Cw7yfj14.js
[Response] 200 http://localhost:42461/static/dist/assets/index-Cw7yfj14.js
[Request] GET http://localhost:42461/static/dist/assets/button-C280_Z7h.js
[Response] 200 http://localhost:42461/static/dist/assets/button-C280_Z7h.js
[Request] GET http://localhost:42461/static/dist/assets/check-B4Bi62mG.js
[Response] 200 http://localhost:42461/static/dist/assets/check-B4Bi62mG.js
[Request] GET http://localhost:42461/static/dist/assets/createLucideIcon-BWE3A16L.js
[Response] 200 http://localhost:42461/static/dist/assets/createLucideIcon-BWE3A16L.js
[Request] GET http://localhost:42461/static/dist/assets/index-DJ5LtvbL.js
[Response] 200 http://localhost:42461/static/dist/assets/index-DJ5LtvbL.js
[Request] GET http://localhost:42461/static/dist/assets/index-DX5mgmid.js
[Response] 200 http://localhost:42461/static/dist/assets/index-DX5mgmid.js
[Request] GET http://localhost:42461/static/dist/assets/index-BVtkVPko.js
[Response] 200 http://localhost:42461/static/dist/assets/index-BVtkVPko.js
[Request] GET http://localhost:42461/static/dist/assets/index-DXxW798u.js
[Response] 200 http://localhost:42461/static/dist/assets/index-DXxW798u.js
[Request] GET http://localhost:42461/static/dist/assets/NavigationSheet-BR3FFw8j.js
[Response] 200 http://localhost:42461/static/dist/assets/NavigationSheet-BR3FFw8j.js
[Request] GET http://localhost:42461/static/dist/assets/index-B4vh495l.js
[Response] 200 http://localhost:42461/static/dist/assets/index-B4vh495l.js
INFO:     127.0.0.1:53276 - "GET /static/dist/assets/NotesApp-DTM5rAw_.js HTTP/1.1" 200 OK
[Request] GET http://localhost:42461/static/dist/assets/NotesApp-DTM5rAw_.js
[Request] GET http://localhost:42461/static/dist/assets/data-table-INSCgcXf.js
[Request] GET http://localhost:42461/static/dist/assets/input-DEzFQXe7.js
[Response] 200 http://localhost:42461/static/dist/assets/input-DEzFQXe7.js
[Request] GET http://localhost:42461/static/dist/assets/chevron-up-C2znuyBj.js
INFO:     127.0.0.1:53296 - "GET /static/dist/assets/checkbox-B_ltOU5r.js HTTP/1.1" 200 OK
[Response] 200 http://localhost:42461/static/dist/assets/chevron-up-C2znuyBj.js
[Request] GET http://localhost:42461/static/dist/assets/textarea-1cCUDJPF.js
[Request] GET http://localhost:42461/static/dist/assets/checkbox-B_ltOU5r.js
[Request] GET http://localhost:42461/static/dist/assets/label-taXZMDI0.js
[Response] 200 http://localhost:42461/static/dist/assets/label-taXZMDI0.js
[Request] GET http://localhost:42461/static/dist/assets/card-CTXY0ynb.js
[Response] 200 http://localhost:42461/static/dist/assets/card-CTXY0ynb.js
[Request] GET http://localhost:42461/static/dist/assets/alert-BaJRipSp.js
INFO:     127.0.0.1:53272 - "GET /static/dist/assets/textarea-1cCUDJPF.js HTTP/1.1" 200 OK
INFO:     127.0.0.1:53292 - "GET /static/dist/assets/data-table-INSCgcXf.js HTTP/1.1" 200 OK
INFO:     127.0.0.1:53264 - "GET /static/dist/assets/alert-BaJRipSp.js HTTP/1.1" 200 OK
[Response] 200 http://localhost:42461/static/dist/assets/NotesApp-DTM5rAw_.js
[Response] 200 http://localhost:42461/static/dist/assets/checkbox-B_ltOU5r.js
[Response] 200 http://localhost:42461/static/dist/assets/textarea-1cCUDJPF.js
[Response] 200 http://localhost:42461/static/dist/assets/alert-BaJRipSp.js
[Response] 200 http://localhost:42461/static/dist/assets/data-table-INSCgcXf.js
[Request] GET http://localhost:42461/api/notes/
INFO:     127.0.0.1:53264 - "GET /api/notes/ HTTP/1.1" 200 OK
[Response] 200 http://localhost:42461/api/notes/
[Request] GET http://localhost:42461/
INFO:     127.0.0.1:53264 - "GET / HTTP/1.1" 302 Found
[Response] 302 http://localhost:42461/
[Request] GET http://localhost:42461/chat
[Response] 200 http://localhost:42461/chat
[Request] GET http://localhost:42461/static/dist/assets/router-BDyQ12Xx.js
[Response] 200 http://localhost:42461/static/dist/assets/router-BDyQ12Xx.js
[Request] GET http://localhost:42461/static/dist/assets/modulepreload-polyfill-B5Qt9EMX.js
[Response] 200 http://localhost:42461/static/dist/assets/modulepreload-polyfill-B5Qt9EMX.js
[Request] GET http://localhost:42461/static/dist/assets/markdown-DkulxR7L.js
[Response] 200 http://localhost:42461/static/dist/assets/markdown-DkulxR7L.js
[Request] GET http://localhost:42461/static/dist/assets/client-D4i40GxS.js
[Response] 200 http://localhost:42461/static/dist/assets/client-D4i40GxS.js
[Request] GET http://localhost:42461/static/dist/assets/ThemeProvider-4Nl18-8f.js
[Response] 200 http://localhost:42461/static/dist/assets/ThemeProvider-4Nl18-8f.js
[Request] GET http://localhost:42461/static/dist/assets/globals-BzhNq9eE.css
[Response] 200 http://localhost:42461/static/dist/assets/globals-BzhNq9eE.css
[Request] GET http://localhost:42461/static/dist/assets/ChatApp-BGzR61B2.js
[Response] 200 http://localhost:42461/static/dist/assets/ChatApp-BGzR61B2.js
[Request] GET http://localhost:42461/static/dist/assets/button-C280_Z7h.js
[Response] 200 http://localhost:42461/static/dist/assets/button-C280_Z7h.js
[Request] GET http://localhost:42461/static/dist/assets/NavigationSheet-BR3FFw8j.js
[Response] 200 http://localhost:42461/static/dist/assets/NavigationSheet-BR3FFw8j.js
[Request] GET http://localhost:42461/static/dist/assets/createLucideIcon-BWE3A16L.js
[Response] 200 http://localhost:42461/static/dist/assets/createLucideIcon-BWE3A16L.js
[Request] GET http://localhost:42461/static/dist/assets/check-B4Bi62mG.js
[Response] 200 http://localhost:42461/static/dist/assets/check-B4Bi62mG.js
[Request] GET http://localhost:42461/static/dist/assets/index-DJ5LtvbL.js
[Response] 200 http://localhost:42461/static/dist/assets/index-DJ5LtvbL.js
[Request] GET http://localhost:42461/static/dist/assets/index-Cw7yfj14.js
[Response] 200 http://localhost:42461/static/dist/assets/index-Cw7yfj14.js
[Request] GET http://localhost:42461/static/dist/assets/index-DX5mgmid.js
[Response] 200 http://localhost:42461/static/dist/assets/index-DX5mgmid.js
[Request] GET http://localhost:42461/static/dist/assets/index-B4vh495l.js
[Response] 200 http://localhost:42461/static/dist/assets/index-B4vh495l.js
[Request] GET http://localhost:42461/static/dist/assets/card-CTXY0ynb.js
[Response] 200 http://localhost:42461/static/dist/assets/card-CTXY0ynb.js
[Request] GET http://localhost:42461/static/dist/assets/badge-DPL7DvXz.js
[Response] 200 http://localhost:42461/static/dist/assets/badge-DPL7DvXz.js
[Request] GET http://localhost:42461/static/dist/assets/index-QvZiqB7f.js
[Response] 200 http://localhost:42461/static/dist/assets/index-QvZiqB7f.js
[Request] GET http://localhost:42461/static/dist/assets/ToolUI-d4PjB4dB.js
[Response] 200 http://localhost:42461/static/dist/assets/ToolUI-d4PjB4dB.js
[Request] GET http://localhost:42461/static/dist/assets/input-DEzFQXe7.js
[Response] 200 http://localhost:42461/static/dist/assets/input-DEzFQXe7.js
[Request] GET http://localhost:42461/static/dist/assets/index-BdQq_4o_.js
[Response] 200 http://localhost:42461/static/dist/assets/index-BdQq_4o_.js
[Request] GET http://localhost:42461/api/v1/chat/conversations
[Request] GET http://localhost:42461/api/v1/chat/conversations/web_conv_42e2a870-4348-4385-8882-454e43361dd9/messages
INFO:     127.0.0.1:53272 - "GET /api/v1/chat/conversations/web_conv_42e2a870-4348-4385-8882-454e43361dd9/messages HTTP/1.1" 200 OK
INFO:     127.0.0.1:53264 - "GET /api/v1/chat/conversations HTTP/1.1" 200 OK
[Response] 200 http://localhost:42461/api/v1/chat/conversations/web_conv_42e2a870-4348-4385-8882-454e43361dd9/messages
[Response] 200 http://localhost:42461/api/v1/chat/conversations
Router and dynamic imports initialization complete
---------------------------- Captured stderr setup -----------------------------
INFO:     Started server process [1224484]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
INFO:     Uvicorn running on http://0.0.0.0:42461 (Press CTRL+C to quit)
------------------------------ Captured log setup ------------------------------
INFO     tests.conftest:conftest.py:178 
--- SQLite Test DB Setup (test_navigation_dropdowns_open_and_position[2-sqlite-chromium]) ---
INFO     tests.conftest:conftest.py:179 Created SQLite test engine: sqlite+aiosqlite:////tmp/fa_test_adbi9i5i.sqlite
INFO     tests.conftest:conftest.py:246 Using sqlite test engine.
INFO     family_assistant.storage:__init__.py:260 Checking database state (attempt 1/10)...
INFO     family_assistant.storage:__init__.py:155 ALEMBIC_CONFIG env var not set. Using default path: /workspace/alembic.ini
INFO     family_assistant.storage:__init__.py:172 Alembic config loaded. Using script_location: alembic
INFO     family_assistant.storage:__init__.py:76 Inspecting database for alembic_version table...
INFO     family_assistant.storage:__init__.py:91 Alembic version table found: False
INFO     family_assistant.storage:__init__.py:270 New DB: creating schema, stamping with Alembic head...
INFO     family_assistant.storage:__init__.py:214 Creating tables from SQLAlchemy metadata...
INFO     family_assistant.storage:__init__.py:217 Tables created.
INFO     family_assistant.storage:__init__.py:184 Preparing to run Alembic command: ensure_version()
INFO     family_assistant.storage:__init__.py:190 [sync] Setting connection for Alembic: <sqlalchemy.engine.base.Connection object at 0xe576dc1ca0f0>
INFO     family_assistant.storage:__init__.py:192 [sync] Executing: ensure_version()
INFO     env_py:env.py:161 Running migrations in 'online' mode using provided connection.
INFO     env_py:env.py:64 do_run_migrations: Starting... Dialect: sqlite, Connection: <sqlalchemy.engine.base.Connection object at 0xe576dc1ca0f0>
INFO     env_py:env.py:67 do_run_migrations: Configuring context with script_location: alembic
INFO     alembic.runtime.migration:migration.py:211 Context impl SQLiteImpl.
INFO     alembic.runtime.migration:migration.py:214 Will assume non-transactional DDL.
INFO     env_py:env.py:85 do_run_migrations: Context configured. (No destination revision applicable for this command)
INFO     env_py:env.py:94 Running SQLite migrations (non-transactional DDL) for target: (N/A for this command)
INFO     env_py:env.py:105 Database migrations completed successfully.
INFO     env_py:env.py:165 Migrations finished using provided connection.
INFO     family_assistant.storage:__init__.py:195 [sync] Successfully executed: ensure_version
INFO     family_assistant.storage:__init__.py:204 Alembic command ensure_version completed.
INFO     family_assistant.storage:__init__.py:184 Preparing to run Alembic command: stamp('head')
INFO     family_assistant.storage:__init__.py:190 [sync] Setting connection for Alembic: <sqlalchemy.engine.base.Connection object at 0xe576bc1fe000>
INFO     family_assistant.storage:__init__.py:192 [sync] Executing: stamp('head')
INFO     env_py:env.py:161 Running migrations in 'online' mode using provided connection.
INFO     env_py:env.py:64 do_run_migrations: Starting... Dialect: sqlite, Connection: <sqlalchemy.engine.base.Connection object at 0xe576bc1fe000>
INFO     env_py:env.py:67 do_run_migrations: Configuring context with script_location: alembic
INFO     alembic.runtime.migration:migration.py:211 Context impl SQLiteImpl.
INFO     alembic.runtime.migration:migration.py:214 Will assume non-transactional DDL.
INFO     env_py:env.py:81 do_run_migrations: Context configured. Destination Revision: head
INFO     env_py:env.py:94 Running SQLite migrations (non-transactional DDL) for target: head
INFO     alembic.runtime.migration:migration.py:622 Running stamp_revision  -> 5c039369c3d7
INFO     env_py:env.py:105 Database migrations completed successfully.
INFO     env_py:env.py:165 Migrations finished using provided connection.
INFO     family_assistant.storage:__init__.py:195 [sync] Successfully executed: stamp
INFO     family_assistant.storage:__init__.py:204 Alembic command stamp completed.
INFO     family_assistant.storage:__init__.py:223 Initializing vector DB components...
WARNING  family_assistant.storage.vector:vector.py:207 Database dialect is 'sqlite', not 'postgresql'. Skipping vector extension and index creation. Vector search functionality may be limited or unavailable.
INFO     family_assistant.storage:__init__.py:232 Vector DB components initialized successfully.
INFO     family_assistant.storage:__init__.py:276 Database initialization successful.
INFO     tests.conftest:conftest.py:252 Database schema initialized.
INFO     tests.mocks.mock_llm:mock_llm.py:65 RuleBasedMockLLMClient initialized with 0 rules for model 'mock-llm-model'.
INFO     family_assistant.web.app_creator:app_creator.py:297 FastAPI debug mode set to: True
INFO     family_assistant.assistant:assistant.py:194 Using model: mock-model-for-testing
INFO     family_assistant.assistant:assistant.py:198 Stored configuration in FastAPI app state.
INFO     family_assistant.assistant:assistant.py:201 Shared httpx.AsyncClient created.
WARNING  family_assistant.assistant:assistant.py:227 No specific API key validation for model: mock-model-for-testing.
INFO     family_assistant.embeddings:embeddings.py:434 MockEmbeddingGenerator initialized for model: mock-deterministic-embedder, dimensions: 10, map size: 0, default_behavior: generate
INFO     family_assistant.assistant:assistant.py:260 Using embedding generator: MockEmbeddingGenerator with model: mock-deterministic-embedder
INFO     family_assistant.assistant:assistant.py:269 Using injected database engine
INFO     family_assistant.web.auth:auth.py:86 OIDC Authentication is DISABLED in AuthService.
INFO     family_assistant.assistant:assistant.py:285 Authentication configured with database engine
INFO     family_assistant.tools.documents:documents.py:206 Found user documentation files: ['scripting.md', 'USER_GUIDE.md', 'scheduling.md']
INFO     family_assistant.assistant:assistant.py:356 Creating root ToolsProvider with all available tools
INFO     family_assistant.tools.infrastructure:infrastructure.py:147 LocalToolsProvider initialized with 33 tools: ['add_or_update_note', 'get_note', 'list_notes', 'delete_note', 'schedule_future_callback', 'schedule_recurring_task', 'schedule_reminder', 'schedule_action', 'schedule_recurring_action', 'search_documents', 'get_full_document_content', 'get_message_history', 'get_user_documentation_content', 'ingest_document_from_url', 'send_message_to_user', 'add_calendar_event', 'search_calendar_events', 'modify_calendar_event', 'delete_calendar_event', 'delegate_to_service', 'list_pending_callbacks', 'modify_pending_callback', 'cancel_pending_callback', 'query_recent_events', 'test_event_listener', 'create_event_listener', 'list_event_listeners', 'delete_event_listener', 'toggle_event_listener', 'validate_event_listener_script', 'test_event_listener_script', 'render_home_assistant_template', 'execute_script']
INFO     family_assistant.tools.infrastructure:infrastructure.py:151 LocalToolsProvider configured with embedding generator: MockEmbeddingGenerator
INFO     family_assistant.tools.mcp:mcp.py:54 MCPToolsProvider created for 0 configured servers. Initialization timeout: 60s. Health check interval: 30s. Initialization pending.
INFO     family_assistant.tools.infrastructure:infrastructure.py:338 CompositeToolsProvider initialized with 2 providers
INFO     family_assistant.tools.mcp:mcp.py:282 Initializing MCPToolsProvider: Connecting to 0 servers...
INFO     family_assistant.tools.mcp:mcp.py:316 Waiting for MCP server connections with a timeout of 60 seconds...
INFO     family_assistant.tools.mcp:mcp.py:322 Finished parallel MCP connection attempts (within timeout).
INFO     family_assistant.tools.mcp:mcp.py:453 MCPToolsProvider finished processing all 0 configured MCP server(s) in 0.00 seconds. Summary: 0 connected, 0 failed, 0 cancelled. Active sessions: 0. Mapped 0 unique tools from 0 total definitions.
INFO     family_assistant.assistant:assistant.py:386 Root ToolsProvider initialized with 33 tools
INFO     family_assistant.assistant:assistant.py:392 Initializing ProcessingService for profile ID: 'default_assistant'
INFO     family_assistant.assistant:assistant.py:405 Profile 'default_assistant' using overridden LLM client: RuleBasedMockLLMClient
INFO     family_assistant.tools.infrastructure:infrastructure.py:478 ConfirmingToolsProvider initialized with tools requiring confirmation: {'delete_calendar_event', 'add_or_update_note'}
INFO     family_assistant.assistant:assistant.py:744 Default processing service set to profile ID: 'default_assistant'.
WARNING  family_assistant.assistant:assistant.py:753 No processors in 'indexing_pipeline_config'.
INFO     family_assistant.indexing.document_indexer:document_indexer.py:165 DocumentIndexer initialized with dynamically built pipeline including 0 processors: []
INFO     family_assistant.indexing.email_indexer:email_indexer.py:167 EmailIndexer initialized with an IndexingPipeline instance.
INFO     family_assistant.indexing.notes_indexer:notes_indexer.py:33 NotesIndexer initialized with an IndexingPipeline instance.
INFO     family_assistant.assistant:assistant.py:763 DocumentIndexer, EmailIndexer, and NotesIndexer initialized.
INFO     family_assistant.assistant:assistant.py:793 Telegram service disabled (telegram_enabled=False)
INFO     family_assistant.assistant:assistant.py:862 Telegram service disabled, skipping polling.
INFO     family_assistant.assistant:assistant.py:872 Web server running on http://0.0.0.0:42461
INFO     family_assistant.assistant:assistant.py:873 In development, run 'poe dev' and access the app at http://localhost:5173
INFO     family_assistant.assistant:assistant.py:934 Registered task handlers for worker worker-882a8055-58a2-49ff-bd3a-391c5b826e3e
INFO     family_assistant.web.app_creator:app_creator.py:150 Application starting up...
INFO     family_assistant.web.auth:auth.py:86 OIDC Authentication is DISABLED in AuthService.
INFO     family_assistant.web.app_creator:app_creator.py:156 AuthService initialized with database engine
INFO     family_assistant.tools.documents:documents.py:206 Found user documentation files: ['scripting.md', 'USER_GUIDE.md', 'scheduling.md']
----------------------------- Captured stdout call -----------------------------
[Request] GET http://localhost:42461/notes
[Response] 200 http://localhost:42461/notes
[Request] GET http://localhost:42461/static/dist/assets/router-BDyQ12Xx.js
[Response] 200 http://localhost:42461/static/dist/assets/router-BDyQ12Xx.js
[Request] GET http://localhost:42461/static/dist/assets/modulepreload-polyfill-B5Qt9EMX.js
[Response] 200 http://localhost:42461/static/dist/assets/modulepreload-polyfill-B5Qt9EMX.js
[Request] GET http://localhost:42461/static/dist/assets/markdown-DkulxR7L.js
[Response] 200 http://localhost:42461/static/dist/assets/markdown-DkulxR7L.js
[Request] GET http://localhost:42461/static/dist/assets/client-D4i40GxS.js
[Response] 200 http://localhost:42461/static/dist/assets/client-D4i40GxS.js
[Request] GET http://localhost:42461/static/dist/assets/ThemeProvider-4Nl18-8f.js
[Response] 200 http://localhost:42461/static/dist/assets/ThemeProvider-4Nl18-8f.js
[Request] GET http://localhost:42461/static/dist/assets/globals-BzhNq9eE.css
[Response] 200 http://localhost:42461/static/dist/assets/globals-BzhNq9eE.css
[Request] GET http://localhost:42461/static/dist/assets/Layout--yB9MKwc.js
[Response] 200 http://localhost:42461/static/dist/assets/Layout--yB9MKwc.js
[Request] GET http://localhost:42461/static/dist/assets/index-Cw7yfj14.js
[Response] 200 http://localhost:42461/static/dist/assets/index-Cw7yfj14.js
[Request] GET http://localhost:42461/static/dist/assets/button-C280_Z7h.js
[Response] 200 http://localhost:42461/static/dist/assets/button-C280_Z7h.js
[Request] GET http://localhost:42461/static/dist/assets/check-B4Bi62mG.js
[Response] 200 http://localhost:42461/static/dist/assets/check-B4Bi62mG.js
[Request] GET http://localhost:42461/static/dist/assets/createLucideIcon-BWE3A16L.js
[Response] 200 http://localhost:42461/static/dist/assets/createLucideIcon-BWE3A16L.js
[Request] GET http://localhost:42461/static/dist/assets/index-DJ5LtvbL.js
[Response] 200 http://localhost:42461/static/dist/assets/index-DJ5LtvbL.js
[Request] GET http://localhost:42461/static/dist/assets/index-DX5mgmid.js
[Response] 200 http://localhost:42461/static/dist/assets/index-DX5mgmid.js
[Request] GET http://localhost:42461/static/dist/assets/index-BVtkVPko.js
[Response] 200 http://localhost:42461/static/dist/assets/index-BVtkVPko.js
[Request] GET http://localhost:42461/static/dist/assets/index-DXxW798u.js
[Response] 200 http://localhost:42461/static/dist/assets/index-DXxW798u.js
[Request] GET http://localhost:42461/static/dist/assets/NavigationSheet-BR3FFw8j.js
[Response] 200 http://localhost:42461/static/dist/assets/NavigationSheet-BR3FFw8j.js
[Request] GET http://localhost:42461/static/dist/assets/index-B4vh495l.js
[Response] 200 http://localhost:42461/static/dist/assets/index-B4vh495l.js
[Request] GET http://localhost:42461/static/dist/assets/NotesApp-DTM5rAw_.js
[Response] 200 http://localhost:42461/static/dist/assets/NotesApp-DTM5rAw_.js
[Request] GET http://localhost:42461/static/dist/assets/data-table-INSCgcXf.js
[Response] 200 http://localhost:42461/static/dist/assets/data-table-INSCgcXf.js
[Request] GET http://localhost:42461/static/dist/assets/input-DEzFQXe7.js
[Response] 200 http://localhost:42461/static/dist/assets/input-DEzFQXe7.js
[Request] GET http://localhost:42461/static/dist/assets/chevron-up-C2znuyBj.js
[Response] 200 http://localhost:42461/static/dist/assets/chevron-up-C2znuyBj.js
[Request] GET http://localhost:42461/static/dist/assets/textarea-1cCUDJPF.js
[Response] 200 http://localhost:42461/static/dist/assets/textarea-1cCUDJPF.js
[Request] GET http://localhost:42461/static/dist/assets/checkbox-B_ltOU5r.js
[Response] 200 http://localhost:42461/static/dist/assets/checkbox-B_ltOU5r.js
[Request] GET http://localhost:42461/static/dist/assets/label-taXZMDI0.js
[Response] 200 http://localhost:42461/static/dist/assets/label-taXZMDI0.js
[Request] GET http://localhost:42461/static/dist/assets/card-CTXY0ynb.js
[Response] 200 http://localhost:42461/static/dist/assets/card-CTXY0ynb.js
[Request] GET http://localhost:42461/static/dist/assets/alert-BaJRipSp.js
[Response] 200 http://localhost:42461/static/dist/assets/alert-BaJRipSp.js
[Request] GET http://localhost:42461/api/notes/
INFO:     127.0.0.1:53264 - "GET /api/notes/ HTTP/1.1" 200 OK
[Response] 200 http://localhost:42461/api/notes/
2025-08-16 04:09:02,543 - family_assistant.assistant - WARNING - Task worker exited normally, restarting...
2025-08-16 04:09:02,543 - family_assistant.assistant - INFO - Restarting task worker...
2025-08-16 04:09:02,543 - family_assistant.assistant - INFO - Task worker health monitor stopped
2025-08-16 04:09:02,543 - family_assistant.task_worker - INFO - Task worker worker-7768e09e-6caf-4524-83e1-cf7b1cf779be run loop started.
2025-08-16 04:09:02,543 - family_assistant.task_worker - INFO - Task worker worker-7768e09e-6caf-4524-83e1-cf7b1cf779be stopped.
------------------------------ Captured log call -------------------------------
WARNING  family_assistant.assistant:assistant.py:1081 Task worker exited normally, restarting...
INFO     family_assistant.assistant:assistant.py:1088 Restarting task worker...
INFO     family_assistant.assistant:assistant.py:1123 Task worker health monitor stopped
--------------------------- Captured stdout teardown ---------------------------
2025-08-16 04:09:06,725 - family_assistant.assistant - WARNING - Received signal TEST. Initiating shutdown via Assistant...
2025-08-16 04:09:06,726 - family_assistant.assistant - INFO - Shutdown signal received by Assistant. Stopping services...
2025-08-16 04:09:06,891 - family_assistant.web.app_creator - INFO - Application shutting down...
2025-08-16 04:09:06,892 - family_assistant.assistant - INFO - Web server stopped.
2025-08-16 04:09:06,892 - tests.conftest - INFO - --- Test DB Teardown (test_navigation_dropdowns_open_and_position[2-sqlite-chromium]) ---
2025-08-16 04:09:06,900 - tests.conftest - INFO - Test engine disposed.
2025-08-16 04:09:06,901 - tests.conftest - INFO - Removed temporary SQLite database file.
2025-08-16 04:09:06,959 - tests.conftest - INFO - External PostgreSQL usage completed.

=== Browser closed successfully ===

=== Playwright stopped successfully ===
2025-08-16 04:09:07,017 - family_assistant.assistant - INFO - Task worker health monitor stopped
2025-08-16 04:09:07,018 - family_assistant.assistant - INFO - Task worker health monitor stopped
--------------------------- Captured stderr teardown ---------------------------
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:     Application shutdown complete.
INFO:     Finished server process [1224484]
---------------------------- Captured log teardown -----------------------------
WARNING  family_assistant.assistant:assistant.py:963 Received signal TEST. Initiating shutdown via Assistant...
INFO     family_assistant.assistant:assistant.py:951 Shutdown signal received by Assistant. Stopping services...
INFO     family_assistant.web.app_creator:app_creator.py:167 Application shutting down...
INFO     family_assistant.assistant:assistant.py:956 Web server stopped.
INFO     tests.conftest:conftest.py:259 --- Test DB Teardown (test_navigation_dropdowns_open_and_position[2-sqlite-chromium]) ---
INFO     tests.conftest:conftest.py:274 Test engine disposed.
INFO     tests.conftest:conftest.py:277 Removed temporary SQLite database file.
INFO     tests.conftest:conftest.py:548 External PostgreSQL usage completed.
INFO     family_assistant.assistant:assistant.py:1123 Task worker health monitor stopped
INFO     family_assistant.assistant:assistant.py:1123 Task worker health monitor stopped
=========================== short test summary info ============================
FAILED tests/functional/web/test_page_layout.py::test_navigation_dropdowns_open_and_position[16-postgres-chromium]
FAILED tests/functional/web/test_page_layout.py::test_navigation_dropdowns_open_and_position[9-sqlite-chromium]
FAILED tests/functional/web/test_page_layout.py::test_navigation_dropdowns_open_and_position[2-sqlite-chromium]
!!!!!!!!!!!!!!!!!!!!!!!!!! stopping after 3 failures !!!!!!!!!!!!!!!!!!!!!!!!!!!
!!!!!!!!!!!! xdist.dsession.Interrupted: stopping after 1 failures !!!!!!!!!!!!!
==================== 3 failed, 7 passed in 69.82s (0:01:09) ====================
